{"version":3,"sources":["utils/flotConverter.js","Components/ColorPicker/transformers.js","Components/ColorPicker/components/PickerDialog.js","Components/ColorPicker/components/ColorPicker.js","Components/ColorPicker/index.js","Components/Fields.js","Components/Line.js","Components/Mark.js","Components/DefaultPreset.js","Components/PresetTabs.js","SettingsEditor.js","Components/ChartSettings.js","Components/ChartFrame.js","MainChart.js","Components/PresetsTree.js","Components/ChartsTree.js","MenuList.js","App.js","utils/getUrlQuery.js","serviceWorker.js","index.js"],"names":["_executeWriteTasks","socket","tasks","_resolve","Promise","resolve","length","obj","shift","getObject","_id","catch","then","exists","console","log","setTimeout","setObject","_flot2echarts","flotObj","instance","echartsObj","replace","common","name","expert","native","type","endsWith","Math","round","random","data","config","lines","l","_ids","ids","split","colors","_colors","names","_names","units","_units","i","push","id","offset","aggregate","color","thickness","strokeWidth","shadowsize","min","max","unit","aggregateType","aggregateSpan","relativeEnd","j","art","yOffset","parseFloat","validTime","m","marks","lineId","parseInt","toString","upperValueOrId","v","lowerValueOrId","vl","c","fill","f","ol","t","os","s","text","d","textPosition","p","textOffset","py","textColor","fc","textSize","fs","undefined","width","height","timeFormat","useComma","zoom","export","grid_hideX","grid_hideY","hoverDetail","noLoader","noedit","animation","afterComma","timeType","normalizeConfig","params","coerce","coerceTypes","forEach","param","val","key","decodeURIComponent","keys","keysLast","test","concat","isNaN","cur","Object","prototype","call","hasOwnProperty","deParam","url","module","exports","instanceObj","convertDone","reject","getRawSocket","emit","startkey","endkey","err","res","charts","rows","value","_readFlotSettings","map","e","error","converters","rgba","rgb","r","g","b","a","hex","rgba_rgb","rgba_hex","PickerDialog","onClick","onChange","className","style","position","zIndex","top","right","bottom","left","ColorPicker","convert","hintText","placeholder","floatingLabelText","label","TextFieldProps","showPicker","setShowPicker","internalValue","setValue","pickerClassName","custom","TextField","target","InputProps","newValue","defaultProps","MakedColorPicker","compose","withState","defaultValue","makeColorPicker","styles","theme","fieldContainer","paddingTop","whiteSpace","checkBoxLabel","fontSize","objectContainer","display","objectField","flex","objectButton","marginTop","paddingLeft","colorPicker","sliderContainer","sliderLabel","sliderRoot","paddingBottom","spacing","IOSelect","props","I18n","clsx","classes","FormControl","minWidth","InputLabel","shrink","Select","disabled","formData","updateValue","renderValue","displayEmpty","options","MenuItem","noTranslate","withStyles","IOCheckbox","FormControlLabel","control","Checkbox","checked","IOTextField","InputLabelProps","inputProps","title","startAdornment","helperLink","IconButton","size","window","open","endAdornment","IODateTimeField","date","IOObjectField","useState","state","setState","fullWidth","showDialog","dialogName","customFilter","selected","onOk","onClose","IOColorPicker","variant","backgroundColor","IOSlider","Typography","Slider","root","step","valueLabelDisplay","WIDTHS","chartType","dataType","buttons","Line","React","Component","constructor","super","updateField","line","JSON","parse","stringify","this","Utils","getObjectNameFromObj","language","getLanguage","_name","updateLine","index","renderClosedLine","visible","windowWidth","idWidth","padding","lineClosed","provided","dragHandleProps","emptyDrag","onPaste","lineOpenToggle","result","instances","shortInstanceField","paste","systemConfig","defaultHistory","shortIdField","auto","scatterplot","steps","stepsStart","spline","shortChartTypeField","minmax","average","total","onchange","shortDataTypeField","renderColorField","shortColorField","shortNameField","deleteButton","aria-label","deleteLine","onUpdate","noPadding","isUseBright","onSelectColor","getColor","stopPropagation","renderOpenedLine","xAxisOptions","maxLines","presetData","commonYAxis","ownYAxis","deleteButtonFull","copyButtonFull","onCopy","shortFields","points","legend","off","leftColor","rightColor","render","Card","card","cardPaste","background","snapshot","isDragging","palette","secondary","light","CardContent","cardContent","opened","borderStyle","borderWidth","marginBottom","borderColor","grey","overflow","opacity","margin","paddingRight","borderBottom","lineHeight","marginLeft","marginRight","shortFieldsLast","LINE_HEIGHT","verticalAlign","shortButtonsField","float","Mark","mark","updateMark","lineClosedContainer","markOpenToggle","shortLineIdField","shortUpperValueOrIdField","shortLowerValueOrIdField","shortFillField","shortTextField","deleteMark","renderOpenedCard","flexFlow","flexDirection","DEFAULT_PRESET","range","live","ticks","noBorder","window_bg","bg_custom","x_labels_color","y_labels_color","border_color","grid_color","border_width","barColor","barLabels","barWidth","barFontSize","barFontColor","titlePos","titleColor","titleSize","legColumns","legBgOpacity","legBg","legendDirection","getDefaultLine","systemSettings","isBoolean","trim","symbolSize","yaxe","yticks","getDefaultPreset","preset","isFloatComma","dateFormat","PREDEFINED_COLORS_MARKS","PresetTabs","linesOpened","localStorage","setItem","marksOpened","time","markData","lineData","expandAllLines","collapseAllLines","expandAllMarks","collapseAllMarks","splice","copiedObject","sessionStorage","getItem","DefaultPreset","selectedTab","deleteLineDialog","deleteMarkDialog","showColorDialog","colorDialogValue","webInstances","toast","getAdapterInstances","pop","link","secure","bind","location","hostname","port","colorPickerCb","addMark","len","addLine","xaxe","renderDeleteLineDialog","Dialog","DialogTitle","DialogActions","alignRight","buttonsContainer","Button","renderDeleteMarkDialog","showColorPicker","cb","renderColorDialog","renderTabLines","anyClosed","find","anyOpened","droppableId","droppableProps","ref","innerRef","isDraggingOver","dark","minHeight","TabPanel","tabContent","Fab","buttonAdd","buttonExpandAll","buttonCollapseAll","draggableId","draggableProps","draggableStyle","userSelect","noContent","dragHint","renderTabMarkings","renderTabTime","group","timeFormatCustom","renderToast","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","ContentProps","message","action","close","renderTabOptions","buttonCopyLink","protocol","host","selectedId","copyToClipboard","renderTabTitle","renderTabAppearance","noBackground","Grid","item","sm","xs","TabContext","AppBar","tabsContainer","selectedPresetChanged","autoSave","onAutoSave","noPaddingOnSide","buttonSave","savePreset","TabList","event","scrollButtons","Tab","tabsBody","overflowY","fontStyle","SettingsEditor","logBox","logBoxInner","toolbox","boxShadow","iconButtons","layoutIcon","borderRadius","IconAggregate","viewBox","xmlns","stroke","transform","RefreshSelect","rangeOptions","relativeEndOptions","liveOptions","CHART_TYPES","AGGREGATES","ChartSettings","timeSpanOpened","aggregateOpened","refreshOpened","Toolbar","mainDiv","settingsButton","start","start_time","end","end_time","Popover","popOver","anchorEl","document","getElementById","transformOrigin","fieldsContainer","aggregateIcon","refreshSelect","refreshSelectButtonTitle","grow1","hintButton","onCreatePreset","buttonIcon","textTransform","flexGrow","ChartFrame","onReceiveMessage","ready","lastPresetData","refIframe","contentWindow","postMessage","createRef","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","Paper","iframe","el","src","darkBackground","border","primary","main","MainChart","renderToolbar","enablePresetMode","parentId","historyInstance","stateId","getChartFrame","URL","search","includes","heightWithoutToolbar","height100","container","toolbar","mixins","toolbarButtons","editorDiv","textButton","tabIcon","hintIcon","tabMenuButton","tabChanged","tabText","maxWidth","textOverflow","tabChangedIcon","closeButton","cursor","notRunning","tabButton","tabButtonWrapper","menuIcon","HIDDEN_FOLDER","hideFolder","getFolderList","folder","values","subFolders","subFolder","Droppable","onDrop","useDrop","accept","drop","isOver","collect","monitor","shallow","isOverAny","children","Draggable","useDrag","drag","FORBIDDEN_CHARS","MenuList","presetsOpened","onPresetChange","startsWith","presets","changed","emptyFolders","getEmptyFolders","newState","changingPreset","presetFolders","buildPresetTree","informAboutSubFolders","addPresetToFolderPrefix","folderPrefix","noRefresh","oldId","presetId","adapterName","delObject","refreshData","onError","deletePresetDialog","movePresetDialog","newPresetFolder","addPresetFolderDialog","addPresetFolderName","editPresetFolderDialog","editPresetFolderName","getAllPresets","subscribeObject","unsubscribeObject","onShowReorder","_path","_result","__path","join","presetObj","renderTreePreset","level","anySubFolders","depthPx","reorder","listItem","ListItem","gutters","noGutters","button","onSelectedChanged","ListItemIcon","itemIconRoot","itemIconPreset","itemIcon","ListItemText","listItemTitle","listItemSubTitle","ListItemSecondaryAction","CircularProgress","renameDialog","renamePresetDialogTitle","onCopyPreset","iconCopy","renderPresetsTree","parent","prefix","reactChildren","sort","filter","folderItem","width100","folderIconPreset","togglePresetsFolder","itemIconFolder","editFolderDialogTitleOrigin","onDragFinish","renamePresetFolder","newName","newSelectedId","pos","indexOf","promises","all","isNameUnique","parts","currentFolder","findFolder","addFolder","parentFolder","_parentFolder","allowedId","renderAddFolderDialog","onClosePresetFolderDialog","DialogContent","onKeyPress","which","autoFocus","renderRenameFolderDialog","isUnique","renderMoveDialog","newId","isIdUnique","comment","onShowError","source","renderRenameDialog","renamePreset","renderDeleteDialog","ok","cancel","suppressQuestionMinutes","isYes","deletePreset","renderSelectIdDialog","showAddStateDialog","showToast","enabled","inst","enabledDP","newTitle","backend","HTML5Backend","List","scroll","mainList","withWidth","content","withTheme","sortObj","aid","bid","ChartsTree","chartsOpened","toggleChartFolder","adapterPromises","getAllEnums","getAllCharts","getEnums","enums","members","getAdapterIcon","groupId","instanceId","icon","img","getObjectIcon","getChartIcon","channelID","getParentId","deviceID","adapterID","_socket","objs","getObjects","substring","_instances","iconPromises","statesEnums","types","icons","eID","getEnumsForId","funcIds","roomIds","insts","otherFuncs","otherRooms","selectedChartId","ins","getNewPresetName","onShowToast","renderListItem","dragging","getIcon","multiple","chartsList","Switch","edge","onChangeList","renderListItems","enumId","renderContext","gIndex","LEVEL_PADDING","isDragDisabled","isDropDisabled","groupBy","adapterIcon","alt","showSearch","showReorder","isIFrame","self","chartList","renderListToolbar","mainToolbar","textInput","href","renderFooter","secondaryColors","FormGroup","row","smallMargin","mainListDiv","heightMinusToolbar","PresetsTree","isFromCurrentSelection","loadChartParam","App","GenericApp","settings","query","getUrlQuery","translations","require","getUniqueId","loadChartOrPreset","template","showError","originalPresetData","onDragEnd","destination","newLine","removed","onConnectionReady","addPresetDialog","progress","discardChangesConfirmDialog","resizing","menuOpened","menuSelectId","logHorzLayout","settingsSize","menuSize","objects","getSystemConfig","flotConverter","entry","getHistory","_count","results","first","iFirst","k","confirmCB","renderMain","menuOpenCloseButton","primaryMinSize","secondaryInitialSize","onDragStart","onSecondaryPaneSizeChange","innerWidth","verticalLayout","onLayoutChange","toggleLogLayout","connection","Fragment","primaryIndex","secondaryMinSize","customClassName","splitterDivs","menuDivWithoutMenu","removedLine","it","confirmed","renderError","themeType","default","fontFamily","menuDiv","Boolean","match","themeName","getThemeName","version","Sentry","dsn","release","integrations","SentryIntegrations","beforeSend","hint","ignore","exception","build","ReactDOM","onThemeChange","_theme","navigator","serviceWorker","registration","unregister"],"mappings":"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","file":"static/js/main.d608dd6b.chunk.js","sourcesContent":["function deParam(params, coerce) {\r\n    const obj = {};\r\n    const coerceTypes = {'true': true, 'false': false, 'null': null};\r\n\r\n    // Iterate over all name=value pairs.\r\n    params.replace(/\\+/g, ' ').split('&').forEach(v => {\r\n        const param = v.split('=');\r\n        let key = decodeURIComponent(param[0]);\r\n        let val;\r\n        let i = 0;\r\n\r\n        // If key is more complex than 'foo', like 'a[]' or 'a[b][c]', split it\r\n        // into its component parts.\r\n        let keys = key.split('][');\r\n        let keysLast = keys.length - 1;\r\n\r\n        // If the first keys part contains [ and the last ends with ], then []\r\n        // are correctly balanced.\r\n        if (/\\[/.test(keys[0]) && /]$/.test(keys[keysLast])) {\r\n            // Remove the trailing ] from the last keys part.\r\n            keys[keysLast] = keys[keysLast].replace(/]$/, '');\r\n\r\n            // Split first keys part into two parts on the [ and add them back onto\r\n            // the beginning of the keys array.\r\n            keys = keys.shift().split('[').concat(keys);\r\n\r\n            keysLast = keys.length - 1;\r\n        } else {\r\n            // Basic 'foo' style key.\r\n            keysLast = 0;\r\n        }\r\n\r\n        // Are we dealing with a name=value pair, or just a name?\r\n        if (param.length === 2) {\r\n            val = decodeURIComponent(param[1]);\r\n\r\n            // Coerce values.\r\n            if (coerce) {\r\n                val = val && !isNaN(val) && ((+val + '') === val) ? +val        // number\r\n                    : val === 'undefined' ? undefined         // undefined\r\n                        : coerceTypes[val] !== undefined ? coerceTypes[val] // true, false, null\r\n                            : val;                                                          // string\r\n            }\r\n\r\n            if (keysLast) {\r\n                let cur = obj;\r\n                // Complex key, build deep object structure based on a few rules:\r\n                // * The 'cur' pointer starts at the object top-level.\r\n                // * [] = array push (n is set to array length), [n] = array if n is\r\n                //   numeric, otherwise object.\r\n                // * If at the last keys part, set the value.\r\n                // * For each keys part, if the current level is undefined create an\r\n                //   object or array based on the type of the next keys part.\r\n                // * Move the 'cur' pointer to the next level.\r\n                // * Rinse & repeat.\r\n                for (; i <= keysLast; i++) {\r\n                    key = keys[i] === '' ? cur.length : keys[i];\r\n                    cur = cur[key] = i < keysLast\r\n                        ? cur[key] || (keys[i + 1] && isNaN(keys[i + 1]) ? {} : [])\r\n                        : val;\r\n                }\r\n\r\n            } else {\r\n                // Simple key, even simpler rules, since only scalars and shallow\r\n                // arrays are allowed.\r\n\r\n                if (Object.prototype.toString.call(obj[key]) === '[object Array]') {\r\n                    // val is already an array, so push on the next value.\r\n                    obj[key].push(val);\r\n                } else if ({}.hasOwnProperty.call(obj, key)) {\r\n                    // val isn't an array, but since a second value has been specified,\r\n                    // convert val into an array.\r\n                    obj[key] = [obj[key], val];\r\n                } else {\r\n                    // val is a scalar.\r\n                    obj[key] = val;\r\n                }\r\n            }\r\n        } else if (key) {\r\n            // No value was defined, so set something meaningful.\r\n            obj[key] = coerce\r\n                ? undefined\r\n                : '';\r\n        }\r\n    });\r\n\r\n    return obj;\r\n}\r\n\r\nfunction normalizeConfig(config) {\r\n    if (config.lines) {\r\n        config.l = config.lines;\r\n        delete config.lines;\r\n    }\r\n\r\n    // BF (2020.11.27): it is very old and can be deleted\r\n    if (config._ids) {\r\n        const ids    = config._ids    ? config._ids.split(';')    : [];\r\n        const colors = config._colors ? config._colors.split(';') : [];\r\n        const names  = config._names  ? config._names.split(';')  : [];\r\n        const units  = config._units  ? config._units.split(';')  : [];\r\n        config.l = [];\r\n        for (let i = 0; i < ids.length; i++) {\r\n            config.l.push({\r\n                id:         ids[i],\r\n                offset:     0,\r\n                name:       names[i] || '',\r\n                aggregate:  'onchange',\r\n                color:      colors[i] || 'blue',\r\n                thickness:  config.strokeWidth || 1,\r\n                shadowsize: config.strokeWidth || 1,\r\n                min:        config.min || '',\r\n                max:        config.max || '',\r\n                unit:       units[i]   || ''\r\n            });\r\n        }\r\n        config.aggregateType = 'step';\r\n        config.aggregateSpan = 300;\r\n        config.relativeEnd   = 'now';\r\n    }\r\n\r\n    // convert art to aggregate (from flot)\r\n    if (config.l) {\r\n        for (let j = 0; j < config.l.length; j++) {\r\n            // BF (2020.11.27): it is very old and can be deleted\r\n            if (config.l[j].art) {\r\n                config.l[j].aggregate = config.l[j].art;\r\n                delete config.l[j].art;\r\n            }\r\n            if (config.instance && !config.l[j].instance) {\r\n                config.l[j].instance = config.instance || '';\r\n            }\r\n            config.l[j].yOffset   = parseFloat(config.l[j].yOffset)   || 0;\r\n            config.l[j].offset    = parseFloat(config.l[j].offset)    || 0;\r\n            config.l[j].validTime = parseFloat(config.l[j].validTime) || 0;\r\n        }\r\n    }\r\n\r\n    config.l = config.l || [];\r\n\r\n    // convert marks\r\n    if (config.m) {\r\n        config.marks = [];\r\n        for (let j = 0; j < config.m.length; j++) {\r\n            config.marks[j] = {\r\n                lineId:         parseInt(config.m[j].l, 10).toString(),\r\n                upperValueOrId: config.m[j].v,\r\n                lowerValueOrId: config.m[j].vl,\r\n                color:          config.m[j].c,\r\n                fill:           parseFloat(config.m[j].f) || 0.2,\r\n                ol:             parseInt(config.m[j].t, 10) || 1,\r\n                os:             parseInt(config.m[j].s, 10) || 0,\r\n                text:           config.m[j].d,\r\n                textPosition:   config.m[j].p,\r\n                textOffset:     parseFloat(config.m[j].py) || 0,\r\n                textColor:      config.m[j].fc || '',\r\n                textSize:       parseInt(config.m[j].fs, 10) || undefined,\r\n            };\r\n        }\r\n        delete config.m;\r\n    }\r\n\r\n    config.marks = config.marks || [];\r\n\r\n    if (!config.l.length) {\r\n        config.l.push({id: '', unit: ''});\r\n    }\r\n\r\n    // Set default values\r\n    config.width        = config.width                   || '100%';\r\n    config.height       = config.height                  || '100%';\r\n    config.timeFormat   = config.timeFormat              || '';\r\n    config.useComma     = config.useComma    === 'true'  || config.useComma    === true;\r\n    config.zoom         = config.zoom        === 'true'  || config.zoom        === true;\r\n    config.export       = config.export      === 'true'  || config.export      === true;\r\n    config.grid_hideX   = config.grid_hideX  === 'true'  || config.grid_hideX  === true;\r\n    config.grid_hideY   = config.grid_hideY  === 'true'  || config.grid_hideY  === true;\r\n    config.hoverDetail  = config.hoverDetail === 'true'  || config.hoverDetail === true;\r\n    config.noLoader     = config.noLoader    === 'true'  || config.noLoader    === true;\r\n    config.noedit       = config.noedit      === 'true'  || config.noedit      === true;\r\n    config.animation    = parseInt(config.animation)     || 0;\r\n    config.afterComma   = config.afterComma === undefined ? 2 : parseInt(config.afterComma, 10);\r\n    config.timeType     = config.timeType || 'relative';\r\n    return config;\r\n}\r\n\r\nfunction _readFlotSettings(socket) {\r\n    return new Promise((resolve, reject) =>\r\n        socket.getRawSocket().emit('getObjectView', 'chart', 'chart', {\r\n            startkey: 'flot.',\r\n            endkey: 'flot.\\u9999'\r\n        }, (err, res) => {\r\n            if (err) {\r\n                reject(err);\r\n            } else {\r\n                const charts = [];\r\n                res && res.rows && res.rows.forEach(obj => charts.push(obj.value));\r\n                resolve(charts);\r\n            }\r\n        }));\r\n}\r\n\r\nfunction _executeWriteTasks(socket, tasks, _resolve) {\r\n    if (!_resolve) {\r\n        return new Promise(resolve => _executeWriteTasks(socket, tasks, resolve));\r\n    } else if (!tasks || !tasks.length) {\r\n        _resolve();\r\n    } else {\r\n        const obj = tasks.shift();\r\n        if (obj) {\r\n            socket.getObject(obj._id)\r\n                .catch(() => null)\r\n                .then(exists => {\r\n                    if (!exists) {\r\n                        socket.setObject(obj._id, obj)\r\n                            .then(() => setTimeout(() => _executeWriteTasks(socket, tasks, _resolve), 50));\r\n                    } else {\r\n                        console.log(`Object ${obj._id} already exists and will not be converted`);\r\n                        setTimeout(() => _executeWriteTasks(socket, tasks, _resolve), 50);\r\n                    }\r\n                });\r\n        } else {\r\n            setTimeout(() => _executeWriteTasks(socket, tasks, _resolve), 50);\r\n        }\r\n    }\r\n}\r\n\r\nfunction _flot2echarts(flotObj, instance) {\r\n    // convert name\r\n    const echartsObj = {\r\n        _id: flotObj._id.replace(/^flot.\\d+/, 'echarts.' + instance),\r\n        common: {\r\n            name: flotObj.common.name,\r\n            expert: true,\r\n        },\r\n        native: {\r\n\r\n        },\r\n        type: 'chart',\r\n    };\r\n\r\n    if (echartsObj._id.endsWith('.')) {\r\n        echartsObj._id = 'empty_' + Math.round(Math.random() * 10000);\r\n    }\r\n\r\n    /*\r\n    {\r\n          \"l\": [\r\n            {\r\n              \"id\": \"javascript.0.dimmer\",\r\n              \"offset\": \"0\",\r\n              \"aggregate\": \"minmax\",\r\n              \"color\": \"#FF0000\",\r\n              \"thickness\": \"3\",\r\n              \"shadowsize\": \"3\",\r\n              \"fill\": \"0.9\"\r\n            }\r\n          ],\r\n          \"timeType\": \"relative\",\r\n          \"relativeEnd\": \"now\",\r\n          \"range\": \"10\",\r\n          \"aggregateType\": \"count\",\r\n          \"aggregateSpan\": \"300\",\r\n          \"hoverDetail\": \"false\",\r\n          \"useComma\": \"false\",\r\n          \"zoom\": \"false\",\r\n          \"noedit\": \"false\",\r\n          \"animation\": \"0\",\r\n          \"m\": [\r\n            {\r\n              \"l\": \"0\",\r\n              \"v\": \"0\",\r\n              \"f\": \"false\",\r\n              \"c\": \"#FF0000\",\r\n              \"t\": \"3\",\r\n              \"s\": \"3\",\r\n              \"d\": \"\",\r\n              \"p\": \"l\",\r\n              \"py\": \"0\",\r\n              \"fc\": \"#FF0000\",\r\n              \"fs\": \"\",\r\n              \"vl\": \"100\"\r\n            },\r\n            {\r\n              \"l\": \"0\",\r\n              \"v\": \"0\",\r\n              \"f\": \"false\",\r\n              \"c\": \"#00FF00\",\r\n              \"t\": \"3\",\r\n              \"s\": \"3\",\r\n              \"d\": \"\",\r\n              \"p\": \"l\",\r\n              \"py\": \"0\",\r\n              \"fc\": \"#00FF00\",\r\n              \"fs\": \"\",\r\n              \"vl\": \"50\"\r\n            }\r\n          ]\r\n        }\r\n     */\r\n\r\n    const data = normalizeConfig(deParam(flotObj.native.url));\r\n\r\n    if (!data.lines) {\r\n        data.lines = data.l;\r\n        delete data.l;\r\n    }\r\n\r\n    echartsObj.native.data = data;\r\n\r\n    console.log(`Convert ${flotObj._id} => ${echartsObj._id}`);\r\n    return echartsObj;\r\n}\r\n\r\n\r\nfunction flotConverter(socket, instance) {\r\n    instance = instance || 0;\r\n\r\n    let instanceObj;\r\n\r\n    return socket.getObject('system.adapter.echarts.' + instance)\r\n        .then(obj => {\r\n            instanceObj = obj;\r\n            if (obj && obj.native && !obj.native.convertDone) {\r\n                return _readFlotSettings(socket);\r\n            } else {\r\n                return Promise.resolve([]);\r\n            }\r\n        })\r\n        .then(charts =>\r\n            // convert every chart\r\n            _executeWriteTasks(socket, charts.map(obj => _flot2echarts(obj, instance)))\r\n        )\r\n        .then(() => {\r\n            if (!instanceObj.native.convertDone) {\r\n                instanceObj.native.convertDone = true;\r\n                return socket.setObject(instanceObj._id, instanceObj);\r\n            } else {\r\n                return Promise.resolve();\r\n            }\r\n        })\r\n        .catch(e => {\r\n            console.error(`Cannot convert flot: ${e}`);\r\n            return Promise.resolve();\r\n        });\r\n}\r\n\r\nmodule.exports = flotConverter;","export const DEFAULT_CONVERTER = 'rgba_hex';\r\nexport const converters = {\r\n  rgba: c => `rgba(${c.rgb.r}, ${c.rgb.g}, ${c.rgb.b}, ${c.rgb.a})`,\r\n  rgb: c => `rgb(${c.rgb.r}, ${c.rgb.g}, ${c.rgb.b})`,\r\n  hex: c => c.hex,\r\n\r\n  rgba_rgb: c => c.rgb.a === 1 ? converters.rgb(c) : converters.rgba(c),\r\n  rgba_hex: c => c.rgb.a === 1 ? converters.hex(c) : converters.rgba(c)\r\n};\r\n\r\nexport default converters;\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { ChromePicker } from 'react-color'\r\n\r\nconst PickerDialog = ({\r\n  value,\r\n  onClick,\r\n  onChange,\r\n  className\r\n}) => (\r\n  <div style={{ position: 'relative' }}>\r\n    <div style={{ position: 'absolute', zIndex: '2' }}>\r\n      <div\r\n        style={{ position: 'fixed', top: '0px', right: '0px', bottom: '0px', left: '0px' }}\r\n        onClick={onClick}\r\n      />\r\n      <ChromePicker\r\n        color={value}\r\n        onChange={onChange}\r\n        className={className}\r\n      />\r\n    </div>\r\n  </div>\r\n);\r\n\r\nPickerDialog.propTypes = {\r\n  value: PropTypes.string,\r\n  onChange: PropTypes.func,\r\n  onClick: PropTypes.func,\r\n  className: PropTypes.any\r\n};\r\n\r\nexport default PickerDialog\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport compose from 'recompose/compose'\r\nimport withState from 'recompose/withState'\r\n\r\nimport TextField from '@material-ui/core/TextField'\r\n\r\nimport { DEFAULT_CONVERTER, converters } from '../transformers'\r\nimport PickerDialog from './PickerDialog'\r\n\r\nconst ColorPicker = ({\r\n  // ColorPicker\r\n  onChange,\r\n  convert,\r\n\r\n  // Text field\r\n  name,\r\n  id,\r\n  hintText,\r\n  placeholder,\r\n  floatingLabelText,\r\n  label,\r\n  TextFieldProps,\r\n  value,\r\n\r\n  // State\r\n  showPicker,\r\n  setShowPicker,\r\n  internalValue,\r\n  setValue,\r\n  pickerClassName,\r\n\r\n  ...custom\r\n}) => (\r\n  <>\r\n    <TextField\r\n      name={name}\r\n      id={id}\r\n      label={floatingLabelText || label}\r\n      placeholder={hintText || placeholder}\r\n      onClick={() => setShowPicker(true)}\r\n      onChange={e => {\r\n        setValue(e.target.value);\r\n        onChange(e.target.value)\r\n      }}\r\n      InputProps={{ style: { color: value === undefined ? internalValue : value } }}\r\n      {...TextFieldProps}\r\n      {...custom}\r\n    />\r\n    {showPicker && (\r\n      <PickerDialog\r\n        value={value === undefined ? internalValue : value}\r\n        onClick={() => {\r\n          setShowPicker(false);\r\n          onChange(value)\r\n        }}\r\n        onChange={c => {\r\n          const newValue = converters[convert](c);\r\n          setValue(newValue);\r\n          onChange(newValue)\r\n        }}\r\n        className={pickerClassName}\r\n      />\r\n    )}\r\n  </>\r\n);\r\n\r\nColorPicker.propTypes = {\r\n  value: PropTypes.string,\r\n  onChange: PropTypes.func,\r\n  convert: PropTypes.oneOf(Object.keys(converters)),\r\n  name: PropTypes.string,\r\n  id: PropTypes.string,\r\n  hintText: PropTypes.string,\r\n  placeholder: PropTypes.string,\r\n  label: PropTypes.string,\r\n  floatingLabelText: PropTypes.string,\r\n  TextFieldProps: PropTypes.shape(TextField.propTypes),\r\n  showPicker: PropTypes.bool,\r\n  setShowPicker: PropTypes.func,\r\n  internalValue: PropTypes.string,\r\n  setValue: PropTypes.func,\r\n  pickerClassName: PropTypes.any\r\n};\r\n\r\nColorPicker.defaultProps = {\r\n  convert: DEFAULT_CONVERTER\r\n};\r\n\r\nconst makeColorPicker = compose(\r\n  withState('showPicker', 'setShowPicker', false),\r\n  withState('internalValue', 'setValue', ({ defaultValue }) => defaultValue)\r\n);\r\n\r\nconst MakedColorPicker = makeColorPicker(ColorPicker);\r\n\r\nconst ColorPickerField = ({ input: { value, onChange, ...restInput }, meta: { touched, error }, ...restProps }) => (\r\n  <MakedColorPicker\r\n    value={value}\r\n    onChange={onChange}\r\n    errorText={touched && error}\r\n    {...restInput}\r\n    {...restProps}\r\n  />\r\n);\r\n\r\nColorPickerField.propTypes = {\r\n  input: PropTypes.object,\r\n  meta: PropTypes.object\r\n};\r\n\r\nexport default MakedColorPicker\r\n\r\nexport {\r\n  ColorPickerField\r\n}\r\n","import ColorPicker from './components/ColorPicker'\r\nexport default ColorPicker\r\n","import React, {useState} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport clsx from 'clsx';\r\n\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Select from '@material-ui/core/Select';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Slider from '@material-ui/core/Slider';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport IconSelectID from '@material-ui/icons/Subject';\r\n\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\nimport DialogSelectID from '@iobroker/adapter-react/Dialogs/SelectID';\r\nimport ColorPicker from './ColorPicker';\r\nimport ClearIcon from \"@material-ui/icons/Close\";\r\nimport HelpIcon from \"@material-ui/icons/Help\";\r\n\r\nconst styles = theme => ({\r\n    fieldContainer: {\r\n        paddingTop: 10,\r\n        whiteSpace: 'nowrap'\r\n    },\r\n    checkBoxLabel: {\r\n        fontSize: '0.8rem'\r\n    },\r\n    objectContainer: {display: 'flex'},\r\n    objectField: {flex: 1},\r\n    objectButton: {\r\n        marginTop: 'auto',\r\n        paddingLeft: 0\r\n    },\r\n    colorPicker: {\r\n        left: -200,\r\n        top: 60,\r\n        position: 'relative'\r\n    },\r\n    sliderContainer: {\r\n        position: 'relative',\r\n        //height: theme.spacing(3),\r\n    },\r\n    sliderLabel: {\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        fontSize: 'small'\r\n    },\r\n    sliderRoot: {\r\n        paddingBottom: 0,\r\n        paddingTop: theme.spacing(2),\r\n    }\r\n});\r\n\r\nlet IOSelect = function (props) {\r\n    const label = I18n.t(props.label);\r\n    return <div className={clsx(props.classes.fieldContainer, props.className)}>\r\n        <FormControl style={{minWidth: props.minWidth || 200, width: props.width}}>\r\n            <InputLabel shrink={true}>{ label }</InputLabel>\r\n            <Select\r\n                disabled={!!props.disabled}\r\n                label={label}\r\n                style={{color: props.colors ? props.colors[props.formData[props.name]] || undefined : undefined}}\r\n                onChange={e => props.updateValue(props.name, e.target.value)}\r\n                value={props.formData[props.name] || ''}\r\n                renderValue={props.renderValue}\r\n                displayEmpty\r\n            >{\r\n                props.options ?\r\n                    Object.keys(props.options).map(key =>\r\n                        <MenuItem key={key} value={key} style={{color: props.colors ? props.colors[key] || undefined : undefined}}>{\r\n                            props.noTranslate ? props.options[key] : (props.options[key] !== '' && props.options[key] !== null && props.options[key] !== undefined? I18n.t(props.options[key]) : '')\r\n                        }</MenuItem>)\r\n                     : null\r\n            }\r\n            </Select>\r\n        </FormControl>\r\n    </div>;\r\n};\r\nIOSelect.propTypes = {\r\n    disabled: PropTypes.bool,\r\n    label: PropTypes.string,\r\n    name: PropTypes.string,\r\n    value: PropTypes.any,\r\n    formData: PropTypes.object,\r\n    options: PropTypes.object,\r\n    colors: PropTypes.object,\r\n};\r\nIOSelect = withStyles(styles)(IOSelect);\r\nexport {IOSelect};\r\n\r\nlet IOCheckbox = function (props) {\r\n    return <div className={props.classes.fieldContainer}>\r\n        <FormControlLabel style={{paddingTop: 10}} label={<span className={props.classes.checkBoxLabel}>{I18n.t(props.label)}</span>} control={\r\n            <Checkbox\r\n                disabled={!!props.disabled}\r\n                onChange={e => {\r\n                    props.updateValue(props.name, e.target.checked)\r\n                }}\r\n                checked={props.formData[props.name] || false}\r\n            />\r\n        }/>\r\n    </div>;\r\n};\r\nIOCheckbox.propTypes = {\r\n    disabled: PropTypes.bool,\r\n    label: PropTypes.string,\r\n    name: PropTypes.string,\r\n    value: PropTypes.any,\r\n    formData: PropTypes.object,\r\n};\r\nIOCheckbox = withStyles(styles)(IOCheckbox);\r\nexport {IOCheckbox};\r\n\r\nlet IOTextField = function (props) {\r\n    return <div className={props.classes.fieldContainer}>\r\n        <TextField\r\n            disabled={!!props.disabled}\r\n            style={{width: props.formData[props.name] ? (props.width ? props.width - 30 : 'calc(100% - 30px)') : (props.width || '100%')}}\r\n            label={I18n.t(props.label)}\r\n            InputLabelProps={{shrink: true}}\r\n            inputProps={{min: props.min, max: props.max}}\r\n            onChange={e => props.updateValue(props.name, e.target.value)}\r\n            value={props.formData[props.name] || ''}\r\n            type={props.type}\r\n            title={props.title || ''}\r\n            InputProps={{\r\n                startAdornment: !props.disabled && props.helperLink ? <IconButton\r\n                    size=\"small\"\r\n                    onClick={() => window.open(props.helperLink,'_blank')}>\r\n                    <HelpIcon />\r\n                </IconButton> : undefined,\r\n\r\n                endAdornment: !props.disabled && props.formData[props.name] ?\r\n                    <IconButton\r\n                        size=\"small\"\r\n                        onClick={() => props.updateValue(props.name, '')}>\r\n                        <ClearIcon />\r\n                    </IconButton>\r\n                    : undefined,\r\n            }}\r\n        />\r\n    </div>;\r\n};\r\nIOTextField.propTypes = {\r\n    disabled: PropTypes.bool,\r\n    label: PropTypes.string,\r\n    name: PropTypes.string,\r\n    value: PropTypes.any,\r\n    formData: PropTypes.object,\r\n    type: PropTypes.string,\r\n    min: PropTypes.number,\r\n    max: PropTypes.number,\r\n    helperLink: PropTypes.string,\r\n    width: PropTypes.number,\r\n};\r\nIOTextField = withStyles(styles)(IOTextField);\r\nexport {IOTextField};\r\n\r\nlet IODateTimeField = function (props) {\r\n    return <div className={props.classes.fieldContainer}>\r\n        <TextField type=\"datetime-local\" label={I18n.t(props.label)} InputLabelProps={{shrink: true}} onChange={e => {\r\n            let date = e.target.value.split('T');\r\n            props.updateValue(props.name, date[0], date[1]);\r\n        }} value={props.formData[props.name] ? props.formData[props.name] + 'T' + props.formData[props.name + '_time'] : ''}/>\r\n    </div>;\r\n};\r\nIODateTimeField.propTypes = {\r\n    label: PropTypes.string,\r\n    name: PropTypes.string,\r\n    value: PropTypes.any,\r\n    formData: PropTypes.object,\r\n};\r\nIODateTimeField = withStyles(styles)(IODateTimeField);\r\nexport {IODateTimeField};\r\n\r\nlet IOObjectField = function (props) {\r\n    let [state, setState] = useState({});\r\n\r\n    return <div className={props.classes.fieldContainer} style={{width: props.width}}>\r\n        <div className={props.classes.objectContainer}>\r\n            <TextField\r\n                disabled={!!props.disabled}\r\n                className={props.classes.objectField}\r\n                label={I18n.t(props.label)}\r\n                fullWidth={true}\r\n                InputLabelProps={{shrink: true}}\r\n                value={props.formData[props.name] || ''}\r\n                onChange={e => props.updateValue(props.name, e.target.value)}\r\n            />\r\n            <IconButton\r\n                disabled={!!props.disabled}\r\n                size=\"small\"\r\n                onClick={() => setState({showDialog: true})}\r\n                className={props.classes.objectButton}\r\n            >\r\n                <IconSelectID/>\r\n            </IconButton>\r\n        </div>\r\n        {state.showDialog ? <DialogSelectID\r\n                key={'selectDialog_' + props.name}\r\n                socket={ props.socket }\r\n                dialogName={props.name}\r\n                customFilter={props.customFilter}\r\n                title={ I18n.t('Select for ') + props.label}\r\n                selected={ props.formData[props.name] }\r\n                onOk={e => {\r\n                    props.updateValue(props.name, e);\r\n                    setState({showDialog: false});\r\n                } }\r\n                onClose={ () => setState({showDialog: false}) }\r\n            /> : null\r\n        }\r\n    </div>;\r\n};\r\nIOObjectField.propTypes = {\r\n    disabled: PropTypes.bool,\r\n    label: PropTypes.string,\r\n    name: PropTypes.string,\r\n    value: PropTypes.any,\r\n    formData: PropTypes.object,\r\n    socket: PropTypes.object,\r\n    customFilter: PropTypes.object,\r\n};\r\nIOObjectField = withStyles(styles)(IOObjectField);\r\nexport {IOObjectField};\r\n\r\nlet IOColorPicker = function (props) {\r\n    return <div className={props.classes.fieldContainer}>\r\n        <ColorPicker\r\n            disabled={!!props.disabled}\r\n            variant=\"standard\"\r\n            label={I18n.t(props.label)}\r\n            pickerClassName={props.classes.colorPicker}\r\n            inputProps={{\r\n                style: {backgroundColor: props.formData[props.name]}\r\n            }}\r\n            InputProps={{\r\n                endAdornment: !props.disabled && props.formData[props.name] ?\r\n                    <IconButton\r\n                        size=\"small\"\r\n                        onClick={() => props.updateValue(props.name, '')}>\r\n                        <ClearIcon />\r\n                    </IconButton>\r\n                    : undefined,\r\n            }}\r\n            onChange={color => props.updateValue(props.name, color)}\r\n            InputLabelProps={{shrink: true}}\r\n            value={props.formData[props.name] || ''}\r\n        />\r\n    </div>;\r\n};\r\nIOColorPicker.propTypes = {\r\n    disabled: PropTypes.bool,\r\n    label: PropTypes.string,\r\n    name: PropTypes.string,\r\n    value: PropTypes.any,\r\n    formData: PropTypes.object,\r\n};\r\nIOColorPicker = withStyles(styles)(IOColorPicker);\r\nexport {IOColorPicker};\r\n\r\nlet IOSlider = function (props) {\r\n    return <div className={clsx(props.classes.fieldContainer, props.classes.sliderContainer)}>\r\n        <Typography className={props.classes.sliderLabel}>{props.label}</Typography>\r\n        <Slider\r\n            disabled={!!props.disabled}\r\n            classes={{root: props.classes.sliderRoot}}\r\n            value={parseFloat(props.formData[props.name] || props.min || 0) || 0}\r\n            //getAriaValueText={(props.formData[props.name] || '').toString()}\r\n            step={parseFloat(props.step || (((props.max || 1) - (props.min || 0)) / 10)) || 0.1}\r\n            marks\r\n            onChange={(e, value) => props.updateValue(props.name, value)}\r\n            min={parseFloat(props.min || 0)}\r\n            max={parseFloat(props.max || 1)}\r\n            valueLabelDisplay=\"auto\"\r\n        />\r\n    </div>;\r\n};\r\nIOSlider.propTypes = {\r\n    disabled: PropTypes.bool,\r\n    label: PropTypes.string,\r\n    name: PropTypes.string,\r\n    value: PropTypes.any,\r\n    min: PropTypes.number,\r\n    max: PropTypes.number,\r\n    step: PropTypes.number,\r\n    formData: PropTypes.object,\r\n};\r\nIOSlider = withStyles(styles)(IOSlider);\r\nexport {IOSlider};\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport clsx from 'clsx';\r\n\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardContent from '@material-ui/core/CardContent';\r\n\r\nimport {MdDelete as IconDelete} from 'react-icons/md';\r\nimport {MdContentCopy as IconCopy} from 'react-icons/md';\r\nimport {MdMenu as IconDrag} from 'react-icons/md';\r\nimport {MdContentPaste as IconPaste} from 'react-icons/md';\r\nimport {FaFolder as IconFolderClosed} from 'react-icons/fa';\r\nimport {FaFolderOpen as IconFolderOpened} from 'react-icons/fa';\r\n\r\nimport Utils from '@iobroker/adapter-react/Components/Utils';\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\nimport ColorPicker from '@iobroker/adapter-react/Components/ColorPicker';\r\n\r\nimport {IOTextField, IOCheckbox, IOSelect, IOObjectField, IOSlider} from './Fields';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport ClearIcon from '@material-ui/icons/Close';\r\n\r\nconst WIDTHS = {\r\n    instance: 100,\r\n    id: 200,\r\n    chartType: 120,\r\n    dataType: 110,\r\n    color: 100,\r\n    name: 200,\r\n    buttons: 50 + 50 + 16\r\n};\r\n\r\nconst LINE_HEIGHT = 48;\r\n\r\nlet styles = theme => ({\r\n    card: {\r\n        borderStyle: 'dashed',\r\n        borderWidth: 1,\r\n        marginBottom: theme.spacing(1),\r\n        padding: theme.spacing(1),\r\n        borderColor: theme.palette.grey['600'],\r\n        overflow: 'initial'\r\n    },\r\n    cardPaste: {\r\n        borderColor: theme.type === 'dark' ? theme.palette.grey['400'] : theme.palette.grey['800'],\r\n        backgroundColor: 'rgba(0,0,0,0)',\r\n        opacity: 0.8,\r\n    },\r\n    cardContent: {\r\n        padding: 0,\r\n        margin: 0,\r\n        '&:last-child': {\r\n            padding: 0,\r\n        }\r\n    },\r\n    shortFields: {\r\n        display: 'block',\r\n        '& > div': {\r\n            display: 'inline-flex',\r\n            paddingRight: 20,\r\n            width: 200,\r\n        },\r\n        position: 'relative',\r\n        paddingBottom: theme.spacing(2),\r\n        borderBottom: '1px dotted ' + theme.palette.grey[400]\r\n    },\r\n    title: {\r\n        width: 'inherit',\r\n        position: 'absolute',\r\n        whiteSpace: 'nowrap',\r\n        right: 0,\r\n        fontSize: 48,\r\n        opacity: 0.1,\r\n        lineHeight: '48px',\r\n        padding: 0,\r\n        marginTop: 20,\r\n        marginLeft: 0,\r\n        marginRight: 0,\r\n        marginBottom: 0,\r\n        paddingRight: 10,\r\n    },\r\n    shortFieldsLast: {\r\n        borderBottom: '0px',\r\n        paddingBottom: 0,\r\n    },\r\n    shortInstanceField: {\r\n        display: 'inline-block',\r\n        minWidth: WIDTHS.instance,\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n    },\r\n    shortIdField: {\r\n        display: 'inline-block',\r\n        minWidth: WIDTHS.id,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n    },\r\n    shortDataTypeField: {\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        display: 'inline-block',\r\n        minWidth: WIDTHS.dataType,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        verticalAlign: 'top',\r\n    },\r\n    shortChartTypeField: {\r\n        display: 'inline-block',\r\n        minWidth: WIDTHS.chartType,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n    },\r\n    shortColorField: {\r\n        display: 'inline-block',\r\n        minWidth: WIDTHS.color,\r\n        width: WIDTHS.color,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n    },\r\n    shortNameField: {\r\n        display: 'inline-block',\r\n        minWidth: WIDTHS.name,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n    },\r\n    shortButtonsField: {\r\n        display: 'inline-block',\r\n        minWidth: WIDTHS.buttons,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n    },\r\n    deleteButton: {\r\n        float: 'right',\r\n        marginRight: 12\r\n    },\r\n    deleteButtonFull: {\r\n        float: 'right',\r\n        marginRight: 12\r\n    },\r\n    copyButtonFull: {\r\n        float: 'right',\r\n        marginRight: 0\r\n    },\r\n    fullWidth: {\r\n        width: '100%',\r\n        minWidth: 200\r\n    },\r\n    paste: {\r\n        opacity: 0.3\r\n    },\r\n    emptyDrag: {\r\n        display: 'inline-block',\r\n        width: 16,\r\n    }\r\n});\r\n\r\nclass Line extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            width: this.props.width\r\n        };\r\n    }\r\n\r\n    updateField = (name, value) => {\r\n        let line = JSON.parse(JSON.stringify(this.props.line));\r\n        line[name] = value;\r\n\r\n        if (name === 'id') {\r\n            // If ID changed => read unit and name\r\n            if (this.props.line.id !== value) {\r\n                return this.props.socket.getObject(value)\r\n                    .then(obj => {\r\n                        if (obj && obj.common && obj.common.name) {\r\n                            name = Utils.getObjectNameFromObj(obj, null, {language: I18n.getLanguage()});\r\n                        } else {\r\n                            let _name = value.split('.');\r\n                            name = _name.length ? _name[_name.length - 1] : '';\r\n                        }\r\n                        if (obj && obj.common && obj.common.unit) {\r\n                            line.unit = obj.common.unit;\r\n                        }\r\n                        if (obj && obj.common && (obj.common.type === 'boolean' || obj.common.type === 'number')) {\r\n                            line.chartType = 'auto';\r\n                            line.aggregate = '';\r\n                        }\r\n                    })\r\n                    .catch(e => {\r\n                        console.error(e);\r\n                        let _name = value.split('.');\r\n                        name = _name.length ? _name[_name.length - 1] : '';\r\n                    })\r\n                    .then(() => {\r\n                        line.name = name;\r\n                        this.props.updateLine(this.props.index, line);\r\n                    });\r\n            }\r\n        }\r\n        this.props.updateLine(this.props.index, line);\r\n    };\r\n\r\n    static getDerivedStateFromProps(props, state) {\r\n        if (props.width !== state.width) {\r\n            return {width: props.width};\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    renderClosedLine() {\r\n        const visible = {};\r\n\r\n        const windowWidth = this.props.width - 95;\r\n        const padding = 8;\r\n\r\n        let idWidth;\r\n        if (windowWidth >= WIDTHS.instance + WIDTHS.id + WIDTHS.chartType + WIDTHS.dataType + WIDTHS.color + WIDTHS.name + WIDTHS.buttons + padding * 6) {\r\n            idWidth = `calc(100% - ${WIDTHS.instance + WIDTHS.chartType + WIDTHS.dataType + WIDTHS.color + WIDTHS.name + WIDTHS.buttons + padding * 6}px)`;\r\n            visible.chartType = true;\r\n            visible.dataType = true;\r\n            visible.color = true;\r\n            visible.name = true;\r\n        } else if (windowWidth >= WIDTHS.instance + WIDTHS.id + WIDTHS.chartType + WIDTHS.dataType + WIDTHS.color + WIDTHS.buttons + padding * 5) {\r\n            idWidth = `calc(100% - ${WIDTHS.buttons + WIDTHS.instance + WIDTHS.chartType + WIDTHS.dataType + WIDTHS.color + padding * 5}px)`;\r\n            visible.chartType = true;\r\n            visible.dataType = true;\r\n            visible.color = true;\r\n        } else if (windowWidth >= WIDTHS.instance + WIDTHS.id + WIDTHS.chartType + WIDTHS.dataType + WIDTHS.buttons + padding * 4) {\r\n            idWidth = `calc(100% - ${WIDTHS.buttons + WIDTHS.instance + WIDTHS.chartType + WIDTHS.dataType + padding * 4}px)`;\r\n            visible.chartType = true;\r\n            visible.dataType = true;\r\n        } else if (windowWidth >= WIDTHS.instance + WIDTHS.id + WIDTHS.chartType + WIDTHS.buttons + padding * 3) {\r\n            // nothing visible\r\n            idWidth = `calc(100% - ${WIDTHS.buttons + WIDTHS.instance + WIDTHS.chartType + padding * 3}px)`;\r\n            visible.chartType = true;\r\n        } else {\r\n            // nothing visible\r\n            idWidth = `calc(100% - ${WIDTHS.buttons + WIDTHS.instance + padding * 2}px)`;\r\n        }\r\n\r\n        return <div className={this.props.classes.lineClosed}>\r\n            {this.props.provided ? <span title={ I18n.t('Drag me') } {...this.props.provided.dragHandleProps}><IconDrag/></span> : <div className={this.props.classes.emptyDrag}/> }\r\n            {this.props.onPaste && this.props.onPaste ?\r\n                <IconButton\r\n                    title={I18n.t('Paste')}\r\n                    onClick={() => this.props.onPaste()}>\r\n                    <IconPaste/>\r\n                </IconButton>\r\n                :\r\n                <IconButton\r\n                    title={I18n.t('Edit')}\r\n                    onClick={() => this.props.lineOpenToggle(this.props.index)}>\r\n                    <IconFolderClosed/>\r\n                </IconButton>\r\n            }\r\n            <IOSelect\r\n                disabled={!!this.props.onPaste}\r\n                formData={this.props.line}\r\n                updateValue={this.updateField}\r\n                name=\"instance\"\r\n                label=\"Instance\"\r\n                noTranslate={true}\r\n                options={(() => {\r\n                    let result = {'': I18n.t('standard')};\r\n                    this.props.instances.forEach(instance => result[instance._id] = instance._id.replace('system.adapter.', ''));\r\n                    return result;\r\n                })()}\r\n                minWidth={WIDTHS.instance}\r\n                classes={{fieldContainer: clsx(this.props.classes.shortInstanceField, this.props.onPaste && this.props.classes.paste)}}\r\n            />\r\n            <IOObjectField\r\n                disabled={!!this.props.onPaste}\r\n                formData={this.props.line}\r\n                updateValue={this.updateField}\r\n                name=\"id\"\r\n                width={idWidth}\r\n                label=\"ID\"\r\n                customFilter={{common: {custom: this.props.line.instance ? this.props.line.instance.replace('system.adapter.', '') : this.props.systemConfig.common.defaultHistory || true}}}\r\n                classes={{fieldContainer: clsx(this.props.classes.shortIdField, this.props.onPaste && this.props.classes.paste)}}\r\n                socket={this.props.socket}\r\n            />\r\n            {visible.chartType ? <IOSelect\r\n                disabled={!!this.props.onPaste}\r\n                formData={this.props.line}\r\n                updateValue={this.updateField}\r\n                minWidth={WIDTHS.chartType}\r\n                name=\"chartType\"\r\n                label=\"Chart type\"\r\n                options={{\r\n                    auto: 'Auto',\r\n                    line: 'Line',\r\n                    //bar: 'Bar',\r\n                    scatterplot: 'Scatter plot',\r\n                    steps: 'Steps',\r\n                    stepsStart: 'Steps on start',\r\n                    spline: 'Spline',\r\n                }}\r\n                classes={{fieldContainer: clsx(this.props.classes.shortChartTypeField, this.props.onPaste && this.props.classes.paste)}}\r\n            /> : null}\r\n            {visible.dataType && this.props.line.chartType !== 'auto' ? <IOSelect\r\n                disabled={!!this.props.onPaste}\r\n                formData={this.props.line}\r\n                updateValue={this.updateField}\r\n                minWidth={WIDTHS.dataType}\r\n                name=\"aggregate\"\r\n                label=\"Type\"\r\n                options={{\r\n                    minmax: 'minmax',\r\n                    average: 'average',\r\n                    min: 'min',\r\n                    max: 'max',\r\n                    total: 'total',\r\n                    onchange: 'raw',\r\n                }}\r\n                classes={{fieldContainer: clsx(this.props.classes.shortDataTypeField, this.props.onPaste && this.props.classes.paste)}}\r\n            /> : null}\r\n            {visible.color ? this.renderColorField(this.props.line, this.updateField, 'Color', 'color', WIDTHS.color, clsx(this.props.classes.shortColorField, this.props.onPaste && this.props.classes.paste), true) : null}\r\n            {visible.name ? <IOTextField\r\n                disabled={!!this.props.onPaste}\r\n                width={WIDTHS.name}\r\n                formData={this.props.line}\r\n                updateValue={this.updateField}\r\n                name=\"name\"\r\n                label=\"Name\"\r\n                classes={{fieldContainer: clsx(this.props.classes.shortNameField, this.props.onPaste && this.props.classes.paste)}}\r\n            /> : null}\r\n            <IconButton\r\n                className={this.props.classes.deleteButton}\r\n                aria-label=\"Delete\"\r\n                title={I18n.t('Delete')}\r\n                onClick={() => this.props.deleteLine(this.props.index)}>\r\n                <IconDelete/>\r\n            </IconButton>\r\n        </div>;\r\n    }\r\n\r\n    renderColorField(formData, onUpdate, label, name, minWidth, className, noPadding) {\r\n        let textColor = Utils.isUseBright(formData[name], null);\r\n        if (textColor === null) {\r\n            textColor = undefined;\r\n        }\r\n        return <div className={className}>\r\n            <TextField\r\n                disabled={!!this.props.onPaste}\r\n                style={{minWidth, width: 'calc(100% - 8px)'}}\r\n                label={I18n.t(label)}\r\n                value={formData[name] || ''}\r\n                onClick={() =>\r\n                    !this.props.onPaste && this.setState({['_' + name]: formData[name]}, () =>\r\n                        this.props.onSelectColor(this.state['_' + name], color =>\r\n                            this.setState({['_' + name]: color}, () =>\r\n                                onUpdate(name, ColorPicker.getColor(color, true)))))\r\n                }\r\n                onChange={e => {\r\n                    const color = e.target.value;\r\n                    this.setState({['_' + name]: color}, () =>\r\n                        onUpdate(name, color));\r\n                }}\r\n                inputProps={{style: {paddingLeft: noPadding ? 0 : 8, backgroundColor: formData[name], color: textColor ? '#FFF' : '#000'}}}\r\n                InputProps={{\r\n                    endAdornment: formData[name] ?\r\n                        <IconButton\r\n                            disabled={!!this.props.onPaste}\r\n                            size=\"small\"\r\n                            onClick={e => {\r\n                                e.stopPropagation();\r\n                                this.setState({['_' + name]: ''}, () => onUpdate(name, ''));\r\n                            }}>\r\n                            <ClearIcon />\r\n                        </IconButton>\r\n                        : undefined,\r\n                }}\r\n                InputLabelProps={{shrink: true}}\r\n            />\r\n        </div>;\r\n    }\r\n\r\n    renderOpenedLine() {\r\n        const xAxisOptions = {\r\n            '': I18n.t('own axis')\r\n        };\r\n        for (let i = 0; i < this.props.maxLines; i++) {\r\n            if (i !== this.props.index) {\r\n                if (this.props.presetData.lines[i].commonYAxis === undefined || this.props.presetData.lines[i].commonYAxis === '') {\r\n                    xAxisOptions[i] = I18n.t('From line %s', i + 1);\r\n                }\r\n            }\r\n        }\r\n        const ownYAxis = this.props.line.commonYAxis === '' || this.props.line.commonYAxis === undefined;\r\n        return <>\r\n            <div>\r\n                {this.props.provided ? <span title={ I18n.t('Drag me') } {...this.props.provided.dragHandleProps}><IconDrag/></span> : null }\r\n                <IconButton title={ I18n.t('Edit') }\r\n                            onClick={() => this.props.lineOpenToggle(this.props.index)\r\n                            }><IconFolderOpened/></IconButton>\r\n                {I18n.t('Line')} {this.props.index + 1}{this.props.line.name ? ' - ' + this.props.line.name : ''}\r\n                <IconButton\r\n                    className={this.props.classes.deleteButtonFull}\r\n                    aria-label=\"Delete\"\r\n                    title={I18n.t('Delete')}\r\n                    onClick={() => this.props.deleteLine(this.props.index)}>\r\n                    <IconDelete/>\r\n                </IconButton>\r\n                <IconButton\r\n                    className={this.props.classes.copyButtonFull}\r\n                    aria-label=\"Copy\"\r\n                    title={I18n.t('Copy')}\r\n                    onClick={() => this.props.onCopy(this.props.line)}>\r\n                    <IconCopy/>\r\n                </IconButton>\r\n            </div>\r\n            <div className={this.props.classes.shortFields}>\r\n                <IOSelect\r\n                    formData={this.props.line}\r\n                    updateValue={this.updateField}\r\n                    name=\"instance\"\r\n                    label=\"Instance\"\r\n                    noTranslate={true}\r\n                    options={(() => {\r\n                        let result = {};\r\n                        this.props.instances.forEach(instance => result[instance._id] = instance._id.replace('system.adapter.', ''));\r\n                        return result;\r\n                    })()}\r\n                />\r\n                <IOObjectField\r\n                    formData={this.props.line}\r\n                    classes={{objectContainer: this.props.classes.fullWidth}}\r\n                    updateValue={this.updateField}\r\n                    name=\"id\"\r\n                    label=\"ID\"\r\n                    width=\"calc(100% - 250px)\"\r\n                    customFilter={{common: {custom: this.props.line.instance ? this.props.line.instance.replace('system.adapter.', '') : this.props.systemConfig.common.defaultHistory || true}}}\r\n                    socket={this.props.socket}/>\r\n            </div>\r\n            <div className={this.props.classes.shortFields}>\r\n                <p className={this.props.classes.title}>{I18n.t('Main')}</p>\r\n                {this.renderColorField(this.props.line, this.updateField, 'Color', 'color')}\r\n                <IOSelect formData={this.props.line} updateValue={this.updateField} name=\"chartType\" label=\"Chart type\" options={{\r\n                    auto: 'Auto (Line or Steps)',\r\n                    line: 'Line',\r\n                    //bar: 'Bar',\r\n                    scatterplot: 'Scatter plot',\r\n                    steps: 'Steps',\r\n                    stepsStart: 'Steps on start',\r\n                    spline: 'Spline',\r\n                }}/>\r\n                {this.props.line.chartType !== 'auto' ? <IOSelect formData={this.props.line} updateValue={this.updateField} name=\"aggregate\" label=\"Type\" options={{\r\n                    minmax: 'minmax',\r\n                    average: 'average',\r\n                    min: 'min',\r\n                    max: 'max',\r\n                    total: 'total',\r\n                    onchange: 'raw',\r\n                }}/> : null }\r\n                {(this.props.line.chartType !== 'auto' && this.props.line.chartType === 'scatterplot') || this.props.line.points ? <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"symbolSize\" label=\"Point size\" min={1} type=\"number\"/> : null }\r\n                {this.props.line.chartType !== 'scatterplot' ? <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"validTime\" label=\"Valid time (sec)\" min={0} type=\"number\" title={I18n.t('If the current value is not older than X seconds, assume it is still the same.')}/> : null }\r\n                {this.props.presetData.legend ? <IOCheckbox formData={this.props.line} updateValue={this.updateField} name=\"hide\" label=\"Show only in legend\"/> : null}\r\n            </div>\r\n            <div className={this.props.classes.shortFields}>\r\n                <p className={this.props.classes.title}>{I18n.t('Texts')}</p>\r\n                <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"name\" label=\"Name\"/>\r\n                <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"unit\" label=\"Unit\" />\r\n            </div>\r\n            <div className={this.props.classes.shortFields}>\r\n                <p className={this.props.classes.title}>{I18n.t('Line and area')}</p>\r\n                <IOSlider formData={this.props.line} updateValue={this.updateField} name=\"fill\" label=\"Fill (from 0 to 1)\" />\r\n                <IOCheckbox formData={this.props.line} updateValue={this.updateField} name=\"points\" label=\"Show points\"/>\r\n                {this.props.line.points && this.props.line.chartType !== 'scatterplot' ?\r\n                    <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"symbolSize\" label=\"Point size\" min={1} type=\"number\"/> :\r\n                    null\r\n                }\r\n                <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"thickness\" label=\"ØL - Line thickness\" min={1} type=\"number\"/>\r\n                <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"shadowsize\" label=\"ØS - Shadow size\" min={0} type=\"number\"/>\r\n            </div>\r\n            <div className={this.props.classes.shortFields}>\r\n                <p className={this.props.classes.title}>{I18n.t('Axis')}</p>\r\n                {!this.props.index ? <IOSelect formData={this.props.line} updateValue={this.updateField} name=\"xaxe\" label=\"X Axis position\" options={{\r\n                    '': 'bottom',\r\n                    'top': 'top',\r\n                    'off': 'off',\r\n                    /*off: 'off',\r\n                    left: 'left',\r\n                    right: 'right',\r\n                    topColor: 'top colored',\r\n                    bottomColor: 'bottom colored',*/\r\n                }}/> : null }\r\n                {!this.props.index ? <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"xticks\" label=\"X-Axis ticks\" type=\"number\"/> : null }\r\n                <IOSelect formData={this.props.line} updateValue={this.updateField} name=\"offset\" label=\"X-Offset\" options={{\r\n                    '0': '0 seconds',\r\n                    '10': '10 seconds',\r\n                    '30': '30 seconds',\r\n                    '60': '60 seconds',\r\n                    '120': '2 minutes',\r\n                    '180': '3 minutes',\r\n                    '240': '4 minutes',\r\n                    '300': '5 minutes',\r\n                    '600': '10 minutes',\r\n                    '900': '15 minutes',\r\n                    '1800': '30 minutes',\r\n                    '2700': '45 minutes',\r\n                    '3600': '1 hour',\r\n                    '7200': '2 hours',\r\n                    '21600': '6 hours',\r\n                    '43200': '12 hours',\r\n                    '86400': '1 day',\r\n                    '172800': '2 days',\r\n                    '259200': '3 days',\r\n                    '345600': '4 days',\r\n                    '604800': '1 week',\r\n                    '1209600': '2 weeks',\r\n                    '1m': '1 month',\r\n                    '2m': '2 months',\r\n                    '3m': '3 months',\r\n                    '6m': '6 months',\r\n                    '1y': '1 year',\r\n                    '2y': '2 years',\r\n                }}/>\r\n                <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"yOffset\" label=\"Y-Offset\" type=\"number\"/>\r\n\r\n                <br/>\r\n                <IOSelect formData={this.props.line} updateValue={this.updateField} name=\"commonYAxis\" label=\"Common Y Axis\" noTranslate={true} options={xAxisOptions}/>\r\n\r\n                {ownYAxis ? <IOSelect formData={this.props.line} updateValue={this.updateField} name=\"yaxe\" label=\"Y Axis position\" options={{\r\n                    '': '',\r\n                    off: 'off',\r\n                    left: 'left',\r\n                    right: 'right',\r\n                    leftColor: 'left colored',\r\n                    rightColor: 'right colored',\r\n                }}/> : null}\r\n                {ownYAxis ? <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"min\" label=\"Min\" /> : null }\r\n                {ownYAxis ? <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"max\" label=\"Max\" /> : null }\r\n                {ownYAxis ? <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"yticks\" label=\"Y-Axis ticks\" type=\"number\"/> : null }\r\n            </div>\r\n            <div className={this.props.classes.shortFields}>\r\n                <p className={this.props.classes.title}>{I18n.t('Others')}</p>\r\n                <IOSelect formData={this.props.line} updateValue={this.updateField} name=\"ignoreNull\" label=\"NULL as\" options={{\r\n                    'false': 'default',\r\n                    'true': 'ignore null values',\r\n                    '0': 'use 0 instead of null values',\r\n                }}/>\r\n                {/*<IOTextField formData={this.props.line} updateValue={this.updateField} name=\"smoothing\" label=\"Smoothing\" type=\"number\" min={0}/>*/}\r\n                <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"afterComma\" label=\"Digits after comma\" type=\"number\" min={0}/>\r\n                <IOSelect formData={this.props.line} updateValue={this.updateField} name=\"lineStyle\" label=\"Line style\" options={{\r\n                    'solid': 'solid',\r\n                    'dashed': 'dashed',\r\n                    'dotted': 'dotted',\r\n                }}/>\r\n            </div>\r\n            {/*<div className={clsx(this.props.classes.shortFields, this.props.classes.shortFieldsLast)}>\r\n                            <IOCheckbox formData={this.props.line} updateValue={this.updateField} name=\"dashes\" label=\"Dashes\"/>\r\n                            {this.props.line.dashes ? <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"dashLength\" label=\"Dashes length\" min={1} type=\"number\"/> : null}\r\n                            {this.props.line.dashes ? <IOTextField formData={this.props.line} updateValue={this.updateField} name=\"spaceLength\" label=\"Space length\" min={1} type=\"number\"/> : null}\r\n                        </div>*/}\r\n        </>\r\n    }\r\n\r\n    render() {\r\n        return <Card\r\n            className={clsx(this.props.classes.card, this.props.onPaste && this.props.classes.cardPaste)}\r\n            style={{background: this.props.snapshot && this.props.snapshot.isDragging ? this.props.theme.palette.secondary.light : undefined}}\r\n        >\r\n            <CardContent className={this.props.classes.cardContent}>\r\n                { this.props.opened && !this.props.onPaste ? this.renderOpenedLine() : this.renderClosedLine()}\r\n            </CardContent>\r\n        </Card>\r\n    }\r\n}\r\n\r\nLine.propTypes = {\r\n    line: PropTypes.object,\r\n    maxLines: PropTypes.number,\r\n    socket: PropTypes.object,\r\n    updateLine: PropTypes.func,\r\n    provided: PropTypes.object,\r\n    snapshot: PropTypes.object,\r\n    index: PropTypes.number,\r\n    opened: PropTypes.bool,\r\n    instances: PropTypes.array,\r\n    lineOpenToggle: PropTypes.func,\r\n    width: PropTypes.number,\r\n    theme: PropTypes.object,\r\n    presetData: PropTypes.object,\r\n    onSelectColor: PropTypes.func,\r\n    systemConfig: PropTypes.object.isRequired,\r\n    onCopy: PropTypes.func,\r\n    onPaste: PropTypes.func,\r\n};\r\n\r\nexport default withStyles(styles)(Line);","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport clsx from 'clsx';\r\n\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\n\r\nimport {IOTextField, IOSelect, IOObjectField, IOSlider} from './Fields';\r\n\r\nimport {MdContentCopy as IconCopy, MdContentPaste as IconPaste, MdDelete as IconDelete} from 'react-icons/md';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nimport {FaFolder as IconFolderClosed} from 'react-icons/all';\r\nimport {FaFolderOpen as IconFolderOpened} from 'react-icons/all';\r\nimport ClearIcon from '@material-ui/icons/Close';\r\n\r\nimport ColorPicker from '@iobroker/adapter-react/Components/ColorPicker';\r\nimport Utils from '@iobroker/adapter-react/Components/Utils';\r\n\r\nconst WIDTHS = {\r\n    lineId: 100,\r\n    upperValueOrId: 100,\r\n    lowerValueOrId: 100,\r\n    color: 100,\r\n    fill: 100,\r\n    text: 200,\r\n    buttons: 100\r\n};\r\n\r\nconst LINE_HEIGHT = 48;\r\n\r\nlet styles = theme => ({\r\n    card: {\r\n        borderStyle: 'dashed',\r\n        borderWidth: 1,\r\n        marginBottom: theme.spacing(1),\r\n        padding: theme.spacing(1),\r\n        borderColor: theme.palette.grey['600'],\r\n        overflow: 'initial'\r\n    },\r\n    cardPaste: {\r\n        borderColor: theme.type === 'dark' ? theme.palette.grey['400'] : theme.palette.grey['800'],\r\n        backgroundColor: 'rgba(0,0,0,0)',\r\n        opacity: 0.8,\r\n    },\r\n    cardContent: {\r\n        padding: 0,\r\n        margin: 0,\r\n        '&:last-child': {\r\n            padding: 0,\r\n            paddingRight: 20\r\n        },\r\n        paddingRight: 20\r\n    },\r\n    shortFields: {\r\n        display: 'block',\r\n        '& > div': {\r\n            display: 'inline-flex',\r\n            paddingRight: 20,\r\n            width: 200\r\n        },\r\n        paddingBottom: theme.spacing(2),\r\n        borderBottom: '1px dotted ' + theme.palette.grey[400]\r\n    },\r\n    shortFieldsLast: {\r\n        borderBottom: 0,\r\n        paddingBottom: 0,\r\n        position: 'relaitve',\r\n    },\r\n    shortLineIdField: {\r\n        display: 'inline-flex',\r\n        minWidth: WIDTHS.lineId,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n        paddingRight: 10\r\n    },\r\n    shortUpperValueOrIdField: {\r\n        display: 'inline-flex',\r\n        minWidth: WIDTHS.upperValueOrId,\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n        paddingRight: 10\r\n    },\r\n    shortLowerValueOrIdField: {\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        display: 'inline-flex',\r\n        minWidth: WIDTHS.lowerValueOrId,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        verticalAlign: 'top',\r\n        paddingRight: 10\r\n    },\r\n    shortColorField: {\r\n        display: 'inline-flex',\r\n        minWidth: WIDTHS.color,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n        paddingRight: 10\r\n    },\r\n    shortFillField: {\r\n        display: 'inline-flex',\r\n        width: WIDTHS.fill,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n        paddingRight: 10\r\n    },\r\n    sliderRoot: {\r\n        marginTop: 10,\r\n    },\r\n    shortTextField: {\r\n        display: 'inline-flex',\r\n        minWidth: WIDTHS.text,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n        paddingRight: 10\r\n    },\r\n    shortButtonsField: {\r\n        display: 'inline-flex',\r\n        minWidth: WIDTHS.buttons,\r\n        marginLeft: theme.spacing(1),\r\n        paddingTop: 0,\r\n        lineHeight: LINE_HEIGHT + 'px',\r\n        verticalAlign: 'top',\r\n    },\r\n    lineClosed: {\r\n        display: 'inline-flex',\r\n        flexFlow: 'column wrap',\r\n        overflow: 'hidden',\r\n        flexDirection: 'row',\r\n        flex: 1,\r\n        height: LINE_HEIGHT\r\n    },\r\n    lineClosedContainer: {\r\n        display: 'flex'\r\n    },\r\n    deleteButton: {\r\n        float: 'right',\r\n        marginRight: 12\r\n    },\r\n    deleteButtonFull: {\r\n        float: 'right',\r\n        marginRight: 12\r\n    },\r\n    copyButtonFull: {\r\n        float: 'right',\r\n        marginRight: 0\r\n    },\r\n    title: {\r\n        width: 'inherit',\r\n        position: 'absolute',\r\n        whiteSpace: 'nowrap',\r\n        right: 0,\r\n        fontSize: 48,\r\n        opacity: 0.1,\r\n        lineHeight: '48px',\r\n        padding: 0,\r\n        marginTop: 20,\r\n        marginLeft: 0,\r\n        marginRight: 0,\r\n        marginBottom: 0,\r\n        paddingRight: 40,\r\n    },\r\n});\r\n\r\nclass Mark extends React.Component {\r\n    state = {\r\n        /*\r\n            'lineId':'0',\r\n            'upperValueOrId':'20',\r\n            'fill':'1',\r\n            'color':'#FF0000',\r\n            'ol':'1',\r\n            'os':'0',\r\n            'text':'11',\r\n            'textPosition':'l',\r\n            'textOffset':'2',\r\n            'textColor':'#FF0000',\r\n            'textSize':'2',\r\n            'lowerValueOrId':'20'\r\n        */\r\n      };\r\n\r\n    updateField = (name, value) => {\r\n        const mark = JSON.parse(JSON.stringify(this.props.mark));\r\n        mark[name] = value;\r\n        this.props.updateMark(this.props.index, mark);\r\n    };\r\n\r\n    renderColorField(formData, onUpdate, label, name, minWidth, className) {\r\n        let textColor = Utils.isUseBright(formData[name], null);\r\n        if (textColor === null) {\r\n            textColor = undefined;\r\n        }\r\n\r\n        return <div className={className}>\r\n            <TextField\r\n                disabled={!!this.props.onPaste}\r\n                style={{minWidth, width: 'calc(100% - 8px)'}}\r\n                label={I18n.t(label)}\r\n                value={formData[name]}\r\n                onClick={() =>\r\n                    !this.props.onPaste && this.setState({['_' + name]: formData[name]}, () =>\r\n                        this.props.onSelectColor(this.state['_' + name], color =>\r\n                            this.setState({['_' + name]: color}, () =>\r\n                                onUpdate(name, ColorPicker.getColor(color, true)))))\r\n                }\r\n                onChange={e => {\r\n                    const color = e.target.value;\r\n                    this.setState({['_' + name]: color}, () =>\r\n                        onUpdate(name, color));\r\n                }}\r\n                inputProps={{style: {paddingLeft: 8, backgroundColor: formData[name], color: textColor ? '#FFF' : '#000'}}}\r\n                InputProps={{\r\n                    endAdornment: !this.props.onPaste && formData[name] ?\r\n                        <IconButton\r\n                            size=\"small\"\r\n                            onClick={e => {\r\n                                e.stopPropagation();\r\n                                this.setState({['_' + name]: ''}, () => onUpdate(name, ''));\r\n                            }}>\r\n                            <ClearIcon />\r\n                        </IconButton>\r\n                        : undefined,\r\n                }}\r\n                InputLabelProps={{shrink: true}}\r\n            />\r\n        </div>;\r\n    }\r\n\r\n    renderClosedLine(lines, colors) {\r\n        return <div className={this.props.classes.lineClosedContainer}>\r\n            <div className={this.props.classes.lineClosed}>\r\n                {this.props.onPaste && this.props.onPaste ?\r\n                    <IconButton\r\n                        title={I18n.t('Paste')}\r\n                        onClick={() => this.props.onPaste()}>\r\n                        <IconPaste/>\r\n                    </IconButton>\r\n                    :\r\n                    <IconButton\r\n                        title={ I18n.t('Edit') }\r\n                        onClick={() => this.props.markOpenToggle(this.props.index)}>\r\n                        <IconFolderClosed/>\r\n                    </IconButton>\r\n                }\r\n                <IOSelect\r\n                    disabled={!!this.props.onPaste}\r\n                    noTranslate={true}\r\n                    formData={this.props.mark}\r\n                    updateValue={this.updateField}\r\n                    name=\"lineId\"\r\n                    label=\"Line ID\"\r\n                    options={lines}\r\n                    colors={colors}\r\n                    classes={{fieldContainer: this.props.classes.shortLineIdField}}\r\n                    minWidth={WIDTHS.lineId}\r\n                />\r\n                {this.props.mark.lineId !== null && this.props.mark.lineId !== undefined && this.props.mark.lineId !== '' ?\r\n                    <IOObjectField\r\n                        disabled={!!this.props.onPaste}\r\n                        formData={this.props.mark}\r\n                        updateValue={this.updateField}\r\n                        name=\"upperValueOrId\"\r\n                        label=\"Upper value or ID\"\r\n                        socket={this.props.socket}\r\n                        classes={{fieldContainer: this.props.classes.shortUpperValueOrIdField}}\r\n                        minWidth={WIDTHS.upperValueOrId}\r\n                    /> : null}\r\n                {this.props.mark.lineId !== null && this.props.mark.lineId !== undefined && this.props.mark.lineId !== '' &&\r\n                 this.props.mark.upperValueOrId !== null && this.props.mark.upperValueOrId !== undefined && this.props.mark.upperValueOrId !== '' ?\r\n                    <IOObjectField\r\n                        disabled={!!this.props.onPaste}\r\n                        formData={this.props.mark}\r\n                        updateValue={this.updateField}\r\n                        name=\"lowerValueOrId\"\r\n                        label=\"Lower value or ID\"\r\n                        socket={this.props.socket}\r\n                        classes={{fieldContainer: this.props.classes.shortLowerValueOrIdField}}\r\n                        minWidth={WIDTHS.lowerValueOrId}\r\n                    /> : null}\r\n                {this.props.mark.lineId !== null && this.props.mark.lineId !== undefined && this.props.mark.lineId !== '' &&\r\n                this.props.mark.upperValueOrId !== null && this.props.mark.upperValueOrId !== undefined && this.props.mark.upperValueOrId !== '' ?\r\n                    this.renderColorField(this.props.mark, this.updateField, 'Color', 'color', WIDTHS.color, this.props.classes.shortColorField) : null}\r\n                {this.props.mark.lineId !== null && this.props.mark.lineId !== undefined && this.props.mark.lineId !== ''  &&\r\n                 this.props.mark.upperValueOrId !== null && this.props.mark.upperValueOrId !== undefined && this.props.mark.upperValueOrId !== '' &&\r\n                 this.props.mark.lowerValueOrId !== null && this.props.mark.lowerValueOrId !== undefined && this.props.mark.lowerValueOrId !== ''?\r\n                    <IOSlider\r\n                        disabled={!!this.props.onPaste}\r\n                        formData={this.props.mark}\r\n                        updateValue={this.updateField}\r\n                        minWidth={WIDTHS.dataType}\r\n                        classes={{fieldContainer: this.props.classes.shortFillField, sliderRoot: this.props.classes.sliderRoot}}\r\n                        name=\"fill\"\r\n                        label=\"Fill (from 0 to 1)\"\r\n                    /> : null}\r\n                {this.props.mark.lineId !== null && this.props.mark.lineId !== undefined && this.props.mark.lineId !== '' &&\r\n                 this.props.mark.upperValueOrId !== null && this.props.mark.upperValueOrId !== undefined && this.props.mark.upperValueOrId !== '' ?\r\n                    <IOTextField\r\n                        disabled={!!this.props.onPaste}\r\n                        formData={this.props.mark}\r\n                        updateValue={this.updateField}\r\n                        name=\"text\"\r\n                        label=\"Text\"\r\n                        classes={{fieldContainer: this.props.classes.shortTextField}}\r\n                        minWidth={WIDTHS.fill}\r\n                    /> : null}\r\n            </div>\r\n            <IconButton\r\n                style={{ marginLeft: 5 }} aria-label=\"Delete\" title={I18n.t('Delete')}\r\n                onClick={() => this.props.deleteMark(this.props.index)}>\r\n                <IconDelete/>\r\n            </IconButton>\r\n        </div>\r\n    }\r\n\r\n    renderOpenedCard(lines, colors) {\r\n        return <>\r\n            <div>\r\n                <IconButton title={ I18n.t('Edit') }\r\n                            onClick={() => this.props.markOpenToggle(this.props.index)\r\n                            }><IconFolderOpened/></IconButton>\r\n                {I18n.t('Mark')} {this.props.index + 1}{this.props.mark.text ? ' - ' + this.props.mark.text : ''}\r\n                <IconButton\r\n                    className={this.props.classes.deleteButtonFull}\r\n                    aria-label=\"Delete\"\r\n                    title={I18n.t('Delete')}\r\n                    onClick={() => this.props.deleteMark(this.props.index)}>\r\n                    <IconDelete/>\r\n                </IconButton>\r\n                <IconButton\r\n                    className={this.props.classes.copyButtonFull}\r\n                    aria-label=\"Copy\"\r\n                    title={I18n.t('Copy')}\r\n                    onClick={() => this.props.onCopy(this.props.mark)}>\r\n                    <IconCopy/>\r\n                </IconButton>\r\n            </div>\r\n            <div className={this.props.classes.shortFields}>\r\n                <p className={this.props.classes.title}>{I18n.t('Limits')}</p>\r\n                <IOSelect\r\n                    formData={this.props.mark}\r\n                    updateValue={this.updateField}\r\n                    name=\"lineId\"\r\n                    noTranslate={true}\r\n                    label=\"Line ID\"\r\n                    options={lines}\r\n                    colors={colors}\r\n                />\r\n\r\n                {this.props.mark.lineId !== null && this.props.mark.lineId !== undefined && this.props.mark.lineId !== '' ?\r\n                    <IOObjectField\r\n                        formData={this.props.mark}\r\n                        updateValue={this.updateField}\r\n                        name=\"upperValueOrId\"\r\n                        label=\"Upper value or ID\"\r\n                        socket={this.props.socket}\r\n                    /> : null }\r\n\r\n                {this.props.mark.upperValueOrId !== null && this.props.mark.upperValueOrId !== undefined && this.props.mark.upperValueOrId !== '' ?\r\n                    <IOObjectField\r\n                        formData={this.props.mark}\r\n                        updateValue={this.updateField}\r\n                        name=\"lowerValueOrId\"\r\n                        label=\"Lower value or ID\"\r\n                        socket={this.props.socket}\r\n                    /> : null }\r\n            </div>\r\n\r\n            {(this.props.mark.upperValueOrId !== null && this.props.mark.upperValueOrId !== undefined && this.props.mark.upperValueOrId !== '') ||\r\n            (this.props.mark.lowerValueOrId !== null && this.props.mark.lowerValueOrId !== undefined && this.props.mark.lowerValueOrId !== '') ?\r\n                <div className={this.props.classes.shortFields}>\r\n                    <p className={this.props.classes.title}>{I18n.t('Style')}</p>\r\n                    {this.renderColorField(this.props.mark, this.updateField, 'Color', 'color')}\r\n\r\n                    <IOTextField\r\n                        formData={this.props.mark}\r\n                        updateValue={this.updateField} name=\"ol\" label=\"ØL Line thickness\" type=\"number\"/>\r\n\r\n                    <IOTextField formData={this.props.mark} updateValue={this.updateField} name=\"os\" label=\"ØS Shadow size\" type=\"number\"/>\r\n\r\n                    <IOSelect formData={this.props.mark} updateValue={this.updateField} name=\"lineStyle\" label=\"Line style\" options={{\r\n                        'solid': 'solid',\r\n                        'dashed': 'dashed',\r\n                        'dotted': 'dotted',\r\n                    }}/>\r\n\r\n                    {(this.props.mark.upperValueOrId !== null && this.props.mark.upperValueOrId !== undefined && this.props.mark.upperValueOrId !== '') &&\r\n                    (this.props.mark.lowerValueOrId !== null && this.props.mark.lowerValueOrId !== undefined && this.props.mark.lowerValueOrId !== '') ?\r\n                        <IOSlider formData={this.props.mark} updateValue={this.updateField} name=\"fill\" label=\"Fill (from 0 to 1)\"/> : null}\r\n                </div> : null}\r\n\r\n            {(this.props.mark.upperValueOrId !== null && this.props.mark.upperValueOrId !== undefined && this.props.mark.upperValueOrId !== '') ||\r\n            (this.props.mark.lowerValueOrId !== null && this.props.mark.lowerValueOrId !== undefined && this.props.mark.lowerValueOrId !== '') ?\r\n                <div className={clsx(this.props.classes.shortFields, this.props.classes.shortFieldsLast)}>\r\n                    <p className={this.props.classes.title}>{I18n.t('Label')}</p>\r\n                    <IOTextField formData={this.props.mark} updateValue={this.updateField} name=\"text\" label=\"Text\"/>\r\n                    {this.props.mark.text ?\r\n                        <IOSelect formData={this.props.mark} updateValue={this.updateField} name=\"textPosition\" label=\"Text position\" options={{\r\n                            'l': 'Left',\r\n                            'r': 'Right',\r\n                        }}/> : null}\r\n                    {this.props.mark.text ? <IOTextField formData={this.props.mark} updateValue={this.updateField} name=\"textOffset\" label=\"Text offset\" type=\"number\"/> : null}\r\n                    {this.props.mark.text ? <IOTextField formData={this.props.mark} updateValue={this.updateField} name=\"textSize\" label=\"Text size\" type=\"number\"/> : null}\r\n                    {this.props.mark.text ? this.renderColorField(this.props.mark, this.updateField, 'Text color', 'textColor') : null}\r\n                </div> : null }\r\n        </>;\r\n    }\r\n\r\n    render() {\r\n        let lines = {};\r\n        let colors = {};\r\n        this.props.presetData && this.props.presetData.lines.forEach((line, index) => {\r\n            lines[index] = index + ' - ' + (line.id || I18n.t('No ID yet'));\r\n            colors[index] = line.color;\r\n        });\r\n        return <Card className={clsx(this.props.classes.card, this.props.onPaste && this.props.classes.cardPaste)}>\r\n            <CardContent className={this.props.classes.cardContent}>\r\n                { this.props.opened && !this.props.onPaste ? this.renderOpenedCard(lines, colors) : this.renderClosedLine(lines, colors)}\r\n            </CardContent>\r\n        </Card>\r\n    }\r\n}\r\n\r\nMark.propTypes = {\r\n    mark: PropTypes.object,\r\n    socket: PropTypes.object,\r\n    updateMark: PropTypes.func,\r\n    index: PropTypes.number,\r\n    opened: PropTypes.bool,\r\n    instances: PropTypes.array,\r\n    markOpenToggle: PropTypes.func,\r\n    onSelectColor: PropTypes.func,\r\n    onCopy: PropTypes.func,\r\n    onPaste: PropTypes.func,\r\n};\r\n\r\nexport default withStyles(styles)(Mark);","import Utils from \"@iobroker/adapter-react/Components/Utils\";\r\n\r\nconst DEFAULT_PRESET = {\r\n    lines:[\r\n        /*\r\n        {\r\n            'id':'system.adapter.admin.0.cpu',\r\n            'offset':'0',\r\n            'aggregate':'minmax',\r\n            'color':'#FF0000',\r\n            'thickness':'3',\r\n            'shadowsize':'3',\r\n            'name':'Line 1',\r\n            'xaxe':'off',\r\n            'ignoreNull':'false',\r\n            'afterComma':'2',\r\n            'dashes':'true',\r\n            'dashLength':'10',\r\n            'spaceLength':'10',\r\n            'min':'-0.1',\r\n            'max':'1',\r\n            'points':'true',\r\n            'fill':'4',\r\n            'unit':'2',\r\n            'yaxe':'left',\r\n            'yOffset':'1',\r\n            'xticks':'2',\r\n            'yticks':'3',\r\n            'smoothing':'4'\r\n        },\r\n        {\r\n            'id':'system.adapter.admin.0.memHeapTotal',\r\n            'offset':'0',\r\n            'aggregate':'minmax',\r\n            'color':'#00FF00',\r\n            'thickness':'3',\r\n            'shadowsize':'3',\r\n            'min':'-0.1',\r\n            'points':'false'\r\n        },\r\n        {\r\n            'id':'system.adapter.admin.0.memRss',\r\n            'offset':'0',\r\n            'aggregate':'minmax',\r\n            'color':'#0000FF',\r\n            'thickness':'3',\r\n            'shadowsize':'3',\r\n            'xaxe':'off',\r\n            'min':'-0.1'\r\n        }\r\n        */\r\n    ],\r\n    marks: [\r\n        /*\r\n        {\r\n            'lineId':'0',\r\n            'upperValueOrId':'20',\r\n            'fill':'1',\r\n            'color':'#FF0000',\r\n            'ol':'1',\r\n            'os':'0',\r\n            'text':'11',\r\n            'textPosition':'l',\r\n            'textOffset':'2',\r\n            'textColor':'#FF0000',\r\n            'textSize':'2',\r\n            'lowerValueOrId':'20'\r\n        }\r\n        */\r\n    ],\r\n    timeType: 'relative',\r\n    relativeEnd: '30minutes',\r\n    range: '120',\r\n    aggregateType: 'count',\r\n    aggregateSpan: 300,\r\n    legend: 'ne',\r\n    hoverDetail: true,\r\n    zoom: true,\r\n    animation: 0,\r\n    live: '15',\r\n    ticks: '',\r\n    width: '100%',\r\n    height: '100%',\r\n    noBorder: 'noborder',\r\n    window_bg: '',\r\n    bg_custom: '',\r\n    x_labels_color: '',\r\n    y_labels_color: '',\r\n    border_color: '',\r\n    grid_color: '',\r\n    grid_hideX: false,\r\n    grid_hideY: false,\r\n    border_width: '',\r\n    barColor: '',\r\n    barLabels: 'topover',\r\n    barWidth: '',\r\n    barFontSize: '',\r\n    barFontColor: '',\r\n    title: '',\r\n    titlePos: '',\r\n    titleColor: '',\r\n    titleSize: '',\r\n    legColumns: '',\r\n    legBgOpacity: '',\r\n    legBg: '',\r\n    timeFormat: '',\r\n    export: true,\r\n    legendDirection: '', // '' - horizontal, 'vertical' - vertical\r\n};\r\n\r\nfunction getDefaultLine(systemSettings, instance, obj, language) {\r\n    const isBoolean = obj && obj.common && obj.common.type === 'boolean';\r\n\r\n    const line = {\r\n        name:       ((obj && obj.common && obj.common.name && Utils.getObjectNameFromObj(obj, null, {language})) || '').trim(),\r\n        id:         obj ? obj._id : '',\r\n        instance:   instance === systemSettings.common.defaultHistory ? '' : instance || '',\r\n        thickness:  2,\r\n        chartType:  isBoolean ? 'steps'    : 'line',\r\n        aggregate:  isBoolean ? 'onchange' : 'minmax',\r\n        isBoolean:  isBoolean,\r\n        symbolSize: 3,\r\n        validTime:  35, // 35 seconds\r\n    };\r\n\r\n    if (obj && obj.common && obj.common.color) {\r\n        line.color = obj.common.color;\r\n    }\r\n    if (obj && obj.common && obj.common.unit) {\r\n        line.unit = obj.common.unit;\r\n    }\r\n    if (isBoolean) {\r\n        line.yaxe = 'off';\r\n        line.min = '0';\r\n        line.yticks = 1;\r\n        line.fill = 0.3;\r\n        line.symbolSize = 1;\r\n    }\r\n\r\n    return line;\r\n}\r\n\r\nfunction getDefaultPreset(systemSettings, instance, obj, language) {\r\n    const preset = JSON.parse(JSON.stringify(DEFAULT_PRESET));\r\n\r\n    preset.useComma = systemSettings.common.isFloatComma || false;\r\n\r\n    if (systemSettings.common.dateFormat) {\r\n        //preset.timeFormat = 'HH:mm:ss ' + systemSettings.common.dateFormat;\r\n    }\r\n\r\n    preset.lines.push(getDefaultLine(systemSettings, instance, obj, language));\r\n\r\n    return preset;\r\n}\r\n\r\n// eslint-disable-next-line\r\nexport default {\r\n    getDefaultPreset,\r\n    getDefaultLine\r\n};","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport clsx from 'clsx';\r\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\r\nimport { ChromePicker } from 'react-color'\r\n\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport TabList from '@material-ui/lab/TabList';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport TabPanel from '@material-ui/lab/TabPanel';\r\nimport TabContext from '@material-ui/lab/TabContext';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport Button from '@material-ui/core/Button';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\n\r\nimport {MdAdd as IconAdd} from 'react-icons/md';\r\nimport {MdSave as IconSave} from 'react-icons/md';\r\nimport {MdExpandLess as IconCollapse} from 'react-icons/md';\r\nimport {MdExpandMore as IconExpand} from 'react-icons/md';\r\nimport IconClear from '@material-ui/icons/Close';\r\nimport {MdFullscreen as IconNewWindow} from 'react-icons/md';\r\nimport IconClose from '@material-ui/icons/Close';\r\n\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\nimport Utils from '@iobroker/adapter-react/Components/Utils';\r\nimport IconCopy from '@iobroker/adapter-react/Components/CopyIcon';\r\n\r\nimport {IOTextField, IOCheckbox, IOSelect, IODateTimeField} from './Fields';\r\nimport Line from './Line';\r\nimport Mark from './Mark';\r\nimport DefaultPreset from './DefaultPreset';\r\nimport ColorPicker from '@iobroker/adapter-react/Components/ColorPicker';\r\n\r\nconst styles = theme => ({\r\n    tabsBody: {\r\n        overflowY: 'auto',\r\n        flex: 1\r\n    },\r\n    tabsContainer: {\r\n        flexDirection: 'row'\r\n    },\r\n    tabContent: {\r\n        paddingTop: theme.spacing(1),\r\n        position: 'relative',\r\n        minHeight: 'calc(100% - 32px)'\r\n    },\r\n    buttonAdd: {\r\n        position: 'absolute',\r\n        top: theme.spacing(1),\r\n        right: theme.spacing(1),\r\n        zIndex: 3,\r\n    },\r\n    buttonExpandAll: {\r\n        position: 'absolute',\r\n        top: theme.spacing(1) + 42,\r\n        right: theme.spacing(1),\r\n        opacity: 0.5,\r\n        zIndex: 3,\r\n    },\r\n    buttonCollapseAll: {\r\n        position: 'absolute',\r\n        top: theme.spacing(1) + 42 * 2,\r\n        right: theme.spacing(1),\r\n        opacity: 0.5,\r\n        zIndex: 3,\r\n    },\r\n    buttonSave: {\r\n        color: theme.type === 'dark' ? '#CC0000' : '#CC0000'\r\n    },\r\n    noContent : {\r\n        padding: theme.spacing(1),\r\n        height: 64,\r\n        verticalAlign: 'middle',\r\n        lineHeight: '64px',\r\n        width: '100%',\r\n    },\r\n    dragHint: {\r\n        paddingLeft: theme.spacing(1),\r\n        fontSize: 10,\r\n        fontStyle: 'italic',\r\n        opacity: 0.8,\r\n    },\r\n    marginTop: {\r\n        marginTop: theme.spacing(2),\r\n    },\r\n    noPaddingOnSide: {\r\n        //paddingRight: 0,\r\n        //paddingLeft: 0,\r\n    },\r\n    group: {\r\n        display: 'block',\r\n        '& > div': {\r\n            display: 'inline-flex',\r\n            paddingRight: 20,\r\n            width: 200,\r\n        },\r\n        position: 'relative',\r\n        paddingBottom: theme.spacing(2),\r\n        borderBottom: '1px dotted ' + theme.palette.grey[400]\r\n    },\r\n    title: {\r\n        width: 'inherit',\r\n        position: 'absolute',\r\n        whiteSpace: 'nowrap',\r\n        right: 0,\r\n        fontSize: 48,\r\n        opacity: 0.1,\r\n        lineHeight: '48px',\r\n        padding: 0,\r\n        marginTop: 20,\r\n        marginLeft: 0,\r\n        marginRight: 0,\r\n        marginBottom: 0,\r\n        paddingRight: 10,\r\n    },\r\n    buttonCopyLink: {\r\n        minHeight: 30,\r\n        marginTop: 20,\r\n        marginBottom: 10,\r\n        marginLeft: theme.spacing(2),\r\n    }\r\n});\r\n\r\nconst PREDEFINED_COLORS_MARKS = [\r\n    '#144578',\r\n    '#1868A8',\r\n    '#665191',\r\n    '#a05195',\r\n    '#d45087',\r\n    '#f95d6a',\r\n    '#ff7c43',\r\n    '#ffa600',\r\n];\r\n\r\nconst getItemStyle = (isDragging, draggableStyle) => ({\r\n    // some basic styles to make the items look a bit nicer\r\n    userSelect: 'none',\r\n    width: '100%',\r\n    // change background colour if dragging\r\n    background: isDragging ? 'lightgreen' : 'grey',\r\n    // styles we need to apply on draggables\r\n    ...draggableStyle\r\n});\r\n\r\nclass PresetTabs extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        let copiedObject = window.sessionStorage.getItem('echarts.copiedObject');\r\n        if (copiedObject) {\r\n            try {\r\n                copiedObject = JSON.parse(copiedObject)\r\n            } catch (e) {\r\n                copiedObject = null;\r\n            }\r\n        }\r\n\r\n        this.state = {\r\n            presetData: DefaultPreset.getDefaultPreset(this.props.systemConfig),\r\n            selectedTab: window.localStorage.getItem('App.echarts.presetTabs.selectedTab') !== null ? window.localStorage.getItem('App.echarts.presetTabs.selectedTab') : '0',\r\n            linesOpened: window.localStorage.getItem('App.echarts.Lines.opened') !== null ? JSON.parse(window.localStorage.getItem('App.echarts.Lines.opened')) : [],\r\n            marksOpened: window.localStorage.getItem('App.echarts.Marks.opened') !== null ? JSON.parse(window.localStorage.getItem('App.echarts.Marks.opened')) : [],\r\n            deleteLineDialog: null,\r\n            deleteMarkDialog: null,\r\n            showColorDialog: false,\r\n            colorDialogValue: '',\r\n            webInstances: [],\r\n            toast: '',\r\n            copiedObject,\r\n        };\r\n\r\n        this.props.socket.getAdapterInstances('web')\r\n            .then(instances => {\r\n                const webInstances = instances.map(obj => ({\r\n                    index: obj._id.split('.').pop(),\r\n                    link: `http${obj.native.secure ? 's' : ''}://${obj.native.bind === '0.0.0.0' ? window.location.hostname : obj.native.bind}:${obj.native.port}`}))\r\n\r\n                this.setState({webInstances});\r\n            });\r\n\r\n        this.colorPickerCb = null;\r\n    }\r\n\r\n    lineOpenToggle = index => {\r\n        let linesOpened = JSON.parse(JSON.stringify(this.state.linesOpened));\r\n        linesOpened[index] = !this.state.linesOpened[index];\r\n        this.setState({linesOpened});\r\n        window.localStorage.setItem('App.echarts.Lines.opened', JSON.stringify(linesOpened));\r\n    };\r\n\r\n    markOpenToggle = index => {\r\n        let marksOpened = JSON.parse(JSON.stringify(this.state.marksOpened));\r\n        marksOpened[index] = !this.state.marksOpened[index];\r\n        this.setState({marksOpened});\r\n        window.localStorage.setItem('App.echarts.Marks.opened', JSON.stringify(marksOpened));\r\n    };\r\n\r\n    updateField = (name, value, time) => {\r\n        const presetData = JSON.parse(JSON.stringify(this.props.presetData));\r\n        presetData[name] = value;\r\n        if (time) {\r\n            presetData[name + '_time'] = time;\r\n        }\r\n        this.props.onChange(presetData);\r\n    };\r\n\r\n    updateMark = (index, markData) => {\r\n        let marks = JSON.parse(JSON.stringify(this.props.presetData.marks));\r\n        marks[index] = markData;\r\n        this.updateField('marks', marks);\r\n    };\r\n\r\n    updateLine = (index, lineData) => {\r\n        let lines = JSON.parse(JSON.stringify(this.props.presetData.lines));\r\n        lines[index] = lineData;\r\n        this.updateField('lines', lines);\r\n    };\r\n\r\n    expandAllLines = () => {\r\n        const linesOpened = this.props.presetData.lines.map(() => true);\r\n        window.localStorage.setItem('App.echarts.Lines.opened', JSON.stringify(linesOpened));\r\n        this.setState({linesOpened});\r\n    };\r\n\r\n    collapseAllLines = () => {\r\n        window.localStorage.setItem('App.echarts.Lines.opened', JSON.stringify([]));\r\n        this.setState({linesOpened: []});\r\n    };\r\n\r\n    expandAllMarks = () => {\r\n        const marksOpened = this.props.presetData.marks.map(() => true);\r\n        window.localStorage.setItem('App.echarts.Marks.opened', JSON.stringify([]));\r\n        this.setState({marksOpened});\r\n    };\r\n\r\n    collapseAllMarks = () => {\r\n        window.localStorage.setItem('App.echarts.Marks.opened', JSON.stringify([]));\r\n        this.setState({marksOpened: []});\r\n    };\r\n\r\n    addMark(data) {\r\n        let presetData = JSON.parse(JSON.stringify(this.props.presetData));\r\n        if (data) {\r\n            presetData.marks.push(JSON.parse(JSON.stringify(data)));\r\n        } else {\r\n            const len = this.props.presetData.marks.length;\r\n            const color = PREDEFINED_COLORS_MARKS[len % PREDEFINED_COLORS_MARKS.length];\r\n            presetData.marks.push({color});\r\n        }\r\n        this.props.onChange(presetData);\r\n    }\r\n\r\n    deleteMark = index => {\r\n        const presetData = JSON.parse(JSON.stringify(this.props.presetData));\r\n        presetData.marks.splice(index, 1);\r\n        const marksOpened = [...this.state.marksOpened];\r\n        marksOpened.splice(index, 1);\r\n        this.setState({marksOpened}, () =>\r\n            this.props.onChange(presetData));\r\n    };\r\n\r\n    addLine(data) {\r\n        const presetData = JSON.parse(JSON.stringify(this.props.presetData));\r\n        if (data) {\r\n            presetData.lines.push(JSON.parse(JSON.stringify(data)));\r\n        } else {\r\n            const len = this.props.presetData.lines.length;\r\n            const line = DefaultPreset.getDefaultLine(this.props.systemConfig);\r\n            line.xaxe = !len ? undefined : 'off';\r\n            presetData.lines.push(line);\r\n        }\r\n        this.props.onChange(presetData);\r\n    }\r\n\r\n    deleteLine = index => {\r\n        const presetData = JSON.parse(JSON.stringify(this.props.presetData));\r\n        presetData.lines.splice(index, 1);\r\n        const linesOpened = [...this.state.linesOpened];\r\n        linesOpened.splice(index, 1);\r\n        this.setState({linesOpened}, () => this.props.onChange(presetData));\r\n    };\r\n\r\n    renderDeleteLineDialog() {\r\n        return this.state.deleteLineDialog !== null ? <Dialog\r\n            open={ true }\r\n            key=\"deleteLineDialog\"\r\n            onClose={ () => this.setState({deleteLineDialog: null}) }\r\n        >\r\n            <DialogTitle>{ I18n.t('Are you sure for delete this line?') }</DialogTitle>\r\n            <DialogActions className={ clsx(this.props.classes.alignRight, this.props.classes.buttonsContainer) }>\r\n                <Button variant=\"contained\" onClick={ () => this.setState({deleteLineDialog: null}) }>\r\n                    {I18n.t('Cancel')}\r\n                </Button>\r\n                <Button variant=\"contained\" color=\"secondary\" onClick={() => {\r\n                    this.deleteLine(this.state.deleteLineDialog);\r\n                    this.setState({deleteLineDialog: null});\r\n                }}>\r\n                    { I18n.t('Delete') }\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog> : null;\r\n    }\r\n\r\n    renderDeleteMarkDialog() {\r\n        return this.state.deleteMarkDialog !== null ? <Dialog\r\n            open={ true }\r\n            key=\"deleteMarkDialog\"\r\n            onClose={ () => this.setState({deleteMarkDialog: null}) }\r\n        >\r\n            <DialogTitle>{ I18n.t('Are you sure for delete this mark?') }</DialogTitle>\r\n            <DialogActions className={ clsx(this.props.classes.alignRight, this.props.classes.buttonsContainer) }>\r\n                <Button variant=\"contained\" onClick={ () => this.setState({deleteMarkDialog: null}) }>\r\n                    {I18n.t('Cancel')}\r\n                </Button>\r\n                <Button variant=\"contained\" color=\"secondary\" onClick={() => {\r\n                    this.deleteMark(this.state.deleteMarkDialog);\r\n                    this.setState({deleteMarkDialog: null});\r\n                }}>\r\n                    { I18n.t('Delete') }\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog> : null;\r\n    }\r\n\r\n    showColorPicker(value, cb) {\r\n        this.colorPickerCb = cb;\r\n        this.setState({colorDialogValue: value, showColorDialog: true});\r\n    }\r\n\r\n    renderColorDialog() {\r\n        return <Dialog\r\n            onClose={() => {\r\n                this.colorPickerCb = null;\r\n                this.setState({showColorDialog: false});\r\n            }}\r\n            open={this.state.showColorDialog}>\r\n            <ChromePicker\r\n                color={this.state.colorDialogValue}\r\n                onChange={value => {\r\n                    this.setState({colorDialogValue: value}, () =>\r\n                        this.colorPickerCb && this.colorPickerCb(value));\r\n                }}\r\n            />\r\n        </Dialog>;\r\n    }\r\n\r\n    renderTabLines() {\r\n        const anyClosed = this.props.presetData.lines.length > 1 && this.props.presetData.lines.find((l, i) => !this.state.linesOpened[i]);\r\n        const anyOpened = this.props.presetData.lines.length > 1 && this.props.presetData.lines.find((l, i) => this.state.linesOpened[i]);\r\n\r\n        return <Droppable droppableId=\"droppable\">\r\n            {(provided, snapshot) =>\r\n                <div\r\n                    {...provided.droppableProps}\r\n                    ref={provided.innerRef}\r\n                    style={{\r\n                        background: snapshot.isDraggingOver ? this.props.theme.palette.secondary.dark : undefined,\r\n                        width: '100%',\r\n                        minHeight: '100%',\r\n                    }}\r\n                >\r\n                    <TabPanel value=\"0\" classes={{root: this.props.classes.tabContent}}>\r\n                        <Fab onClick={() => this.addLine()} size=\"small\" color=\"secondary\" className={this.props.classes.buttonAdd}         title={I18n.t('Add line to chart')}><IconAdd/></Fab>\r\n                        {anyClosed ? <Fab onClick={this.expandAllLines}   size=\"small\" color=\"default\" className={this.props.classes.buttonExpandAll}  title={I18n.t('Expand all lines')}><IconExpand/></Fab> : null}\r\n                        {anyOpened ? <Fab onClick={this.collapseAllLines} size=\"small\" color=\"default\" className={this.props.classes.buttonCollapseAll} title={I18n.t('Collapse all lines')}><IconCollapse/></Fab> : null}\r\n                        {this.props.presetData.lines.length ? this.props.presetData.lines.map((line, index) =>\r\n                            <Draggable key={line.id + '_' + index} draggableId={line.id + '_' + index} index={index}>\r\n                                {(provided, snapshot) =>\r\n                                    <div\r\n                                        ref={provided.innerRef}\r\n                                        {...provided.draggableProps}\r\n                                        style={getItemStyle(snapshot.isDragging, provided.draggableProps.style)}\r\n                                    >\r\n                                        <Line\r\n                                            provided={provided}\r\n                                            snapshot={snapshot}\r\n                                            theme={this.props.theme}\r\n                                            instances={this.props.instances}\r\n                                            systemConfig={this.props.systemConfig}\r\n                                            line={line}\r\n                                            presetData={this.props.presetData}\r\n                                            width={this.props.width}\r\n                                            updateLine={this.updateLine}\r\n                                            deleteLine={index => this.setState({deleteLineDialog: index})}\r\n                                            index={index}\r\n                                            key={index}\r\n                                            socket={this.props.socket}\r\n                                            opened={typeof this.state.linesOpened[index] !== 'undefined' && this.state.linesOpened[index] === true}\r\n                                            lineOpenToggle={this.lineOpenToggle}\r\n                                            maxLines={this.props.presetData.lines.length}\r\n                                            onSelectColor={(value, cb) => this.showColorPicker(value, cb)}\r\n                                            onCopy={line => {\r\n                                                this.setState({copiedObject: {type: 'line', data: JSON.parse(JSON.stringify(line))}});\r\n                                                window.sessionStorage.setItem('echarts.copiedObject', JSON.stringify({type: 'line', data: line}));\r\n                                            }}\r\n                                        />\r\n                                    </div>\r\n                                }\r\n                            </Draggable>)\r\n                        :\r\n                            <div className={this.props.classes.noContent}>\r\n                                {I18n.t('Create a new line with a \"+\" on the right.')}\r\n                            </div>\r\n                        }\r\n                        {this.state.copiedObject && this.state.copiedObject.type === 'line' ?\r\n                            <Line\r\n                                presetData={this.props.presetData}\r\n                                line={this.state.copiedObject.data}\r\n                                theme={this.props.theme}\r\n                                instances={this.props.instances}\r\n                                systemConfig={this.props.systemConfig}\r\n                                width={this.props.width}\r\n                                deleteLine={() => this.setState({copiedObject: null})}\r\n                                key=\"copiedLine\"\r\n                                opened={false}\r\n                                onPaste={() => this.addLine(this.state.copiedObject.data)}\r\n                            /> : null}\r\n                        <div className={this.props.classes.dragHint}>{I18n.t('You can drag and drop simple lines from the left list.')}</div>\r\n                    </TabPanel>\r\n                </div>}\r\n            </Droppable>;\r\n    }\r\n\r\n    renderTabMarkings() {\r\n        const anyClosed = this.props.presetData.marks.length > 1 && this.props.presetData.marks.find((l, i) => !this.state.marksOpened[i]);\r\n        const anyOpened = this.props.presetData.marks.length > 1 && this.props.presetData.marks.find((l, i) =>  this.state.marksOpened[i]);\r\n\r\n        return <TabPanel value=\"1\" classes={{root: this.props.classes.tabContent}}>\r\n            <Fab onClick={() => this.addMark()} size=\"small\" color=\"secondary\" className={this.props.classes.buttonAdd} title={I18n.t('Add marking line to chart')}>\r\n                <IconAdd/>\r\n            </Fab>\r\n            {anyClosed ? <Fab onClick={this.expandAllMarks}   size=\"small\" color=\"default\" className={this.props.classes.buttonExpandAll}  title={I18n.t('Expand all markings')}><IconExpand/></Fab> : null}\r\n            {anyOpened ? <Fab onClick={this.collapseAllMarks} size=\"small\" color=\"default\" className={this.props.classes.buttonCollapseAll} title={I18n.t('Collapse all markings')}><IconCollapse/></Fab> : null}\r\n            {\r\n                this.props.presetData.marks.length ?\r\n                    this.props.presetData.marks.map((mark, index) => <Mark\r\n                        mark={mark}\r\n                        presetData={this.props.presetData}\r\n                        updateMark={this.updateMark}\r\n                        deleteMark={(index) => {this.setState({deleteMarkDialog: index})}}\r\n                        index={index}\r\n                        key={index}\r\n                        socket={this.props.socket}\r\n                        opened={typeof this.state.marksOpened[index] !== 'undefined' && this.state.marksOpened[index] === true}\r\n                        markOpenToggle={this.markOpenToggle}\r\n                        onSelectColor={(value, cb) => this.showColorPicker(value, cb)}\r\n                        onCopy={data => {\r\n                            this.setState({copiedObject: {type: 'marking', data: JSON.parse(JSON.stringify(data))}});\r\n                            window.sessionStorage.setItem('echarts.copiedObject', JSON.stringify({type: 'line', data}));\r\n                        }}\r\n                    />) :\r\n                    <div className={this.props.classes.noContent}>\r\n                        {I18n.t('You can create a new markings with a \"+\" on the right.')}\r\n                    </div>\r\n            }\r\n            {this.state.copiedObject && this.state.copiedObject.type === 'marking' ?\r\n                <Mark\r\n                    presetData={this.props.presetData}\r\n                    mark={this.state.copiedObject.data}\r\n                    theme={this.props.theme}\r\n                    instances={this.props.instances}\r\n                    systemConfig={this.props.systemConfig}\r\n                    width={this.props.width}\r\n                    deleteMark={() => this.setState({copiedObject: null})}\r\n                    key=\"copiedMark\"\r\n                    opened={false}\r\n                    onPaste={() => this.addMark(this.state.copiedObject.data)}\r\n                /> : null}\r\n        </TabPanel>;\r\n    }\r\n\r\n    renderTabTime() {\r\n        return <TabPanel value=\"2\" classes={{root: this.props.classes.tabContent}}>\r\n                    <div className={this.props.classes.group}>\r\n                        <p className={this.props.classes.title}>{I18n.t('Type')}</p>\r\n                        <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"timeType\" label=\"Type\" options={{\r\n                            'relative': 'relative',\r\n                            'static': 'static',\r\n                        }}/>\r\n                    </div>\r\n                    <div className={this.props.classes.group}>\r\n                        { this.props.presetData.timeType === 'static' ?\r\n                            <>\r\n                                <p className={this.props.classes.title}>{I18n.t('Start and end')}</p>\r\n                                <IODateTimeField formData={this.props.presetData} updateValue={this.updateField} name=\"start\" label=\"Start\" />\r\n                                <IODateTimeField formData={this.props.presetData} updateValue={this.updateField} name=\"end\" label=\"End\" />\r\n                            </> : <>\r\n                                <p className={this.props.classes.title}>{I18n.t('Relative')}</p>\r\n                                <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"relativeEnd\" label=\"End\" options={{\r\n                                    'now': 'now',\r\n                                    '1minute': 'end of minute',\r\n                                    '5minutes': 'end of 5 minutes',\r\n                                    '10minutes': 'end of 10 minutes',\r\n                                    '30minutes': 'end of 30 minutes',\r\n                                    '1hour': 'end of hour',\r\n                                    '2hours': 'end of 2 hours',\r\n                                    '3hours': 'end of 3 hours',\r\n                                    '4hours': 'end of 4 hours',\r\n                                    '6hours': 'end of 6 hours',\r\n                                    '8hours': 'end of 8 hours',\r\n                                    '12hours': 'end of 12 hours',\r\n                                    'today': 'end of day',\r\n                                    'weekEurope': 'end of sunday',\r\n                                    'weekUsa': 'end of saturday',\r\n                                    'month': 'this month',\r\n                                    'year': 'this year',\r\n                                }}/>\r\n                                <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"range\" label=\"Range\" options={{\r\n                                    '10': '10 minutes',\r\n                                    '30': '30 minutes',\r\n                                    '60': '1 hour',\r\n                                    '120': '2 hours',\r\n                                    '180': '3 hours',\r\n                                    '360': '6 hours',\r\n                                    '720': '12 hours',\r\n                                    '1440': '1 day',\r\n                                    '2880': '2 days',\r\n                                    '4320': '3 days',\r\n                                    '10080': '7 days',\r\n                                    '20160': '14 days',\r\n                                    '1m': '1 month',\r\n                                    '2m': '2 months',\r\n                                    '3m': '3 months',\r\n                                    '6m': '6 months',\r\n                                    '1y': '1 year',\r\n                                    '2y': '2 years',\r\n                                }}/>\r\n                                <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"live\" label=\"Live update every\" options={{\r\n                                    '': 'none',\r\n                                    '5': '5 seconds',\r\n                                    '10': '10 seconds',\r\n                                    '15': '15 seconds',\r\n                                    '20': '20 seconds',\r\n                                    '30': '30 seconds',\r\n                                    '60': '1 minute',\r\n                                    '120': '2 minutes',\r\n                                    '300': '5 minutes',\r\n                                    '600': '10 minutes',\r\n                                    '900': '15 minutes',\r\n                                    '1200': '20 minutes',\r\n                                    '1800': '30 minutes',\r\n                                    '3600': '1 hour',\r\n                                    '7200': '2 hours',\r\n                                    '10800': '3 hours',\r\n                                    '21600': '6 hours',\r\n                                    '43200': '12 hours',\r\n                                    '86400': '1 day',\r\n                                }}/>\r\n                            </>\r\n                        }\r\n                    </div>\r\n                    {/*<div className={this.props.classes.group}>\r\n                        <p className={this.props.classes.title}>{I18n.t('Start and end')}</p>\r\n                        <IOObjectField socket={this.props.socket} formData={this.props.presetData} updateValue={this.updateField} name=\"ticks\" label=\"Use X-ticks from\" />\r\n                    </div>*/}\r\n                {this.props.presetData.lines.find(line => line.aggregate !== 'onchange') ?\r\n                    <div className={this.props.classes.group}>\r\n                        <p className={this.props.classes.title}>{I18n.t('Aggregate')}</p>\r\n                        <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"aggregateType\" label=\"Step type\" options={{\r\n                            'count': 'counts',\r\n                            'step': 'seconds',\r\n                        }}/>\r\n                        <IOTextField formData={this.props.presetData} updateValue={this.updateField} name=\"aggregateSpan\"\r\n                                     label={this.props.presetData.aggregateType === 'step' ? 'Seconds' : 'Counts'}\r\n                        />\r\n                    </div> : null }\r\n            <div className={this.props.classes.group}>\r\n                <p className={this.props.classes.title}>{I18n.t('Time format')}</p>\r\n                <IOCheckbox formData={this.props.presetData} updateValue={this.updateField} label=\"Custom time format\" name=\"timeFormatCustom\" />\r\n                {!this.props.presetData.timeFormatCustom ?\r\n                    <IOSelect formData={this.props.presetData} updateValue={this.updateField} label=\"Time format\" name=\"timeFormat\" options={{\r\n                        '': 'Default',\r\n                        'HH:mm DD.MM': 'HH:MM dd.mm',\r\n                        'HH:mm DD.MM.': 'HH:MM dd.mm.',\r\n                        'HH:mm <br/> DD.MM': 'HH:MM / dd.mm',\r\n                        'HH:mm <br/> DD.MM.': 'HH:MM / dd.mm.',\r\n                        'HH:mm <br/> DD.MM.YY': 'HH:MM / dd.mm.yy',\r\n                        'HH:mm:ss DD.MM.YY': 'HH:MM:SS dd.mm.yy',\r\n                        'HH:mm DD.MM.YY': 'HH:MM dd.mm.yy',\r\n                        'hh:mm:ss MM/DD/YY a': 'HH:MM:SS mm/dd/yy am (US)',\r\n                        'HH:mm:ss DD/MM/YY': 'HH:MM:SS dd/mm/yy (UK)',\r\n                        'HH:mm:ss MM.DD.YY': 'HH:MM:SS mm.dd.yy',\r\n                        'HH:mm ddd': 'HH:MM dow',\r\n                        'HH:mm:ss ddd': 'HH:MM:SS dow',\r\n                        'HH:mm MM.DD': 'HH:MM mm.dd',\r\n                        'HH:mm:ss': 'HH:MM:SS',\r\n                        'HH:mm': 'HH:MM',\r\n                        'DD.MM': 'dd.mm',\r\n                        'DD.MM.': 'dd.mm.',\r\n                        'MM/DD': 'mm/dd',\r\n                        'DD': 'dd',\r\n                        'MM': 'mm',\r\n                        'YY': 'y',\r\n                        'HH': 'HH',\r\n                        'mm': 'MM',\r\n                        'ddd': 'dow',\r\n                        'DD.MM.YY': 'dd.mm.yy',\r\n                    }}/> :\r\n                    <IOTextField formData={this.props.presetData} updateValue={this.updateField} label=\"Time format\" name=\"timeFormat\" helperLink=\"https://momentjs.com/docs/#/displaying/format/\"/>\r\n                }\r\n                {/*<IOSelect formData={this.props.presetData} updateValue={this.updateField} label=\"Animation\" name=\"animation\" options={{\r\n                                '0': 'no',\r\n                                '300': '300ms',\r\n                                '500': '500ms',\r\n                                '1000': '1 second',\r\n                                '2000': '2 seconds',\r\n                                '3000': '3 seconds',\r\n                                '5000': '5 seconds',\r\n                                '10000': '10 seconds',\r\n                            }}/>*/}\r\n            </div>\r\n        </TabPanel>;\r\n    }\r\n\r\n    renderToast() {\r\n        if (!this.state.toast) {\r\n            return null;\r\n        }\r\n        return <Snackbar\r\n            anchorOrigin={{\r\n                vertical: 'bottom',\r\n                horizontal: 'left',\r\n            }}\r\n            open={true}\r\n            autoHideDuration={2000}\r\n            onClose={() => this.setState({toast: ''})}\r\n            ContentProps={{'aria-describedby': 'message-id'}}\r\n            message={<span id=\"message-id\">{this.state.toast}</span>}\r\n            action={[\r\n                <IconButton\r\n                    key=\"close\"\r\n                    aria-label=\"Close\"\r\n                    color=\"inherit\"\r\n                    className={this.props.classes.close}\r\n                    onClick={() => this.setState({toast: ''})}\r\n                >\r\n                    <IconClose />\r\n                </IconButton>,\r\n            ]}\r\n        />;\r\n    }\r\n\r\n    renderTabOptions() {\r\n        return <TabPanel value=\"3\" classes={{root: this.props.classes.tabContent}}>\r\n            <div className={this.props.classes.group}>\r\n                <p className={this.props.classes.title}>{I18n.t('Legend')}</p>\r\n                <IOSelect formData={this.props.presetData} updateValue={this.updateField} label=\"Show legend\" name=\"legend\" options={{\r\n                    '': 'none',\r\n                    'nw': 'Top, left',\r\n                    'ne': 'Top, right',\r\n                    'sw': 'Bottom, left',\r\n                    'se': 'Bottom, right',\r\n                }}/>\r\n                {this.props.presetData.legend ?\r\n                    <>\r\n                        {/*<IOTextField formData={this.props.presetData} updateValue={this.updateField} label=\"Legend columns\" name=\"legColumns\" min=\"1\" type=\"number\" />*/}\r\n                        {/*<IOTextField formData={this.props.presetData} updateValue={this.updateField} label=\"Legend opacity (0-1)\" name=\"legBgOpacity\" />*/}\r\n                        {this.renderColorField(this.props.presetData, this.updateField, 'Legend text color', 'legColor')}\r\n                        {this.renderColorField(this.props.presetData, this.updateField, 'Legend background', 'legBg')}\r\n                        <IOCheckbox formData={this.props.presetData} updateValue={this.updateField} label={'Show values'} name=\"legActual\" />\r\n                        <IOSelect formData={this.props.presetData} updateValue={this.updateField} label=\"Orientation\" name=\"legendDirection\" options={{\r\n                            '': 'horizontal',\r\n                            'vertical': 'vertical'\r\n                        }}/>\r\n                    </> : null}\r\n            </div>\r\n            <div className={this.props.classes.group}>\r\n                <p className={this.props.classes.title}>{I18n.t('Options')}</p>\r\n                <IOCheckbox formData={this.props.presetData} updateValue={this.updateField} label={'Hover details'} name=\"hoverDetail\" />\r\n                <IOCheckbox formData={this.props.presetData} updateValue={this.updateField} label={'No interpolate in hover'} name=\"hoverNoInterpolate\" />\r\n                {this.props.presetData.hoverDetail ? <IOCheckbox formData={this.props.presetData} updateValue={this.updateField} label={'Hide nulls in tooltip'} name=\"hoverNoNulls\" /> : null}\r\n                <IOCheckbox formData={this.props.presetData} updateValue={this.updateField} label={'Use comma'} name=\"useComma\" />\r\n                <IOCheckbox formData={this.props.presetData} updateValue={this.updateField} label={'Enable zoom and pan'} name=\"zoom\" />\r\n                {/*<IOCheckbox formData={this.props.presetData} updateValue={this.updateField} label={'Hide edit button'} name=\"noedit\" />*/}\r\n                <IOCheckbox formData={this.props.presetData} updateValue={this.updateField} label={'Show export button'} name=\"export\" />\r\n                {this.props.presetData.export ? this.renderColorField(this.props.presetData, this.updateField, 'Export button color', 'exportColor') : null}\r\n            </div>\r\n            <div className={this.props.classes.group}>\r\n                <p className={this.props.classes.title}>{I18n.t('Copy link to clipboard')}</p>\r\n                <Button\r\n                    variant=\"contained\"\r\n                    className={this.props.classes.buttonCopyLink}\r\n                    onClick={() => {\r\n                        const link = `${window.location.protocol}//${window.location.host}/adapter/echarts/chart/index.html?preset=${this.props.selectedId}`;\r\n                        this.setState({toast: I18n.t('copied') + ': ' + link}, () =>\r\n                            Utils.copyToClipboard(link));\r\n                    }}\r\n                >\r\n                    <IconCopy/>\r\n                    admin\r\n                </Button>\r\n                {this.state.webInstances.map((instance, i) =>\r\n                    <Button\r\n                        key={i}\r\n                        variant=\"contained\"\r\n                        className={this.props.classes.buttonCopyLink}\r\n                        onClick={() => {\r\n                            const link = `${instance.link}/echarts/index.html?preset=${this.props.selectedId}`;\r\n                            this.setState({toast: I18n.t('copied') + ': ' + link}, () =>\r\n                                Utils.copyToClipboard(link));\r\n                        }}\r\n\r\n                    ><IconCopy/>{'web.' + instance.index}</Button>)}\r\n            </div>\r\n        </TabPanel>;\r\n    }\r\n\r\n    renderTabTitle() {\r\n        return <TabPanel value=\"4\" classes={{root: this.props.classes.tabContent}}>\r\n            <div className={this.props.classes.group}>\r\n                <p className={this.props.classes.title}>{I18n.t('Title')}</p>\r\n                <IOTextField formData={this.props.presetData} updateValue={this.updateField} name=\"title\" label=\"Title\"/>\r\n                {this.props.presetData.title ?\r\n                    <>\r\n                        <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"titlePos\" label=\"Title position\" options={{\r\n                            '': 'default',\r\n                            'top:35;left:65': 'Top, left, inside',\r\n                            'top:35;right:5': 'Top, right, inside',\r\n                            'top:35;left:50': 'Top, center, inside',\r\n                            'top:50;left:65': 'Middle, left, inside',\r\n                            'top:50;right:5': 'Middle, right, inside',\r\n                            'bottom:5;left:65': 'Bottom, left, inside',\r\n                            'bottom:5;right:5': 'Bottom, right, inside',\r\n                            'bottom:5;left:50': 'Bottom, center, inside',\r\n                            /*'top:5;right:-5': 'Top, right, outside',\r\n                            'top:50;right:-5': 'Middle, right, outside',\r\n                            'bottom:5;right:-5': 'Bottom, right, outside',\r\n                            'bottom:-5;left:50': 'Bottom, center, outside',*/\r\n                        }}/>\r\n                        {this.renderColorField(this.props.presetData, this.updateField, 'Title color', 'titleColor')}\r\n                        <IOTextField formData={this.props.presetData} updateValue={this.updateField} name=\"titleSize\" label=\"Title size\" min={0} type=\"number\" />\r\n                    </>\r\n                    : null}\r\n            </div>\r\n        </TabPanel>;\r\n    }\r\n\r\n    renderTabAppearance() {\r\n        return <TabPanel value=\"5\" classes={{root: this.props.classes.tabContent}}>\r\n            {/*<h4>{I18n.t('Appearance')}</h4>*/}\r\n            <div className={this.props.classes.group}>\r\n                <p className={this.props.classes.title}>{I18n.t('Theme')}</p>\r\n                <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"theme\" label=\"Theme\" noTranslate={true} options={{\r\n                    '': 'auto',\r\n                    'default': 'default',\r\n                    'dark': 'dark',\r\n                    'dark-bold': 'dark-bold',\r\n                    'dark-blue': 'dark-blue',\r\n                    'gray': 'gray',\r\n                    'vintage': 'vintage',\r\n                    'macarons': 'macarons',\r\n                    'infographic': 'infographic',\r\n                    'shine': 'shine',\r\n                    'roma': 'roma',\r\n                    'azul': 'azul',\r\n                    'bee-inspired': '',\r\n                    'blue': 'blue',\r\n                    'royal': 'royal',\r\n                    'tech-blue': 'tech-blue',\r\n                    'red': 'red',\r\n                    'red-velvet': 'red-velvet',\r\n                    'green': 'green',\r\n                }}/>\r\n            </div>\r\n            <div className={this.props.classes.group}>\r\n                <p className={this.props.classes.title}>{I18n.t('Chart size')}</p>\r\n                <IOTextField formData={this.props.presetData} updateValue={this.updateField} name=\"width\"  label=\"Width\"  classes={{fieldContainer: this.props.classes.marginTop}}/>\r\n                <IOTextField formData={this.props.presetData} updateValue={this.updateField} name=\"height\" label=\"Height\" classes={{fieldContainer: this.props.classes.marginTop}} />\r\n            </div>\r\n            <div className={this.props.classes.group}>\r\n                <p className={this.props.classes.title}>{I18n.t('Backgrounds')}</p>\r\n                <IOCheckbox formData={this.props.presetData} updateValue={this.updateField} name=\"noBackground\" label=\"No background\" />\r\n                {!this.props.presetData.noBackground ? this.renderColorField(this.props.presetData, this.updateField, 'Window background', 'window_bg', undefined, this.props.classes.marginTop) : null}\r\n                {this.renderColorField(this.props.presetData, this.updateField, 'Chart background', 'bg_custom', undefined, this.props.classes.marginTop)}\r\n            </div>\r\n            <div className={this.props.classes.group}>\r\n                <p className={this.props.classes.title}>{I18n.t('Labels')}</p>\r\n                {this.renderColorField(this.props.presetData, this.updateField, 'X labels color', 'x_labels_color', undefined, this.props.classes.marginTop)}\r\n                {this.renderColorField(this.props.presetData, this.updateField, 'X ticks color', 'x_ticks_color', undefined, this.props.classes.marginTop)}\r\n                {this.renderColorField(this.props.presetData, this.updateField, 'Y labels color', 'y_labels_color', undefined, this.props.classes.marginTop)}\r\n                {this.renderColorField(this.props.presetData, this.updateField, 'Y ticks color', 'y_ticks_color', undefined, this.props.classes.marginTop)}\r\n            </div>\r\n            <div className={this.props.classes.group}>\r\n                <p className={this.props.classes.title}>{I18n.t('Grid')}</p>\r\n                <IOCheckbox formData={this.props.presetData} updateValue={this.updateField} name=\"grid_hideX\" label=\"Hide X grid\" />\r\n                <IOCheckbox formData={this.props.presetData} updateValue={this.updateField} name=\"grid_hideY\" label=\"Hide Y grid\" />\r\n                {!this.props.presetData.grid_hideX || !this.props.presetData.grid_hideY ?\r\n                    this.renderColorField(this.props.presetData, this.updateField, 'Grid color', 'grid_color')\r\n                    : null }\r\n            </div>\r\n            <div className={this.props.classes.group}>\r\n                <p className={this.props.classes.title}>{I18n.t('Border')}</p>\r\n                <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"noBorder\" label=\"Border\" options={{\r\n                    '': 'With border',\r\n                    'noborder': 'Without border',\r\n                }}/>\r\n                {this.props.presetData.noBorder !== 'noborder' ?\r\n                    <>\r\n                        <IOTextField formData={this.props.presetData} updateValue={this.updateField} name=\"border_width\" label=\"Border width\" min={0} type=\"number\"/>\r\n                        {this.props.presetData.border_width ? this.renderColorField(this.props.presetData, this.updateField, 'Border color', 'border_color') : null}\r\n                        {this.props.presetData.border_width ? <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"border_style\" label=\"Border style\" options={{\r\n                            'solid':  'solid',\r\n                            'dotted': 'dotted',\r\n                            'dashed': 'dashed',\r\n                            'double': 'double',\r\n                            'groove': 'groove',\r\n                            'ridge':  'ridge',\r\n                            'inset':  'inset',\r\n                            'outset': 'outset',\r\n                        }}/> : null}\r\n                        <IOTextField formData={this.props.presetData} updateValue={this.updateField} name=\"border_padding\" label=\"Border padding\" min={0} type=\"number\"/>\r\n\r\n                    </> : null}\r\n            </div>\r\n            {\r\n                !!this.props.presetData.lines.find(line => line.chartType === 'bar') ?\r\n                    <Grid item sm={6} xs={12}>\r\n                        <h4>{I18n.t('Bar settings')}</h4>\r\n                        {this.renderColorField(this.props.presetData, this.updateField, 'Fill color', 'barColor')}\r\n                        <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"barLabels\" label=\"Show labels\" options={{\r\n                            '': 'none',\r\n                            'topover': 'top over',\r\n                            'topunder': 'top under',\r\n                            'bottom': 'bottom',\r\n                            'middle': 'middle',\r\n                        }}/>\r\n                        <IOTextField formData={this.props.presetData} updateValue={this.updateField} name=\"barWidth\" label=\"Bars width\" min={0} type=\"number\"/>\r\n                        <IOTextField formData={this.props.presetData} updateValue={this.updateField} name=\"barFontSize\" label=\"Label font size\" min={0} type=\"number\"/>\r\n                        {this.renderColorField(this.props.presetData, this.updateField, 'Label color', 'barFontColor')}\r\n                    </Grid>\r\n                    : null\r\n            }\r\n        </TabPanel>;\r\n    }\r\n\r\n    renderColorField(formData, onUpdate, label, name, minWidth, className) {\r\n        let textColor = Utils.isUseBright(formData[name], null);\r\n        if (textColor === null) {\r\n            textColor = undefined;\r\n        }\r\n        return <div className={className}>\r\n            <TextField\r\n                style={{minWidth, width: 'calc(100% - 8px)'}}\r\n                label={I18n.t(label)}\r\n                value={formData[name] || ''}\r\n                onClick={() =>\r\n                    this.setState({['_c_' + name]: formData[name]}, () =>\r\n                        this.showColorPicker(this.state['_' + name], color =>\r\n                            this.setState({['_c_' + name]: color}, () =>\r\n                                onUpdate(name, ColorPicker.getColor(color, true)))))}\r\n                onChange={e => {\r\n                    const color = e.target.value;\r\n                    this.setState({['_c_' + name]: color}, () =>\r\n                        onUpdate(name, color));\r\n                }}\r\n                inputProps={{style: {paddingLeft: 8, backgroundColor: formData[name], color: textColor ? '#FFF' : '#000'}}}\r\n                InputProps={{\r\n                    endAdornment: formData[name] ?\r\n                        <IconButton\r\n                            size=\"small\"\r\n                            onClick={e => {\r\n                                e.stopPropagation();\r\n                                this.setState({['_c_' + name]: ''}, () => onUpdate(name, ''));\r\n                            }}>\r\n                            <IconClear />\r\n                        </IconButton>\r\n                        : undefined,\r\n                }}\r\n                InputLabelProps={{shrink: true}}\r\n            />\r\n        </div>;\r\n    }\r\n\r\n    render() {\r\n        return <TabContext value={this.state.selectedTab}>\r\n            <AppBar position=\"static\" className={this.props.classes.tabsContainer}>\r\n                {this.props.selectedPresetChanged || this.props.autoSave ? <Checkbox\r\n                    checked={!!this.props.autoSave}\r\n                    title={I18n.t('Auto save')}\r\n                    onChange={e => this.props.onAutoSave(e.target.checked)}\r\n                    inputProps={{ 'aria-label': 'primary checkbox' }}\r\n                /> : null}\r\n                {!this.props.selectedPresetChanged ? <IconButton\r\n                    classes={{root: this.props.classes.noPaddingOnSide}}\r\n                    onClick={ () => window.open('chart/index.html?preset=' + this.props.selectedId, 'own-preset-echarts') }\r\n                    title={ I18n.t('Open chart in own window') }\r\n                ><IconNewWindow/></IconButton> : null}\r\n                {!this.props.autoSave && this.props.selectedPresetChanged ? <IconButton\r\n                    classes={{root: this.props.classes.noPaddingOnSide}}\r\n                    className={this.props.classes.buttonSave}\r\n                    onClick={() => this.props.savePreset()}\r\n                >\r\n                    <IconSave/>\r\n                </IconButton> : null}\r\n                <TabList\r\n                    onChange={(event, newValue)=>{\r\n                        window.localStorage.setItem('App.echarts.presetTabs.selectedTab', newValue);\r\n                        this.setState({selectedTab: newValue})\r\n                    }}\r\n                    variant=\"scrollable\"\r\n                    scrollButtons=\"on\"\r\n                >\r\n                    <Tab label={I18n.t('Data')} value=\"0\"/>\r\n                    <Tab label={I18n.t('Markings')} value=\"1\"/>\r\n                    <Tab label={I18n.t('Time')} value=\"2\"/>\r\n                    <Tab label={I18n.t('Options')} value=\"3\"/>\r\n                    <Tab label={I18n.t('Title')} value=\"4\"/>\r\n                    <Tab label={I18n.t('Appearance')} value=\"5\"/>\r\n                </TabList>\r\n            </AppBar>\r\n            <div className={this.props.classes.tabsBody}>\r\n                {this.state.selectedTab === '0' ? this.renderTabLines()      : null}\r\n                {this.state.selectedTab === '1' ? this.renderTabMarkings()   : null}\r\n                {this.state.selectedTab === '2' ? this.renderTabTime()       : null}\r\n                {this.state.selectedTab === '3' ? this.renderTabOptions()    : null}\r\n                {this.state.selectedTab === '4' ? this.renderTabTitle()      : null}\r\n                {this.state.selectedTab === '5' ? this.renderTabAppearance() : null}\r\n            </div>\r\n            {this.renderDeleteLineDialog()}\r\n            {this.renderDeleteMarkDialog()}\r\n            {this.renderColorDialog()}\r\n            {this.renderToast()}\r\n        </TabContext>\r\n    }\r\n}\r\n\r\nPresetTabs.propTypes = {\r\n    onChange: PropTypes.func,\r\n    presetData: PropTypes.object,\r\n    selectedId: PropTypes.string,\r\n    socket: PropTypes.object,\r\n    instances: PropTypes.array,\r\n    savePreset: PropTypes.func,\r\n    selectedPresetChanged: PropTypes.bool,\r\n    width: PropTypes.number,\r\n    theme: PropTypes.object,\r\n    systemConfig: PropTypes.object,\r\n    onAutoSave: PropTypes.func,\r\n    autoSave: PropTypes.bool,\r\n};\r\n\r\nexport default withStyles(styles)(PresetTabs)","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n//import IconButton from '@material-ui/core/IconButton';\r\n\r\n//import I18n from '@iobroker/adapter-react/i18n';\r\nimport {withStyles} from '@material-ui/core/styles/index';\r\n\r\nimport PresetTabs from './Components/PresetTabs';\r\n\r\n// replace later with MdHorizontalSplit and MdVerticalSplit\r\n//const IconVerticalSplit   = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgAQMAAADYVuV7AAAABlBMVEUAAAAzMzPI8eYgAAAAAXRSTlMAQObYZgAAACFJREFUeAFjAIJRwP////8PYIKWHCigNQdKj/pn1D+jAABTG16wVQqVpQAAAABJRU5ErkJggg==';\r\n//const IconHorizontalSplit = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgAQMAAADYVuV7AAAABlBMVEUAAAAzMzPI8eYgAAAAAXRSTlMAQObYZgAAABtJREFUeAFjAIJRwP8fCj7QkENn/4z6Z5QzCgBjbWaoyx1PqQAAAABJRU5ErkJggg==';\r\n\r\nconst TOOLBOX_WIDTH = 0;//34;\r\n\r\nconst styles = theme => ({\r\n    logBox: {\r\n        width: '100%',\r\n        height: '100%',\r\n        position: 'relative',\r\n        overflow: 'hidden'\r\n    },\r\n    logBoxInner: {\r\n        color: theme.palette.type === 'dark' ? 'white' : 'black',\r\n        width: `calc(100% - ${TOOLBOX_WIDTH}px)`,\r\n        height: '100%',\r\n        marginLeft: TOOLBOX_WIDTH,\r\n        overflow: 'none',\r\n        position: 'relative',\r\n        display: 'flex',\r\n        flexDirection: 'column'\r\n    },\r\n    toolbox: {\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        marginLeft: 2,\r\n        width: TOOLBOX_WIDTH,\r\n        height: '100%',\r\n        boxShadow: '2px 0px 4px -1px rgba(0, 0, 0, 0.2), 4px 0px 5px 0px rgba(0, 0, 0, 0.14), 1px 0px 10px 0px rgba(0, 0, 0, 0.12)'\r\n    },\r\n    iconButtons: {\r\n        width: 32,\r\n        height: 32,\r\n        padding: 4\r\n    },\r\n    layoutIcon: {\r\n        width: 24,\r\n        height: 24,\r\n        background: theme.palette.type === 'dark' ? '#9d9d9d' : undefined,\r\n        borderRadius: theme.palette.type === 'dark' ? 30 : undefined,\r\n    },\r\n});\r\n\r\nclass SettingsEditor extends React.Component {\r\n    render() {\r\n        return <div className={this.props.classes.logBox}>\r\n            {/*false ? <div className={this.props.classes.toolbox} key=\"toolbox\">\r\n                {this.props.onLayoutChange ?\r\n                    (<IconButton\r\n                        className={this.props.classes.iconButtons}\r\n                        onClick={() => this.props.onLayoutChange()}\r\n                        title={I18n.t('Change layout')}\r\n                    >\r\n                        <img\r\n                            className={this.props.classes.layoutIcon}\r\n                            alt=\"split\"\r\n                            src={this.props.verticalLayout ? IconVerticalSplit : IconHorizontalSplit}\r\n                        />\r\n                    </IconButton>) : null}\r\n            </div> : null*/ }\r\n            <div className={this.props.classes.logBoxInner} key=\"logList\">\r\n                <PresetTabs\r\n                    width={this.props.width}\r\n                    socket={this.props.socket}\r\n                    presetData={this.props.presetData}\r\n                    selectedId={this.props.selectedId}\r\n                    onChange={this.props.onChange}\r\n                    instances={this.props.instances}\r\n                    systemConfig={this.props.systemConfig}\r\n                    selectedPresetChanged={this.props.selectedPresetChanged}\r\n                    savePreset={this.props.savePreset}\r\n                    theme={this.props.theme}\r\n                    onAutoSave={autoSave => this.props.onAutoSave(autoSave)}\r\n                    autoSave={this.props.autoSave}\r\n                />\r\n            </div>\r\n        </div>;\r\n    }\r\n}\r\n\r\nSettingsEditor.propTypes = {\r\n    socket: PropTypes.object,\r\n    selectedId: PropTypes.string,\r\n    presetData: PropTypes.object,\r\n    instances: PropTypes.array,\r\n    onLayoutChange: PropTypes.func,\r\n    onChange: PropTypes.func,\r\n    verticalLayout: PropTypes.bool,\r\n    savePreset: PropTypes.func,\r\n    selectedPresetChanged: PropTypes.bool,\r\n    width: PropTypes.number,\r\n    theme: PropTypes.object,\r\n    onAutoSave: PropTypes.func,\r\n    autoSave: PropTypes.bool,\r\n    systemConfig: PropTypes.object,\r\n};\r\n\r\nexport default withStyles(styles)(SettingsEditor);\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {withStyles} from '@material-ui/core/styles';\r\n\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Button from '@material-ui/core/Button';\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Popover from '@material-ui/core/Popover';\r\n\r\nimport {IOTextField, IOSelect, IODateTimeField} from './Fields';\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\n\r\nimport {IoMdTime as IconTime} from 'react-icons/all';\r\nimport {FiRefreshCw as IconRefresh} from 'react-icons/all';\r\nimport {IoMdArrowDropdown as IconDropDown} from 'react-icons/all';\r\nimport {MdAdd as IconPlus} from 'react-icons/md';\r\n\r\nclass IconAggregate extends React.Component {\r\n    render() {\r\n        return <svg onClick={e => this.props.onClick && this.props.onClick(e)} viewBox=\"0 0 32 32\" width={this.props.width || 20} height={this.props.width || 20} xmlns=\"http://www.w3.org/2000/svg\" className={ this.props.className }>\r\n            <path fill='none' stroke=\"currentColor\" strokeWidth='2' d='M16,9 L9,9 L9,16 L9,16 C9,19.8659932 12.1340068,23 16,23 L16,23 C19.8659932,23 23,19.8659932 23,16 C23,12.1340068 19.8659932,9 16,9 L16,9 Z M8,15 L15,15 L15,8 L15,8 C15,4.13400675 11.8659932,1 8,1 L8,1 C4.13400675,1 1,4.13400675 1,8 C1,11.8659932 4.13400675,15 8,15 L8,15 Z' transform='rotate(180 12 12)' />        </svg>;\r\n    }\r\n}\r\n\r\nlet styles = theme => ({\r\n    mainDiv: {\r\n        paddingLeft: 40,\r\n    },\r\n    fieldsContainer: {\r\n        '& > div': {\r\n            display: 'flex',\r\n            paddingRight: 20,\r\n            width: 200\r\n        }\r\n    },\r\n    hintButton: {\r\n        marginRight: 20,\r\n        float: 'right'\r\n    },\r\n    popOver: {\r\n        padding: theme.spacing(2)\r\n    },\r\n    refreshSelect: {\r\n        display: 'inline-block',\r\n        paddingLeft: 4,\r\n        '& > div:before': {\r\n            borderWidth: 0\r\n        },\r\n        '& > div:hover:before': {\r\n            borderBottom: 0\r\n        },\r\n        marginLeft: theme.spacing(1),\r\n    },\r\n    refreshSelectButtonTitle: {\r\n        display: 'inline-flex',\r\n        paddingTop: 6,\r\n    },\r\n    settingsButton: {\r\n        color: 'currentColor',\r\n        fontSize: 16,\r\n        textTransform: 'inherit'\r\n    },\r\n    grow1: {\r\n        flexGrow: 1,\r\n    },\r\n    aggregateIcon: {\r\n        marginTop: 4,\r\n    },\r\n});\r\n\r\nconst RefreshSelect = function (props) {\r\n    return <div className={props.className}>\r\n        <Select\r\n            onChange={e => props.updateValue(props.name, e.target.value)}\r\n            value={props.formData[props.name] || ''}\r\n            renderValue={props.renderValue}\r\n            displayEmpty\r\n        >\r\n            {\r\n                props.options ?\r\n                    Object.keys(props.options).map((key) =>\r\n                        <MenuItem key={key} value={key}>{props.noTranslate ? props.options[key] : I18n.t(props.options[key])}</MenuItem>)\r\n                        : null\r\n            }\r\n        </Select>\r\n    </div>\r\n};\r\n\r\nconst rangeOptions = {\r\n    '10': '10 minutes',\r\n    '30': '30 minutes',\r\n    '60': '1 hour',\r\n    '120': '2 hours',\r\n    '180': '3 hours',\r\n    '360': '6 hours',\r\n    '720': '12 hours',\r\n    '1440': '1 day',\r\n    '2880': '2 days',\r\n    '4320': '3 days',\r\n    '10080': '7 days',\r\n    '20160': '14 days',\r\n    '1m': '1 month',\r\n    '2m': '2 months',\r\n    '3m': '3 months',\r\n    '6m': '6 months',\r\n    '1y': '1 year',\r\n    '2y': '2 years',\r\n};\r\nconst relativeEndOptions = {\r\n    'now': 'now',\r\n    '1minute': 'end of minute',\r\n    '5minutes': 'end of 5 minutes',\r\n    '10minutes': 'end of 10 minutes',\r\n    '30minutes': 'end of 30 minutes',\r\n    '1hour': 'end of hour',\r\n    '2hours': 'end of 2 hours',\r\n    '3hours': 'end of 3 hours',\r\n    '4hours': 'end of 4 hours',\r\n    '6hours': 'end of 6 hours',\r\n    '8hours': 'end of 8 hours',\r\n    '12hours': 'end of 12 hours',\r\n    'today': 'end of day',\r\n    'weekEurope': 'end of sunday',\r\n    'weekUsa': 'end of saturday',\r\n    'month': 'this month',\r\n    'year': 'this year',\r\n};\r\nconst liveOptions = {\r\n    '': 'none',\r\n    '5': '5 seconds',\r\n    '10': '10 seconds',\r\n    '15': '15 seconds',\r\n    '20': '20 seconds',\r\n    '30': '30 seconds',\r\n    '60': '1 minute',\r\n    '120': '2 minutes',\r\n    '300': '5 minutes',\r\n    '600': '10 minutes',\r\n    '900': '15 minutes',\r\n    '1200': '20 minutes',\r\n    '1800': '30 minutes',\r\n    '3600': '1 hour',\r\n    '7200': '2 hours',\r\n    '10800': '3 hours',\r\n    '21600': '6 hours',\r\n    '43200': '12 hours',\r\n    '86400': '1 day',\r\n};\r\n\r\nconst CHART_TYPES = {\r\n    auto: 'Auto (Line or Steps)',\r\n    line: 'Line',\r\n    //bar: 'Bar',\r\n    scatterplot: 'Scatter plot',\r\n    steps: 'Steps',\r\n    stepsStart: 'Steps on start',\r\n    spline: 'Spline',\r\n};\r\n\r\nconst AGGREGATES = {\r\n    minmax: 'minmax',\r\n    average: 'average',\r\n    min: 'min',\r\n    max: 'max',\r\n    total: 'total',\r\n    onchange: 'raw',\r\n};\r\n\r\nclass ChartSettings extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            timeSpanOpened: false,\r\n            aggregateOpened: false,\r\n            refreshOpened: false\r\n        };\r\n    }\r\n\r\n    updateField = (name, value, time) => {\r\n        const presetData = JSON.parse(JSON.stringify(this.props.presetData));\r\n        presetData[name] = value;\r\n        if (time) {\r\n            presetData[name + '_time'] = time;\r\n        }\r\n        this.props.onChange(presetData);\r\n        window.localStorage.setItem('App.echarts.__' + name, value);\r\n    };\r\n\r\n    render() {\r\n        return <Toolbar className={this.props.classes.mainDiv} variant=\"dense\">\r\n            <Button\r\n                title={ I18n.t('Time span') }\r\n                size=\"small\"\r\n                className={this.props.classes.settingsButton}\r\n                id=\"timeSpanOpenButton\"\r\n                onClick={() => {this.setState({timeSpanOpened: !this.state.timeSpanOpened})}}\r\n            >\r\n                <IconTime/>\r\n                {\r\n                    this.props.presetData.timeType === 'relative' ?\r\n                    I18n.t(rangeOptions[this.props.presetData.range]) + ' ' + I18n.t('to') + ' ' + I18n.t(relativeEndOptions[this.props.presetData.relativeEnd]) :\r\n                    this.props.presetData.start + ' ' + this.props.presetData.start_time + ' - ' + this.props.presetData.end + ' ' + this.props.presetData.end_time\r\n                }\r\n                <IconDropDown/>\r\n            </Button>\r\n            <Popover className={this.props.classes.popOver}\r\n                open={this.state.timeSpanOpened}\r\n                onClose={()=>{this.setState({timeSpanOpened: false})}}\r\n                anchorEl={()=> document.getElementById('timeSpanOpenButton')}\r\n                anchorOrigin={{\r\n                    vertical: 'bottom',\r\n                    horizontal: 'center',\r\n                }}\r\n                transformOrigin={{\r\n                    vertical: 'top',\r\n                    horizontal: 'center',\r\n                }}\r\n            >\r\n                <div className={this.props.classes.popOver}>\r\n                    <div className={this.props.classes.fieldsContainer}>\r\n                        <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"timeType\" label=\"Type\" options={{\r\n                            'relative': 'relative',\r\n                            'static': 'static',\r\n                        }}/>\r\n                        { this.props.presetData.timeType === 'static' ?\r\n                            <>\r\n                                <IODateTimeField formData={this.props.presetData} updateValue={this.updateField} name=\"start\" label=\"Start\" />\r\n                                <IODateTimeField formData={this.props.presetData} updateValue={this.updateField} name=\"end\" label=\"End\" />\r\n                            </> : <>\r\n                                <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"relativeEnd\" label=\"End\" options={relativeEndOptions}/>\r\n                                <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"range\" label=\"Range\" options={rangeOptions}/>\r\n                            </>\r\n                        }\r\n                    </div>\r\n                </div>\r\n            </Popover>\r\n            <Button\r\n                title={ I18n.t('Aggregate') }\r\n                size=\"small\"\r\n                className={this.props.classes.settingsButton}\r\n                id=\"aggregateOpenButton\"\r\n                onClick={() => {this.setState({aggregateOpened: !this.state.aggregateOpened})}}\r\n            >\r\n                <IconAggregate className={this.props.classes.aggregateIcon}/>\r\n                {CHART_TYPES[this.props.presetData.chartType] ? I18n.t(CHART_TYPES[this.props.presetData.chartType]) : ''}\r\n                /\r\n                {AGGREGATES[this.props.presetData.aggregate] ? I18n.t(AGGREGATES[this.props.presetData.aggregate]) : ''}\r\n                <IconDropDown/>\r\n            </Button>\r\n            <Popover\r\n                open={this.state.aggregateOpened}\r\n                anchorEl={()=> document.getElementById('aggregateOpenButton')}\r\n                onClose={()=>{this.setState({aggregateOpened: false})}}\r\n            >\r\n                <div className={this.props.classes.popOver}>\r\n                    <div className={this.props.classes.fieldsContainer}>\r\n                        <IOSelect\r\n                            formData={this.props.presetData}\r\n                            updateValue={this.updateField}\r\n                            name=\"chartType\"\r\n                            label=\"Chart type\"\r\n                            options={CHART_TYPES}\r\n                        />\r\n                        {this.props.presetData.chartType !== 'auto' ? <IOSelect\r\n                            formData={this.props.presetData}\r\n                            updateValue={this.updateField}\r\n                            name=\"aggregate\"\r\n                            label=\"Aggregate\"\r\n                            options={AGGREGATES}/> : null}\r\n                        {this.props.presetData.aggregate !== 'onchange' ? <IOSelect formData={this.props.presetData} updateValue={this.updateField} name=\"aggregateType\" label=\"Step type\" options={{\r\n                            'count': 'counts',\r\n                            'step': 'seconds',\r\n                        }}/> : null}\r\n                        {this.props.presetData.aggregate !== 'onchange' ? <IOTextField formData={this.props.presetData} updateValue={this.updateField} name=\"aggregateSpan\"\r\n                            label={this.props.presetData.aggregateType === 'step' ? 'Seconds' : 'Counts'}\r\n                        /> : null}\r\n                    </div>\r\n                </div>\r\n            </Popover>\r\n            {this.props.presetData.timeType === 'relative' ? <RefreshSelect\r\n                className={this.props.classes.refreshSelect}\r\n                minWidth={0} width=\"initial\"\r\n                formData={this.props.presetData}\r\n                updateValue={this.updateField}\r\n                name=\"live\"\r\n                label=\"\"\r\n                title={I18n.t('Auto-refresh')}\r\n                options={liveOptions}\r\n                renderValue={()=>\r\n                    <div className={this.props.classes.refreshSelectButtonTitle}>\r\n                        <IconRefresh/>&nbsp;{I18n.t(liveOptions[this.props.presetData.live])}\r\n                    </div>\r\n                }\r\n            /> : null }\r\n            <div className={this.props.classes.grow1}/>\r\n            <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                className={this.props.classes.hintButton}\r\n                onClick={() => this.props.onCreatePreset(true)}\r\n            >\r\n                <IconPlus className={this.props.classes.buttonIcon}/>\r\n                {I18n.t('Create preset')}\r\n            </Button>\r\n        </Toolbar>;\r\n    }\r\n}\r\n\r\nChartSettings.propTypes = {\r\n    onChange: PropTypes.func,\r\n    presetData: PropTypes.object,\r\n    onCreatePreset: PropTypes.func,\r\n};\r\n\r\nexport default withStyles(styles)(ChartSettings)","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Paper from '@material-ui/core/Paper';\r\n\r\nconst styles = theme => ({\r\n    darkBackground: {\r\n        stroke: '#3a3a3a !important',\r\n        fill: '#515151 !important',\r\n    },\r\n    iframe: {\r\n        width: '100%',\r\n        height: '100%',\r\n        overflow: 'auto',\r\n        border: 0,\r\n        color: theme.palette.primary.main// && console.log(JSON.stringify(theme))\r\n    }\r\n});\r\n\r\n/*function deParam(params, coerce) {\r\n    const obj = {};\r\n    const coerceTypes = {'true': true, 'false': false, 'null': null};\r\n\r\n    // Iterate over all name=value pairs.\r\n    (params || '').replace(/\\+/g, ' ').split('&').forEach(v => {\r\n        const param = v.split('=');\r\n        let key = decodeURIComponent(param[0]);\r\n        let val;\r\n        let i = 0;\r\n\r\n        // If key is more complex than 'foo', like 'a[]' or 'a[b][c]', split it\r\n        // into its component parts.\r\n        let keys = key.split('][');\r\n        let keysLast = keys.length - 1;\r\n\r\n        // If the first keys part contains [ and the last ends with ], then []\r\n        // are correctly balanced.\r\n        if (/\\[/.test(keys[0]) && /]$/.test(keys[keysLast])) {\r\n            // Remove the trailing ] from the last keys part.\r\n            keys[keysLast] = keys[keysLast].replace(/]$/, '');\r\n\r\n            // Split first keys part into two parts on the [ and add them back onto\r\n            // the beginning of the keys array.\r\n            keys = keys.shift().split('[').concat(keys);\r\n\r\n            keysLast = keys.length - 1;\r\n        } else {\r\n            // Basic 'foo' style key.\r\n            keysLast = 0;\r\n        }\r\n\r\n        // Are we dealing with a name=value pair, or just a name?\r\n        if (param.length === 2) {\r\n            val = decodeURIComponent(param[1]);\r\n\r\n            // Coerce values.\r\n            if (coerce) {\r\n                val = val && !isNaN(val) && ((+val + '') === val) ? +val        // number\r\n                    : val === 'undefined' ? undefined         // undefined\r\n                        : coerceTypes[val] !== undefined ? coerceTypes[val] // true, false, null\r\n                            : val;                                                          // string\r\n            }\r\n\r\n            if (keysLast) {\r\n                let cur = obj;\r\n                // Complex key, build deep object structure based on a few rules:\r\n                // * The 'cur' pointer starts at the object top-level.\r\n                // * [] = array push (n is set to array length), [n] = array if n is\r\n                //   numeric, otherwise object.\r\n                // * If at the last keys part, set the value.\r\n                // * For each keys part, if the current level is undefined create an\r\n                //   object or array based on the type of the next keys part.\r\n                // * Move the 'cur' pointer to the next level.\r\n                // * Rinse & repeat.\r\n                for (; i <= keysLast; i++) {\r\n                    key = keys[i] === '' ? cur.length : keys[i];\r\n                    cur = cur[key] = i < keysLast\r\n                        ? cur[key] || (keys[i + 1] && isNaN(keys[i + 1]) ? {} : [])\r\n                        : val;\r\n                }\r\n\r\n            } else {\r\n                // Simple key, even simpler rules, since only scalars and shallow\r\n                // arrays are allowed.\r\n\r\n                if (Object.prototype.toString.call(obj[key]) === '[object Array]') {\r\n                    // val is already an array, so push on the next value.\r\n                    obj[key].push(val);\r\n                } else if ({}.hasOwnProperty.call(obj, key)) {\r\n                    // val isn't an array, but since a second value has been specified,\r\n                    // convert val into an array.\r\n                    obj[key] = [obj[key], val];\r\n                } else {\r\n                    // val is a scalar.\r\n                    obj[key] = val;\r\n                }\r\n            }\r\n        } else if (key) {\r\n            // No value was defined, so set something meaningful.\r\n            obj[key] = coerce\r\n                ? undefined\r\n                : '';\r\n        }\r\n    });\r\n\r\n    return obj;\r\n}*/\r\n\r\nclass ChartFrame extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.ready = false;\r\n        this.refIframe = React.createRef();\r\n        this.lastPresetData = '';\r\n    }\r\n\r\n    componentDidMount() {\r\n        window.addEventListener('message', this.onReceiveMessage, false);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        window.removeEventListener('message', this.onReceiveMessage, false);\r\n    }\r\n\r\n    onReceiveMessage = message => {\r\n        if (message && message.data === 'chartReady') {\r\n            this.ready = true;\r\n            this.lastPresetData = JSON.stringify(this.props.presetData);\r\n            this.refIframe.contentWindow.postMessage(this.lastPresetData,'*');\r\n            console.log('Received ready from iframe');\r\n        }\r\n    };\r\n\r\n    render() {\r\n        if (window.location.port === '3000') {\r\n            return <Paper className={this.props.classes.iframe} style={{background: '#333'}}>\r\n                <pre>{JSON.stringify(this.props.presetData, null, 2)}</pre>\r\n            </Paper>;\r\n        } else {\r\n            if (this.lastPresetData !== JSON.stringify(this.props.presetData) && this.ready) {\r\n                this.lastPresetData = JSON.stringify(this.props.presetData);\r\n                this.refIframe.contentWindow.postMessage(this.lastPresetData, '*');\r\n            }\r\n\r\n            return <iframe ref={el => this.refIframe = el}\r\n                title=\"iobrokerChart\"\r\n                className={this.props.classes.iframe}\r\n                src={this.props.src}>\r\n            </iframe>;\r\n        }\r\n    }\r\n}\r\n\r\nChartFrame.propTypes = {\r\n    src: PropTypes.string,\r\n    presetData: PropTypes.object,\r\n};\r\n\r\nexport default withStyles(styles)(ChartFrame);","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {MuiThemeProvider, withStyles} from '@material-ui/core/styles';\r\n\r\nimport ChartSettings from './Components/ChartSettings';\r\nimport ChartFrame from './Components/ChartFrame';\r\n\r\nconst styles = theme => ({\r\n    toolbar: {\r\n        //a: console.log(JSON.stringify(theme)),\r\n        minHeight: theme.mixins.toolbar.minHeight,\r\n        boxShadow: '0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12)'\r\n    },\r\n    toolbarButtons: {\r\n        padding: 4,\r\n        marginLeft: 4\r\n    },\r\n    editorDiv: {\r\n        height: `calc(100% - ${theme.mixins.toolbar.minHeight + 38 + 1}px)`,\r\n        width: '100%',\r\n        overflow: 'hidden',\r\n        position: 'relative'\r\n    },\r\n    textButton: {\r\n        marginRight: 10,\r\n        minHeight: 24,\r\n        padding: '6px 16px'\r\n    },\r\n    tabIcon: {\r\n        width: 24,\r\n        height: 24,\r\n        verticalAlign: 'middle',\r\n        marginBottom: 2,\r\n        marginRight: 2,\r\n        borderRadius: 3\r\n    },\r\n    hintIcon: {\r\n        //fontSize: 32,\r\n        padding: '0 8px 0 8px'\r\n    },\r\n    hintText: {\r\n        //fontSize: 18\r\n    },\r\n    tabMenuButton: {\r\n        position: 'absolute',\r\n        top: 0,\r\n        right: 0,\r\n    },\r\n    tabChanged: {\r\n        color: theme.palette.secondary.main\r\n    },\r\n    tabText: {\r\n        maxWidth: 130,\r\n        textOverflow: 'ellipsis',\r\n        whiteSpace: 'nowrap',\r\n        overflow: 'hidden',\r\n        display: 'inline-block',\r\n        verticalAlign: 'middle',\r\n    },\r\n    tabChangedIcon: {\r\n        color: '#FF0000',\r\n        fontSize: 16\r\n    },\r\n    closeButton: {\r\n        position: 'absolute',\r\n        top: 8,\r\n        right: 0,\r\n        zIndex: 10,\r\n        padding: 8,\r\n        cursor: 'pointer'\r\n    },\r\n    notRunning: {\r\n        color: '#ffbc00'\r\n    },\r\n    tabButton: {\r\n\r\n    },\r\n    tabButtonWrapper: {\r\n        display: 'inline-block',\r\n    },\r\n    menuIcon: {\r\n        width: 18,\r\n        height: 18,\r\n        borderRadius: 2,\r\n        marginRight: 5\r\n    },\r\n    container: {\r\n        height: '100%',\r\n        width: '100%',\r\n        overflow: 'hidden',\r\n    },\r\n    heightWithoutToolbar: {\r\n        height: 'calc(100% - 48px)',\r\n    },\r\n    height100: {\r\n        height: '100%',\r\n    }\r\n});\r\n\r\nclass MainChart extends React.Component {\r\n    renderToolbar() {\r\n        return this.props.selectedId && typeof this.props.selectedId === 'string' ? null :\r\n            <ChartSettings\r\n                onChange={this.props.onChange}\r\n                enablePresetMode={this.props.enablePresetMode}\r\n                presetData={this.props.presetData}\r\n                onCreatePreset={(name, parentId, historyInstance, stateId) => this.props.onCreatePreset(name, parentId, historyInstance, stateId)}\r\n            />;\r\n    }\r\n\r\n    getChartFrame() {\r\n        const URL = (window.location.search || '').includes('dev=true') ? 'http://localhost:3000/' : 'chart/';\r\n\r\n        return <div style={{display: this.props.visible ? 'block' : 'none'}} className={typeof this.props.selectedId !== 'string' ? this.props.classes.heightWithoutToolbar : this.props.classes.height100}>\r\n            <ChartFrame\r\n                src={URL + 'index.html?edit=1'}\r\n                presetData={this.props.presetData}\r\n            />\r\n        </div>;\r\n    }\r\n\r\n    render() {\r\n        return <MuiThemeProvider theme={this.props.theme}>\r\n            <div className={this.props.classes.container}>\r\n                {this.renderToolbar()}\r\n                {this.getChartFrame()}\r\n            </div>\r\n        </MuiThemeProvider>\r\n    }\r\n}\r\n\r\nMainChart.propTypes = {\r\n    onChange: PropTypes.func.isRequired,\r\n    onCreatePreset: PropTypes.func.isRequired,\r\n    visible: PropTypes.bool,\r\n    runningInstances: PropTypes.object,\r\n    presetData: PropTypes.object,\r\n    chartsList: PropTypes.array,\r\n    selectedId: PropTypes.oneOfType([\r\n        PropTypes.string,\r\n        PropTypes.object]),\r\n    theme: PropTypes.object\r\n};\r\n\r\nexport default withStyles(styles)(MainChart);\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport withWidth from '@material-ui/core/withWidth';\r\nimport {withStyles, withTheme} from '@material-ui/core/styles';\r\nimport clsx from 'clsx';\r\nimport { useDrag, useDrop, DndProvider as DragDropContext } from 'react-dnd';\r\nimport { HTML5Backend } from 'react-dnd-html5-backend'\r\n\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from '@material-ui/core/Button';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\n\r\nimport ConfirmDialog from '@iobroker/adapter-react/Dialogs/Confirm'\r\n\r\n// icons\r\nimport {MdExpandLess as IconCollapse} from 'react-icons/md';\r\nimport {MdExpandMore as IconExpand} from 'react-icons/md';\r\nimport {MdAdd as IconAdd} from 'react-icons/md';\r\nimport {MdModeEdit as IconEdit} from 'react-icons/md';\r\nimport {MdClose as IconCancel} from 'react-icons/md';\r\nimport {MdCheck as IconCheck} from 'react-icons/md';\r\nimport {MdDelete as IconDelete} from 'react-icons/md';\r\nimport {FaScroll as IconScript} from 'react-icons/all';\r\nimport {FaFolder as IconFolderClosed} from 'react-icons/all';\r\nimport {FaFolderOpen as IconFolderOpened} from 'react-icons/all';\r\nimport IconCopy from '@iobroker/adapter-react/Components/CopyIcon';\r\n\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\nimport DialogSelectID from '@iobroker/adapter-react/Dialogs/SelectID';\r\nimport Utils from '@iobroker/adapter-react/Components/Utils';\r\n\r\n/*function getFolderPrefix(presetId) {\r\n    let result = presetId.split('.');\r\n    result.shift();\r\n    result.shift();\r\n    result.pop();\r\n    result = result.join('.');\r\n    return result;\r\n}*/\r\nconst HIDDEN_FOLDER = '_consumption_';\r\n\r\nconst hideFolder = !window.location.search.includes('hidden=false');\r\n\r\nfunction getFolderList(folder) {\r\n    let result = [];\r\n    Object.values(folder.subFolders || {})\r\n        .forEach(subFolder =>\r\n            result = result.concat(getFolderList(subFolder)));\r\n\r\n    return result;\r\n}\r\n\r\nexport const Droppable = (props) => {\r\n    const { onDrop} = props;\r\n\r\n    const [{ isOver, isOverAny}, drop] = useDrop({\r\n        accept: ['item'],\r\n        drop: e => isOver ? onDrop(e) : undefined,\r\n        collect: monitor => ({\r\n            isOver: monitor.isOver({ shallow: true }),\r\n            isOverAny: monitor.isOver(),\r\n        }),\r\n    });\r\n\r\n    return <div ref={drop} className={clsx(isOver && 'js-folder-dragover', isOverAny && 'js-folder-dragging')}>\r\n        {props.children}\r\n    </div>;\r\n};\r\n\r\nexport const Draggable = (props) => {\r\n    const { name } = props;\r\n    const [{ opacity }, drag] = useDrag({\r\n        item: {\r\n            name,\r\n            type: 'item'\r\n        },\r\n        collect: (monitor) => ({\r\n            opacity: monitor.isDragging() ? 0.3 : 1,\r\n        }),\r\n    });\r\n    // About transform: https://github.com/react-dnd/react-dnd/issues/832#issuecomment-442071628\r\n    return <div ref={drag} style={{ opacity, transform: 'translate3d(0, 0, 0)' }}>\r\n        {props.children}\r\n    </div>;\r\n};\r\n\r\nconst LEVEL_PADDING = 16;\r\nconst FORBIDDEN_CHARS = /[.\\][*,;'\"`<>\\\\?]/g;\r\n\r\nconst styles = theme => ({\r\n    noGutters: {\r\n        paddingTop: 0,\r\n        paddingBottom: 0,\r\n        width: '100%'\r\n    },\r\n    changed: {\r\n        position: 'relative',\r\n        '&:after': {\r\n            content: '\"\"',\r\n            position: 'absolute',\r\n            top: 2,\r\n            right: 2,\r\n            width: 5,\r\n            height: 5,\r\n            borderRadius: 5,\r\n            background: theme.type === 'dark' ? '#CC0000' : '#CC0000',\r\n        }\r\n    },\r\n    itemIcon: {\r\n        width: 32,\r\n        height: 32,\r\n        marginRight: 4,\r\n    },\r\n    itemIconFolder: {\r\n        cursor: 'pointer'\r\n    },\r\n    buttonsContainer: {\r\n        '& button': {\r\n            whiteSpace: 'nowrap'\r\n        }\r\n    },\r\n    itemIconPreset: {\r\n        color: theme.type === 'dark' ? theme.palette.primary.light : theme.palette.primary.dark\r\n    },\r\n    folderIconPreset: {\r\n        color: theme.type === 'dark' ? theme.palette.secondary.dark : theme.palette.secondary.light\r\n    },\r\n    width100: {\r\n        width: '100%',\r\n    },\r\n    buttonIcon: {\r\n        marginRight: theme.spacing(0.5),\r\n    },\r\n    itemIconRoot: {\r\n        minWidth: 24,\r\n    },\r\n    listItemSubTitle: {\r\n        fontSize: 'smaller',\r\n        opacity: 0.7,\r\n        fontStyle: 'italic'\r\n    },\r\n    mainList: {\r\n        width: 'calc(100% - ' + theme.spacing(1) + 'px)',\r\n        marginLeft: theme.spacing(1),\r\n        '& .js-folder-dragover>li>.folder-reorder': {\r\n            background: '#40adff'\r\n        },\r\n        '& .js-folder-dragging .folder-reorder': {\r\n            opacity: 1,\r\n        },\r\n        '& .js-folder-dragging .item-reorder': {\r\n            opacity: 0.3,\r\n        }\r\n    },\r\n    iconCopy: {\r\n        width: 16,\r\n    }\r\n});\r\n\r\nclass MenuList extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        let presetsOpened;\r\n        try {\r\n            presetsOpened = JSON.parse(window.localStorage.getItem('App.echarts.presets.opened')) || [];\r\n        } catch (e) {\r\n            presetsOpened = [];\r\n        }\r\n\r\n        this.state = {\r\n            presetsOpened,\r\n\r\n            presets: {},\r\n            presetFolders: null,\r\n            changingPreset: '',\r\n\r\n            deletePresetDialog: null,\r\n            movePresetDialog: null,\r\n            newPresetFolder: '',\r\n            addPresetFolderDialog: null,\r\n            addPresetFolderName: '',\r\n            editPresetFolderDialog: null,\r\n            editPresetFolderName: '',\r\n        };\r\n\r\n        this.getAllPresets()\r\n            .then(newState => this.setState(newState));\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.socket.subscribeObject(this.props.adapterName  + '.0.*', this.onPresetChange);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.props.socket.unsubscribeObject(this.props.adapterName  + '.0.*', this.onPresetChange);\r\n    }\r\n\r\n    onPresetChange = (id, obj) => {\r\n        if (!id || !id.startsWith('echarts.')) {\r\n            return;\r\n        }\r\n        let presets;\r\n        let changed = false;\r\n        if (obj) {\r\n            obj.common = obj.common || {};\r\n            obj.native = obj.native || {};\r\n            if (JSON.stringify(obj) !== JSON.stringify(this.state.presets[id])) {\r\n                presets = JSON.parse(JSON.stringify(this.state.presets));\r\n                presets[id] = obj;\r\n                changed = true;\r\n            }\r\n        } else if (this.state.presets[id]) {\r\n            presets = JSON.parse(JSON.stringify(this.state.presets));\r\n            delete presets[id];\r\n            changed = true;\r\n        }\r\n\r\n        if (changed) {\r\n            const emptyFolders = this.getEmptyFolders();\r\n            const newState = {presets, changingPreset: '', presetFolders: this.buildPresetTree(presets, emptyFolders)};\r\n            setTimeout(() => this.informAboutSubFolders(newState.presetFolders), 200);\r\n            this.setState(newState);\r\n        }\r\n    };\r\n\r\n    informAboutSubFolders(presetFolders) {\r\n        presetFolders = presetFolders || this.state.presetFolders || {};\r\n        this.props.onShowReorder(!!Object.keys(presetFolders.subFolders || {}).length);\r\n    }\r\n\r\n    getEmptyFolders(presetFolders, _path, _result) {\r\n        _result = _result || [];\r\n        _path   = _path   || [];\r\n        presetFolders = presetFolders || this.state.presetFolders || {};\r\n\r\n        if (presetFolders.id/* && !Object.keys(presetFolders.subFolders).length && !Object.keys(presetFolders.presets).length*/) {\r\n            const __path = [..._path];\r\n            __path.push(presetFolders.id)\r\n            _result.push(__path.join('.'));\r\n        }\r\n\r\n        if (presetFolders.subFolders) {\r\n            Object.keys(presetFolders.subFolders).forEach(name =>\r\n                this.getEmptyFolders(presetFolders.subFolders[name], _path, _result));\r\n        }\r\n\r\n        return _result;\r\n    }\r\n\r\n    getAllPresets(newState) {\r\n        newState = newState || {};\r\n        let presets = {};\r\n\r\n        return new Promise((resolve, reject) =>\r\n            this.props.socket.getRawSocket().emit('getObjectView', 'chart', 'chart', {\r\n                startkey: this.props.adapterName + '.',\r\n                endkey:   this.props.adapterName + '.\\u9999'\r\n            }, (err, res) => {\r\n                if (err) {\r\n                    reject(err);\r\n                } else {\r\n                    res && res.rows && res.rows.forEach(preset => preset.value._id && !preset.value._id.toString().endsWith('.') && (presets[preset.value._id] = preset.value));\r\n                    newState.presets = presets;\r\n                    newState.changingPreset = '';\r\n\r\n                    // fill missing info\r\n                    Object.keys(newState.presets).forEach(id => {\r\n                        const presetObj = newState.presets[id];\r\n                        presetObj.common = presetObj.common || {};\r\n                        presetObj.native = presetObj.native || {};\r\n                    });\r\n\r\n                    // store all empty folders\r\n                    const emptyFolders = this.getEmptyFolders();\r\n                    newState.presetFolders = this.buildPresetTree(presets, emptyFolders);\r\n                    setTimeout(() => this.informAboutSubFolders(newState.presetFolders), 200);\r\n                    resolve(newState);\r\n                }\r\n            }));\r\n    }\r\n\r\n    renderTreePreset(item, level, anySubFolders) {\r\n        const preset = this.state.presets[item._id];\r\n        if (!preset || (this.props.search && !item.common.name.includes(this.props.search))) {\r\n            return null;\r\n        }\r\n\r\n        level = level || 0;\r\n\r\n        const depthPx = (this.props.reorder ? level : level - 1) * LEVEL_PADDING;\r\n\r\n        const listItem = <ListItem\r\n            classes={ {gutters: clsx(this.props.classes.noGutters, this.props.selectedId === preset._id && this.props.selectedPresetChanged && this.props.classes.changed)} }\r\n            style={ {paddingLeft: depthPx } }\r\n            key={ item._id }\r\n            className={ clsx(this.props.reorder && 'item-reorder') }\r\n            selected={this.props.selectedId === item._id}\r\n            button\r\n            onClick={() => this.props.onSelectedChanged(preset._id)}\r\n        >\r\n            <ListItemIcon classes={ {root: clsx(this.props.classes.itemIconRoot, this.props.classes.itemIconPreset)} }><IconScript className={ this.props.classes.itemIcon }/></ListItemIcon>\r\n            <ListItemText\r\n                classes={ {primary: this.props.classes.listItemTitle, secondary: this.props.classes.listItemSubTitle} }\r\n                primary={ <>\r\n                    { Utils.getObjectNameFromObj(preset, null, {language: I18n.getLanguage()}) }\r\n                </>}\r\n                secondary={ Utils.getObjectNameFromObj(preset, null, {language: I18n.getLanguage()}, true) }\r\n            />\r\n            <ListItemSecondaryAction>\r\n                {this.state.changingPreset === preset._id ?\r\n                    <CircularProgress size={ 24 }/>\r\n                    :\r\n                    (!this.props.reorder ? <>\r\n                        {this.props.selectedId !== preset._id || !this.props.selectedPresetChanged ? <IconButton\r\n                            size=\"small\"\r\n                            aria-label=\"Rename\"\r\n                            title={ I18n.t('Rename') }\r\n                            onClick={ (e) => {\r\n                                e.stopPropagation();\r\n                                this.setState({renameDialog: preset._id, renamePresetDialogTitle: item.common.name})\r\n                            }}\r\n                        >\r\n                            <IconEdit/>\r\n                        </IconButton> : null }\r\n                        {/*level || anySubFolders ?\r\n                            <IconButton\r\n                                size=\"small\"\r\n                                aria-label=\"Move to folder\"\r\n                                title={ I18n.t('Move to folder') }\r\n                                onClick={ () => this.setState({movePresetDialog: preset._id, newPresetFolder: getFolderPrefix(preset._id)}) }>\r\n                                <IconMoveToFolder/>\r\n                            </IconButton> : null*/}\r\n                        <IconButton size=\"small\" aria-label=\"Copy\" title={ I18n.t('Copy') } onClick={ () => this.props.onCopyPreset(preset._id) }><IconCopy className={this.props.classes.iconCopy}/></IconButton>\r\n                        <IconButton size=\"small\" aria-label=\"Delete\" title={ I18n.t('Delete') } onClick={ () => this.setState({deletePresetDialog: preset._id}) }><IconDelete/></IconButton>\r\n                    </> : null)\r\n                }\r\n            </ListItemSecondaryAction>\r\n        </ListItem>;\r\n\r\n        if (this.props.reorder) {\r\n            return <Draggable key={'draggable_' + item._id} name={item._id}>{listItem}</Draggable>;\r\n        } else {\r\n            return  listItem;\r\n        }\r\n    }\r\n\r\n    renderPresetsTree(parent, level) {\r\n        let result = [];\r\n\r\n        level = level || 0;\r\n        let presetsOpened = this.props.reorder || (this.state.presetsOpened && parent ? this.state.presetsOpened.includes(parent.prefix) : false);\r\n\r\n        const depthPx = (this.props.reorder ? level : level - 1) * LEVEL_PADDING;\r\n\r\n        const reactChildren = [];\r\n        if (parent && (presetsOpened || !parent.id)) { // root cannot be closed and have id = ''\r\n            const values     = Object.values(parent.presets || {});\r\n            const subFolders = Object.values(parent.subFolders || {});\r\n\r\n            // add first sub-folders\r\n            subFolders\r\n                .sort((a, b) => a.id > b.id ? 1 : (a.id < b.id ? -1 : 0))\r\n                .filter(subFolder => !(hideFolder && subFolder.id === HIDDEN_FOLDER))\r\n                .forEach(subFolder =>\r\n                    reactChildren.push(this.renderPresetsTree(subFolder, level + 1)));\r\n\r\n            // Add as second the presets\r\n            if (values.length || subFolders.length) {\r\n                values\r\n                    .sort((a, b) => a._id > b._id ? 1 : (a._id < b._id ? -1 : 0))\r\n                    .forEach(preset =>\r\n                        reactChildren.push(this.renderTreePreset(preset, level + 1, subFolders.length)));\r\n            } else {\r\n                reactChildren.push(<ListItem key=\"no presets\" classes={ {gutters: this.props.classes.noGutters} }>\r\n                    <ListItemText className={ this.props.classes.folderItem}>{ I18n.t('No presets created yet')}</ListItemText>\r\n                </ListItem>);\r\n            }\r\n        }\r\n\r\n        // Show folder item\r\n        if (parent && (parent.id || this.props.reorder)) {\r\n            const folder = <ListItem\r\n                key={ parent.prefix }\r\n                classes={ {gutters: this.props.classes.noGutters } }\r\n                className={ clsx(\r\n                    this.props.classes.width100,\r\n                    this.props.classes.folderItem,\r\n                    this.props.reorder && 'folder-reorder'\r\n                ) }\r\n                style={ {paddingLeft: depthPx} }\r\n            >\r\n                <ListItemIcon classes={ {root: clsx(this.props.classes.itemIconRoot, this.props.classes.folderIconPreset)} } onClick={ () => this.togglePresetsFolder(parent) }>{ presetsOpened ?\r\n                    <IconFolderOpened className={ clsx(this.props.classes.itemIcon, this.props.classes.itemIconFolder) }/> :\r\n                    <IconFolderClosed className={ clsx(this.props.classes.itemIcon, this.props.classes.itemIconFolder) }/>\r\n                }</ListItemIcon>\r\n                <ListItemText>{ parent.id || I18n.t('Root')}</ListItemText>\r\n                <ListItemSecondaryAction>\r\n                    {!this.props.reorder && parent && parent.id && presetsOpened ? <IconButton\r\n                        onClick={() => this.props.onCreatePreset(null, parent.id)}\r\n                        title={ I18n.t('Create new preset') }\r\n                    ><IconAdd/></IconButton> : null}\r\n                    {!this.props.reorder ? <IconButton\r\n                        onClick={() => this.setState({editPresetFolderDialog: parent, editPresetFolderName: parent.id, editFolderDialogTitleOrigin: parent.id})}\r\n                        title={I18n.t('Edit folder name')}\r\n                    ><IconEdit/></IconButton> : null}\r\n                        {!this.props.reorder ? <IconButton onClick={ () => this.togglePresetsFolder(parent) } title={ presetsOpened ? I18n.t('Collapse') : I18n.t('Expand')  }>\r\n                        { presetsOpened ? <IconCollapse/> : <IconExpand/> }\r\n                    </IconButton> : null}\r\n                </ListItemSecondaryAction>\r\n            </ListItem>;\r\n\r\n            if (!this.props.reorder) {\r\n                result.push(folder);\r\n            } else {\r\n                result.push(<Droppable\r\n                    key={'droppable_' + parent.prefix}\r\n                   name={parent.prefix}\r\n                   onDrop={e => this.onDragFinish(e.name, 'echarts.0' + (parent.prefix ? '.' : '') + parent.prefix)}\r\n                >\r\n                    {folder}\r\n                </Droppable>);\r\n            }\r\n        }\r\n\r\n        reactChildren && reactChildren.forEach(r => result.push(r));\r\n\r\n        return result;\r\n    };\r\n\r\n    renamePresetFolder(folder, newName) {\r\n        return new Promise(resolve => this.setState({changingPreset: folder}, () => resolve()))\r\n            .then(() => {\r\n                let newSelectedId;\r\n                let pos;\r\n                // if selected folder opened, replace its ID in this.state.opened\r\n                if ((pos = this.state.presetsOpened.indexOf(folder.prefix)) !== -1) {\r\n                    const presetsOpened = [...this.state.presetsOpened];\r\n                    presetsOpened.splice(pos, 1);\r\n                    presetsOpened.push(newName);\r\n                    presetsOpened.sort();\r\n                    this.setState({presetsOpened});\r\n                }\r\n\r\n                let prefix = folder.prefix.split('.');\r\n                prefix[prefix.length - 1] = newName;\r\n                prefix = prefix.join('.');\r\n\r\n                if (Object.keys(folder.presets).find(id => id === this.props.selectedId)) {\r\n                    newSelectedId = `preset.0.${prefix}.${this.props.selectedId.split('.').pop()}`;\r\n                }\r\n\r\n                const promises = Object.keys(folder.presets).map(presetId =>\r\n                    this.addPresetToFolderPrefix(folder.presets[presetId], prefix, true));\r\n\r\n                return Promise.all(promises)\r\n                    .then(() => this.getAllPresets())\r\n                    .then(newState =>\r\n                        this.setState(newState, () =>\r\n                            this.props.onSelectedChanged(newSelectedId)));\r\n            });\r\n    }\r\n\r\n    isNameUnique(presetId, name) {\r\n        const len = presetId.split('.').length;\r\n        if (name === HIDDEN_FOLDER) {\r\n            return false;\r\n        }\r\n        return !Object.keys(this.state.presets)\r\n            .find(id => len === id.split('.').length && this.state.presets[id].common.name === name);\r\n    }\r\n\r\n    buildPresetTree(presets, emptyFolders) {\r\n        // console.log(presets);\r\n        presets = Object.values(presets);\r\n\r\n        let presetFolders = {subFolders: {}, presets: {}, id: '', prefix: ''};\r\n\r\n        // create missing folders\r\n        presets.forEach(preset => {\r\n            let id = preset._id;\r\n            const parts = id.split('.');\r\n            parts.shift();\r\n            parts.shift();\r\n            let currentFolder = presetFolders;\r\n            let prefix = '';\r\n            for (let i = 0; i < parts.length - 1; i++) {\r\n                if (prefix) {\r\n                    prefix = prefix + '.';\r\n                }\r\n                prefix = prefix + parts[i];\r\n                if (!currentFolder.subFolders[parts[i]]) {\r\n                    currentFolder.subFolders[parts[i]] = {\r\n                        subFolders: {},\r\n                        presets: {},\r\n                        id: parts[i],\r\n                        prefix,\r\n                    }\r\n                }\r\n                currentFolder = currentFolder.subFolders[parts[i]];\r\n            }\r\n            currentFolder.presets[id] = preset;\r\n        });\r\n\r\n        if (emptyFolders && emptyFolders.length) {\r\n            emptyFolders.forEach(id => {\r\n                const parts = id.split('.');\r\n                let currentFolder = presetFolders;\r\n                let prefix = '';\r\n                for (let i = 0; i < parts.length; i++) {\r\n                    if (prefix) {\r\n                        prefix = prefix + '.';\r\n                    }\r\n                    prefix = prefix + parts[i];\r\n                    if (!currentFolder.subFolders[parts[i]]) {\r\n                        currentFolder.subFolders[parts[i]] = {\r\n                            subFolders: {},\r\n                            presets: {},\r\n                            id: parts[i],\r\n                            prefix,\r\n                        }\r\n                    }\r\n                    currentFolder = currentFolder.subFolders[parts[i]];\r\n                }\r\n            });\r\n        }\r\n\r\n\r\n        return presetFolders;\r\n    }\r\n\r\n    findFolder(parent, folder) {\r\n        if (parent && parent.prefix === folder.prefix) {\r\n            return parent;\r\n        }\r\n        if (parent && parent.subFolders) {\r\n            for (let index in parent.subFolders) {\r\n                if (parent.subFolders.hasOwnProperty(index)) {\r\n                    let result = this.findFolder(parent.subFolders[index], folder);\r\n                    if (result) {\r\n                        return result;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    addFolder(parentFolder, id) {\r\n        let presetFolders = JSON.parse(JSON.stringify(this.state.presetFolders));\r\n        parentFolder = parentFolder || presetFolders;\r\n        let _parentFolder = this.findFolder(presetFolders, parentFolder);\r\n\r\n        let presetsOpened = JSON.parse(JSON.stringify(this.state.presetsOpened));\r\n\r\n        _parentFolder.subFolders[id] = {\r\n            presets: {},\r\n            subFolders: {},\r\n            id,\r\n            prefix: _parentFolder.prefix ? _parentFolder.prefix + '.' + id : id\r\n        };\r\n\r\n        presetsOpened.push(id);\r\n\r\n        return new Promise(resolve =>\r\n            this.setState({presetFolders, presetsOpened}, () => resolve()));\r\n    }\r\n\r\n    togglePresetsFolder(folder) {\r\n        const presetsOpened = [...this.state.presetsOpened];\r\n        const pos = presetsOpened.indexOf(folder.prefix);\r\n        if (pos === -1) {\r\n            presetsOpened.push(folder.prefix);\r\n        } else {\r\n            presetsOpened.splice(pos, 1);\r\n\r\n            // If active preset is inside this folder select the first preset\r\n            if (Object.keys(folder.presets).includes(this.props.selectedId)) {\r\n                return this.props.onSelectedChanged(null, allowedId => {\r\n                    if (allowedId !== false) {\r\n                        window.localStorage.setItem('App.echarts.presets.opened', JSON.stringify(presetsOpened));\r\n                        this.setState({presetsOpened});\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        window.localStorage.setItem('App.echarts.presets.opened', JSON.stringify(presetsOpened));\r\n\r\n        this.setState({presetsOpened});\r\n    }\r\n\r\n    renderAddFolderDialog() {\r\n        return this.props.addPresetFolderDialog ?\r\n            <Dialog\r\n                maxWidth=\"md\"\r\n                fullWidth={true}\r\n                open={ true }\r\n                onClose={ () => this.props.onClosePresetFolderDialog()}\r\n            >\r\n                <DialogTitle>{I18n.t('Create folder')}</DialogTitle>\r\n                <DialogContent className={ this.props.classes.p }>\r\n                    <TextField\r\n                        fullWidth={true}\r\n                        label={ I18n.t('Title') }\r\n                        value={ this.state.addPresetFolderName }\r\n                        onChange={ e => this.setState({addPresetFolderName: e.target.value.replace(FORBIDDEN_CHARS, '_').trim()})}\r\n                        onKeyPress={e => {\r\n                            if (this.state.addPresetFolderName && e.which === 13 && this.state.addPresetFolderName !== HIDDEN_FOLDER) {\r\n                                this.addFolder(null, this.state.addPresetFolderName)\r\n                                    .then(() => this.props.onClosePresetFolderDialog(() =>\r\n                                        this.informAboutSubFolders()));\r\n                            }\r\n                        }}\r\n                    />\r\n                </DialogContent>\r\n                <DialogActions className={ clsx(this.props.classes.alignRight, this.props.classes.buttonsContainer) }>\r\n                    <Button variant=\"contained\" onClick={() => this.props.onClosePresetFolderDialog()}>\r\n                        <IconCancel className={ this.props.classes.buttonIcon }/>\r\n                        { I18n.t('Cancel') }\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"contained\"\r\n                        disabled={\r\n                            !this.state.addPresetFolderName ||\r\n                            !!Object.keys((this.state.presetFolders && this.state.presetFolders.subFolders) || {}).find(name => name === this.state.addPresetFolderName) ||\r\n                            this.state.addPresetFolderName === HIDDEN_FOLDER\r\n                        }\r\n                        onClick={() =>\r\n                            this.addFolder(null, this.state.addPresetFolderName)\r\n                                .then(() => this.props.onClosePresetFolderDialog(() =>\r\n                                    this.informAboutSubFolders()))\r\n                        }\r\n                        color=\"primary\" autoFocus\r\n                    >\r\n                        <IconCheck className={ this.props.classes.buttonIcon }/>\r\n                        {I18n.t('Create')}\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog> : null;\r\n    }\r\n\r\n    renderRenameFolderDialog() {\r\n        if (!this.state.editPresetFolderDialog) {\r\n            return null;\r\n        }\r\n\r\n        const isUnique = !Object.keys((this.state.presetFolders && this.state.presetFolders.subFolders) || {})\r\n            .find(folder => folder.id === this.state.editPresetFolderName);\r\n\r\n        return <Dialog\r\n            maxWidth=\"md\"\r\n            fullWidth={true}\r\n            open={ !!this.state.editPresetFolderDialog }\r\n            onClose={ () => this.setState({editPresetFolderDialog: null}) }\r\n        >\r\n            <DialogTitle>{ I18n.t('Edit folder') }</DialogTitle>\r\n            <DialogContent>\r\n                <TextField\r\n                    fullWidth={true}\r\n                    label={ I18n.t('Title') }\r\n                    value={ this.state.editPresetFolderName }\r\n                    onKeyPress={e => {\r\n                        if (this.state.editPresetFolderName && e.which === 13 && this.state.editPresetFolderName !== HIDDEN_FOLDER) {\r\n                            this.renamePresetFolder(this.state.editPresetFolderDialog, this.state.editPresetFolderName)\r\n                                .then(() => this.setState({editPresetFolderDialog: null}));\r\n                        }\r\n                    }}\r\n                    onChange={ e => this.setState({editPresetFolderName: e.target.value.replace(FORBIDDEN_CHARS, '_').trim()}) }/>\r\n            </DialogContent>\r\n            <DialogActions className={ clsx(this.props.classes.alignRight, this.props.classes.buttonsContainer) }>\r\n                <Button variant=\"contained\" onClick={ () => this.setState({editPresetFolderDialog: null}) }>\r\n                    <IconCancel className={ this.props.classes.buttonIcon }/>\r\n                    { I18n.t('Cancel') }\r\n                </Button>\r\n                <Button\r\n                    variant=\"contained\"\r\n                    disabled={ !this.state.editPresetFolderName || this.state.editFolderDialogTitleOrigin === this.state.editPresetFolderName || !isUnique || this.state.editPresetFolderName === HIDDEN_FOLDER}\r\n                    onClick={ () => {\r\n                        this.renamePresetFolder(this.state.editPresetFolderDialog, this.state.editPresetFolderName)\r\n                            .then(() => this.setState({editPresetFolderDialog: null}));\r\n                    }}\r\n                    color=\"primary\"\r\n                    autoFocus\r\n                >\r\n                    <IconCheck className={ this.props.classes.buttonIcon }/>\r\n                    { I18n.t('Rename') }\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>;\r\n    }\r\n\r\n    renderMoveDialog() {\r\n        if (!this.state.movePresetDialog) {\r\n            return null;\r\n        }\r\n\r\n        const newPresetFolder = this.state.newPresetFolder === '__root__' ? '' : this.state.newPresetFolder;\r\n        const presetId = this.state.movePresetDialog;\r\n        const newId = 'preset.0.' + newPresetFolder + (newPresetFolder ? '.' : '') + presetId;\r\n\r\n        const isIdUnique = !Object.keys(this.state.presets).find(id => id === newId);\r\n\r\n        return <Dialog\r\n            maxWidth=\"md\"\r\n            fullWidth={true}\r\n            open={ true }\r\n            key=\"movePresetDialog\"\r\n            onClose={ () => this.setState({movePresetDialog: null}) }\r\n        >\r\n            <DialogTitle>{ I18n.t('Move to folder') }</DialogTitle>\r\n            <DialogContent>\r\n                <FormControl classes={ {root: this.props.classes.width100} }>\r\n                    <InputLabel shrink={ true }>{ I18n.t('Folder') }</InputLabel>\r\n                    <Select\r\n                        fullWidth={true}\r\n                        className={ this.props.classes.width100 }\r\n                        value={ this.state.newPresetFolder || '__root__' }\r\n                        onChange={e => this.setState({newPresetFolder: e.target.value}) }\r\n                        onKeyPress={e => e.which === 13 && this.setState({movePresetDialog: null}, () =>\r\n                            this.addPresetToFolderPrefix(this.state.presets[presetId], this.state.newPresetFolder === '__root__' ? '' : this.state.newPresetFolder))\r\n                        }\r\n                    >\r\n                        { getFolderList(this.state.presetFolders || {}).map(folder =>\r\n                            <MenuItem\r\n                                key={ folder.prefix }\r\n                                value={ folder.prefix || '__root__' }\r\n                            >\r\n                                { folder.prefix ? folder.prefix.replace('.', ' > ') : I18n.t('Root') }\r\n                            </MenuItem>)\r\n                        }\r\n                    </Select>\r\n                </FormControl>\r\n            </DialogContent>\r\n            <DialogActions className={ clsx(this.props.classes.alignRight, this.props.classes.buttonsContainer) }>\r\n                <Button variant=\"contained\" onClick={ () => this.setState({movePresetDialog: null}) }>\r\n                    <IconCancel className={ this.props.classes.buttonIcon }/>\r\n                    { I18n.t('Cancel') }\r\n                </Button>\r\n                <Button\r\n                    variant=\"contained\"\r\n                    disabled={ !isIdUnique }\r\n                    color=\"primary\" onClick={() =>\r\n                    this.setState({movePresetDialog: null}, () =>\r\n                        this.addPresetToFolderPrefix(this.state.presets[presetId], this.state.newPresetFolder === '__root__' ? '' : this.state.newPresetFolder))\r\n                }\r\n                >\r\n                    <IconCheck className={ this.props.classes.buttonIcon }/>\r\n                    { I18n.t('Move to folder') }\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>;\r\n    }\r\n\r\n    onError(e, comment) {\r\n        comment && console.error(comment);\r\n        this.props.onShowError(e);\r\n    }\r\n\r\n    onDragFinish(source, target) {\r\n        // new Id\r\n        let newId = target + '.' + source.split('.').pop();\r\n        if (newId !== source) {\r\n            // Check if source yet exists\r\n            if (this.state.presets[newId]) {\r\n                newId += '_' + I18n.t('copy');\r\n            }\r\n\r\n            this.props.socket.getObject(source)\r\n                .then(obj => {\r\n                    if (obj) {\r\n                        this.props.socket.delObject(source)\r\n                            .then(() => this.props.socket.setObject(newId, obj))\r\n                            .then(() => this.getAllPresets())\r\n                            .then(newState => this.setState(newState))\r\n                            .catch(e => this.onError(e, `Cannot delete object ${source}`));\r\n                    }\r\n                })\r\n                .catch(e => this.onError(e, `Cannot read object ${source}`));\r\n        }\r\n    }\r\n\r\n    renderRenameDialog() {\r\n        if (!this.state.renameDialog) {\r\n            return null;\r\n        }\r\n\r\n        const presetId = this.state.renameDialog;\r\n\r\n        return <Dialog\r\n            maxWidth=\"md\"\r\n            fullWidth={true}\r\n            open={ true }\r\n            key=\"renameDialog\"\r\n            onClose={ () => this.setState({renameDialog: null}) }\r\n        >\r\n            <DialogTitle>{ I18n.t('Rename preset') }</DialogTitle>\r\n            <DialogContent>\r\n                <FormControl classes={ {root: this.props.classes.width100} }>\r\n                    <TextField\r\n                        fullWidth={true}\r\n                        label={ I18n.t('Name') }\r\n                        value={ this.state.renamePresetDialogTitle }\r\n                        onChange={ e => this.setState({renamePresetDialogTitle: e.target.value})}\r\n                        onKeyPress={e => {\r\n                            if (this.isNameUnique(presetId, this.state.renamePresetDialogTitle) && this.state.renamePresetDialogTitle && e.which === 13) {\r\n                                this.setState({renameDialog: null}, () =>\r\n                                    this.renamePreset(presetId, this.state.renamePresetDialogTitle));\r\n                            }\r\n                        }}\r\n                    />\r\n                </FormControl>\r\n            </DialogContent>\r\n            <DialogActions className={ clsx(this.props.classes.alignRight, this.props.classes.buttonsContainer) }>\r\n                <Button variant=\"contained\" onClick={ () => this.setState({renameDialog: null}) }>\r\n                    <IconCancel className={ this.props.classes.buttonIcon }/>\r\n                    { I18n.t('Cancel') }\r\n                </Button>\r\n                <Button\r\n                    variant=\"contained\"\r\n                    disabled={ !this.state.renamePresetDialogTitle || !this.isNameUnique(presetId, this.state.renamePresetDialogTitle) }\r\n                    color=\"primary\" onClick={() =>\r\n                    this.setState({renameDialog: null}, () =>\r\n                        this.renamePreset(presetId, this.state.renamePresetDialogTitle))\r\n                }\r\n                >\r\n                    <IconCheck className={ this.props.classes.buttonIcon }/>\r\n                    { I18n.t('Rename') }\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>;\r\n    }\r\n\r\n    renderDeleteDialog() {\r\n        return this.state.deletePresetDialog ? <ConfirmDialog\r\n            title={ I18n.t('Are you sure for delete this preset?') }\r\n            ok={ I18n.t('Delete') }\r\n            cancel={ I18n.t('Cancel') }\r\n            suppressQuestionMinutes={3}\r\n            key=\"deletePresetDialog\"\r\n            dialogName=\"echarts.deletePresetDialog\"\r\n            onClose={isYes => {\r\n                if (isYes) {\r\n                    this.deletePreset(this.state.deletePresetDialog, () =>\r\n                        this.setState({deletePresetDialog: false}));\r\n                } else {\r\n                    this.setState({deletePresetDialog: false});\r\n                }\r\n            }}\r\n        /> : null;\r\n    }\r\n\r\n    renderSelectIdDialog() {\r\n        if (!this.state.showAddStateDialog) {\r\n            return null;\r\n        } else {\r\n            return <DialogSelectID\r\n                key={'selectDialog_add'}\r\n                socket={ this.props.socket }\r\n                dialogName={'Add'}\r\n                type={'state'}\r\n                title={ I18n.t('Enable logging for state')}\r\n                onOk={id => {\r\n                    console.log('Selected ' + id);\r\n                    const instance = this.state.showAddStateDialog.replace('system.adapter.', '');\r\n                    if (id) {\r\n                        this.props.socket.getObject(id)\r\n                            .then(obj => {\r\n                                if (!obj || !obj.common) {\r\n                                    return this.props.onShowError(I18n.t('Invalid object'));\r\n                                }\r\n                                if (obj.common.custom && obj.common.custom[instance]) {\r\n                                    return this.showToast(I18n.t('Already enabled'));\r\n                                } else {\r\n                                    obj.common.custom = obj.common.custom || {};\r\n                                    obj.common.custom[instance] = {\r\n                                        enabled: true,\r\n                                    };\r\n                                    this.props.socket.setObject(id, obj)\r\n                                        .then(() => {\r\n                                            const instances = JSON.parse(JSON.stringify(this.state.instances));\r\n                                            const inst = instances.find(item => item._id === 'system.adapter.' + instance);\r\n                                            inst.enabledDP = inst.enabledDP || {};\r\n                                            inst.enabledDP[obj._id] = obj;\r\n                                            this.setState({instances});\r\n                                        })\r\n                                        .catch(e => this.onError(e, `Cannot save object ${id}`));\r\n                                }\r\n                            })\r\n                            .catch(e => this.onError(e, `Cannot read object ${id}`));\r\n                    }\r\n                    this.setState({showAddStateDialog: false});\r\n                } }\r\n                onClose={ () => this.setState({showAddStateDialog: false}) }\r\n            />;\r\n        }\r\n    }\r\n\r\n    deletePreset(id, cb) {\r\n        return this.props.socket.delObject(id)\r\n            .then(() => {\r\n                this.getAllPresets()\r\n                    .then(newState =>\r\n                        this.setState(newState, () =>\r\n                            this.props.onSelectedChanged(null)));\r\n            })\r\n            .catch(e => this.onError(e, `Cannot delete object ${id}`))\r\n            .then(() => cb && cb());\r\n    }\r\n\r\n    renamePreset(id, newTitle) {\r\n        let preset;\r\n        return this.props.socket.getObject(id)\r\n            .then(obj => {\r\n                preset = obj;\r\n                preset.common.name = newTitle;\r\n                let newId = id.split('.');\r\n                newId.splice(-1, 1);\r\n                newId.push(newTitle.replace(FORBIDDEN_CHARS, '_').trim());\r\n                newId = newId.join('.');\r\n\r\n                preset._id = newId;\r\n                return this.props.socket.delObject(id);\r\n            })\r\n            .then(() => this.props.socket.setObject(preset._id, preset))\r\n            .then(() => this.getAllPresets())\r\n            .then(newState => {\r\n                if (id === this.props.selectedId) {\r\n                    this.setState(newState, () =>\r\n                        this.props.onSelectedChanged(preset._id));\r\n                } else {\r\n                    this.setState(newState);\r\n                }\r\n            })\r\n            .catch(e => this.onError(e, `Cannot get object ${id}`));\r\n    }\r\n\r\n    addPresetToFolderPrefix = (preset, folderPrefix, noRefresh) => {\r\n        let oldId = preset._id;\r\n        let presetId = preset._id.split('.').pop();\r\n        preset._id = this.props.adapterName + '.0.' + folderPrefix + (folderPrefix ? '.' : '') + presetId;\r\n\r\n        return this.props.socket.delObject(oldId)\r\n            .then(() => {\r\n                console.log('Deleted ' + oldId);\r\n                return this.props.socket.setObject(preset._id, preset)\r\n            })\r\n            .then(() => {\r\n                console.log('Set new ID: ' + preset._id);\r\n                return !noRefresh && this.refreshData(presetId)\r\n            })\r\n            .catch(e => this.onError(e, `Cannot delete object ${oldId}`));\r\n    };\r\n\r\n    render() {\r\n        return <>\r\n            <DragDropContext backend={HTML5Backend}>\r\n                <List className={ clsx(this.props.classes.scroll, this.props.classes.mainList) }>\r\n                    { this.renderPresetsTree(this.state.presetFolders) }\r\n                </List>\r\n            </DragDropContext>\r\n            { this.renderAddFolderDialog() }\r\n            { this.renderRenameFolderDialog() }\r\n            { this.renderDeleteDialog() }\r\n            { this.renderMoveDialog() }\r\n            { this.renderRenameDialog() }\r\n        </>;\r\n    }\r\n}\r\n\r\nMenuList.propTypes = {\r\n    onChange: PropTypes.func,\r\n    socket: PropTypes.object,\r\n    addPresetFolderDialog: PropTypes.bool,\r\n    onClosePresetFolderDialog: PropTypes.func,\r\n    onCreatePreset: PropTypes.func,\r\n    onCopyPreset: PropTypes.func,\r\n    onShowReorder: PropTypes.func,\r\n    search: PropTypes.string,\r\n    reorder: PropTypes.bool,\r\n    adapterName: PropTypes.string.isRequired,\r\n    onShowError: PropTypes.func,\r\n    onSelectedChanged: PropTypes.func.isRequired,\r\n    selectedId: PropTypes.oneOfType([\r\n        PropTypes.object,\r\n        PropTypes.string\r\n    ]),\r\n    systemConfig: PropTypes.object,\r\n    selectedPresetChanged: PropTypes.bool,\r\n};\r\n\r\nexport default withWidth()(withStyles(styles)(withTheme(MenuList)));\r\n","import React, {Component} from \"react\";\r\nimport PropTypes from 'prop-types';\r\nimport withWidth from \"@material-ui/core/withWidth\";\r\nimport {withStyles, withTheme} from \"@material-ui/core/styles\";\r\nimport clsx from 'clsx';\r\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\r\n\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Switch from '@material-ui/core/Switch';\r\n\r\n// icons\r\nimport {MdExpandLess as IconCollapse} from 'react-icons/md';\r\nimport {MdExpandMore as IconExpand} from 'react-icons/md';\r\nimport {MdAdd as IconAdd} from 'react-icons/md';\r\nimport {FaFolder as IconFolderClosed} from 'react-icons/all';\r\nimport {FaFolderOpen as IconFolderOpened} from 'react-icons/all';\r\nimport {AiOutlineAreaChart as IconChart} from 'react-icons/ai';\r\nimport {FaWaveSquare as IconBooleanChart} from 'react-icons/fa';\r\n\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\nimport DialogSelectID from '@iobroker/adapter-react/Dialogs/SelectID';\r\nimport Utils from '@iobroker/adapter-react/Components/Utils';\r\n\r\nfunction sortObj(a, b) {\r\n    const aid = typeof a === 'object' ? a._id.replace('system.adapter.', '') : a.replace('system.adapter.', '');\r\n    const bid = typeof b === 'object' ? b._id.replace('system.adapter.', '') : b.replace('system.adapter.', '');\r\n    if (aid > bid) {\r\n        return 1;\r\n    } else if (aid < bid) {\r\n        return -1;\r\n    } else {\r\n        return 0;\r\n    }\r\n}\r\n\r\nfunction getEnumsForId(enums, id) {\r\n    const result = [];\r\n    Object.keys(enums).forEach(eID => {\r\n        const en = enums[eID];\r\n        if (en.common.members.includes(id) && !result.includes(eID)) {\r\n            result.push(eID);\r\n        }\r\n    });\r\n    return result;\r\n}\r\n\r\nconst LEVEL_PADDING = 16;\r\n\r\nconst styles = theme => ({\r\n    noGutters: {\r\n        paddingTop: 0,\r\n        paddingBottom: 0,\r\n        paddingLeft: 0,\r\n        width: '100%'\r\n    },\r\n    itemIconFolder: {\r\n        cursor: 'pointer'\r\n    },\r\n    width100: {\r\n        width: '100%',\r\n    },\r\n    itemIcon: {\r\n        width: 32,\r\n        height: 32,\r\n        marginRight: 4,\r\n    },\r\n    itemIconRoot: {\r\n        minWidth: 24,\r\n    },\r\n    listItemSubTitle: {\r\n        fontSize: 'smaller',\r\n        opacity: 0.7,\r\n        fontStyle: 'italic'\r\n    },\r\n    adapterIcon: {\r\n        width: 20,\r\n        height: 20,\r\n        borderRadius: 2,\r\n    },\r\n    mainList: {\r\n        width: 'calc(100% - ' + theme.spacing(1) + 'px)',\r\n        marginLeft: theme.spacing(1),\r\n    },\r\n});\r\n\r\nclass ChartsTree extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        let chartsOpened;\r\n        try {\r\n            chartsOpened = JSON.parse(window.localStorage.getItem('App.echarts.opened')) || {};\r\n        } catch (e) {\r\n            chartsOpened = {};\r\n        }\r\n\r\n        this.state = {\r\n            instances: [], // chart folders\r\n            chartsOpened\r\n        };\r\n\r\n        this.adapterPromises = {};\r\n\r\n        this.getAllEnums()\r\n            .then(newState => this.getAllCharts(newState))\r\n            .then(newState => this.setState(newState, () =>\r\n                this.props.selectedId && this.props.onSelectedChanged(this.props.selectedId)));\r\n    }\r\n\r\n    getAllEnums(newState) {\r\n        newState = newState || {};\r\n        return this.props.socket.getEnums()\r\n            .then(enums => {\r\n                newState.enums = [];\r\n                Object.keys(enums).forEach(id => {\r\n                    if ((id.startsWith('enum.functions.') || id.startsWith('enum.rooms.')) && enums[id] && enums[id].common && enums[id].common.members && enums[id].common.members.length)  {\r\n                        newState.enums[id] = {\r\n                            common: {\r\n                                members: [...enums[id].common.members],\r\n                                name: Utils.getObjectNameFromObj(enums[id], null, {language: I18n.getLanguage()}),\r\n                            }\r\n                        };\r\n                    }\r\n                });\r\n                return newState;\r\n            })\r\n            .catch(e => this.onError(e, `Cannot read enums`));\r\n    }\r\n\r\n    getAdapterIcon(groupId, id) {\r\n        const p = id.split('.');\r\n\r\n        if (p.length < 2 || (p[0] === '0_userdata')) {\r\n            return Promise.resolve();\r\n        } else {\r\n            let instanceId;\r\n            if (p[0] === 'system') {\r\n                p.splice(4);\r\n                instanceId = p.join('.')\r\n            } else {\r\n                p.splice(2);\r\n                instanceId = 'system.adapter.' + p.join('.')\r\n            }\r\n\r\n            this.adapterPromises[instanceId] = this.adapterPromises[instanceId] || this.props.socket.getObject(instanceId);\r\n\r\n            return this.adapterPromises[instanceId]\r\n                .then(obj => {\r\n                    if (obj && obj.common && obj.common.icon) {\r\n                        return Promise.resolve({groupId, id, img: Utils.getObjectIcon(obj)});\r\n                    } else {\r\n                        return Promise.resolve();\r\n                    }\r\n                })\r\n                .catch(e => this.onError(e, `Cannot read object ${instanceId}`));\r\n        }\r\n    }\r\n\r\n    onError(e, comment) {\r\n        comment && console.error(comment);\r\n        this.props.onShowError(e);\r\n    }\r\n\r\n    getChartIcon(groupId, obj) {\r\n        if (!obj) {\r\n            return Promise.resolve();\r\n        } else\r\n        if (obj.common && obj.common.icon) {\r\n            return Promise.resolve({groupId, id: obj._id, img: Utils.getObjectIcon(obj)});\r\n        } else {\r\n            // try to read parent\r\n            const id = obj._id;\r\n            const channelID = Utils.getParentId(obj._id);\r\n            if (channelID && channelID.split('.').length > 2) {\r\n                return this.props.socket.getObject(channelID)\r\n                    .then(obj => {\r\n                        if (obj && (obj.type === 'channel' || obj.type === 'device') && obj.common && obj.common.icon) {\r\n                            return Promise.resolve({groupId, id, img: Utils.getObjectIcon(obj)});\r\n                        } else {\r\n                            const deviceID = Utils.getParentId(channelID);\r\n                            if (deviceID && deviceID.split('.').length > 2) {\r\n                                return this.props.socket.getObject(deviceID)\r\n                                    .then(obj => {\r\n                                        if (obj && (obj.type === 'channel' || obj.type === 'device') && obj.common && obj.common.icon) {\r\n                                            return Promise.resolve({\r\n                                                groupId,\r\n                                                id,\r\n                                                img: Utils.getObjectIcon(obj)\r\n                                            });\r\n                                        } else {\r\n                                            const adapterID = Utils.getParentId(deviceID);\r\n                                            if (adapterID && adapterID.split('.').length > 2) {\r\n                                                return this.props.socket.getObject(adapterID)\r\n                                                    .then(obj => {\r\n                                                        if (obj && (obj.type === 'channel' || obj.type === 'device') && obj.common && obj.common.icon) {\r\n                                                            return Promise.resolve({\r\n                                                                groupId,\r\n                                                                id,\r\n                                                                img: Utils.getObjectIcon(obj)\r\n                                                            });\r\n                                                        } else {\r\n                                                            // get Adapter Icon\r\n                                                            if (obj && (obj.type === 'channel' || obj.type === 'device') && obj.common && obj.common.icon) {\r\n                                                                return Promise.resolve({\r\n                                                                    groupId,\r\n                                                                    id,\r\n                                                                    img: Utils.getObjectIcon(obj)\r\n                                                                });\r\n                                                            } else {\r\n                                                                return this.getAdapterIcon(groupId, id);\r\n                                                            }\r\n                                                        }\r\n                                                    })\r\n                                                    .catch(e => this.onError(e, `Cannot read object ${adapterID}`));\r\n                                            } else {\r\n                                                return this.getAdapterIcon(groupId, id);\r\n                                            }\r\n                                        }\r\n                                    })\r\n                                    .catch(e => this.onError(e, `Cannot read object ${deviceID}`));\r\n                            } else {\r\n                                return this.getAdapterIcon(groupId, id);\r\n                            }\r\n                        }\r\n                    })\r\n                    .catch(e => this.onError(e, `Cannot read object ${channelID}`));\r\n            } else {\r\n                return this.getAdapterIcon(groupId, id);\r\n            }\r\n        }\r\n    }\r\n\r\n    getAllCharts(newState) {\r\n        newState = newState || {};\r\n        return new Promise(resolve =>\r\n            this.props.socket._socket.emit('getObjectView', 'custom', 'state', {}, (err, objs) => {\r\n                // console.log(objs);\r\n                const ids = ((objs && objs.rows) || []).map(item => item.id);\r\n                this.getObjects(ids, objs => {\r\n                    const ids = this.props.instances.map(obj => obj._id.substring('system.adapter.'.length));\r\n                    const _instances = {};\r\n                    newState.enums = newState.enums || this.state.enums;\r\n                    const iconPromises = [];\r\n                    Object.values(objs).forEach(obj => {\r\n                        const id = obj && obj.common && obj.common.custom && ids.find(id => Object.keys(obj.common.custom).includes(id));\r\n                        if (id) {\r\n                            const instanceObj = this.props.instances.find(obj => obj._id.endsWith(id));\r\n                            _instances[id] = _instances[id] || {_id: 'system.adapter.' + id, enabledDP: {}, names: {}, statesEnums: {}, icon: instanceObj.common.icon, name: instanceObj.common.name || '', types: {}, icons: {}};\r\n                            _instances[id].enabledDP[obj._id] = obj;\r\n                            _instances[id].names[obj._id] = Utils.getObjectNameFromObj(obj, null, {language: I18n.getLanguage()});\r\n                            _instances[id].types[obj._id] = obj.common.type === 'boolean' ? 'boolean' : 'number';\r\n                            _instances[id].statesEnums[obj._id] = getEnumsForId(newState.enums, obj._id);\r\n                            iconPromises.push(this.getChartIcon(id, obj));\r\n                        }\r\n                    });\r\n\r\n                    let chartsOpened = JSON.parse(JSON.stringify(this.state.chartsOpened));\r\n                    const funcIds = Object.keys(newState.enums).filter(id => id.startsWith('enum.functions.'));\r\n                    const roomIds = Object.keys(newState.enums).filter(id => id.startsWith('enum.rooms.'));\r\n\r\n                    const insts = Object.values(_instances).map(obj => {\r\n                        const enabledDP = {};\r\n                        Object.keys(obj.enabledDP).forEach(id => {\r\n                            enabledDP[id] = obj.enabledDP[id];\r\n                            enabledDP[id].group = obj._id;\r\n                        });\r\n                        obj.enabledDP = enabledDP;\r\n                        chartsOpened[obj._id] = chartsOpened[obj._id] !== undefined ? (this.state.chartsOpened[obj._id] || false) : true;\r\n\r\n                        // Build for every instance the list of enums\r\n                        Object.keys(newState.enums).forEach(eID => {\r\n                            if (Object.keys(enabledDP).find(id => newState.enums[eID].common.members.includes(id))) {\r\n                                obj.enums = obj.enums || [];\r\n                                if (!obj.enums.includes(eID)) {\r\n                                    obj.enums.push(eID);\r\n                                }\r\n                            }\r\n                        });\r\n\r\n                        // Collect all enum-loss IDs in enum\r\n                        const otherFuncs = {common: {members: [], name: I18n.t('Others')}};\r\n                        const otherRooms = {common: {members: [], name: I18n.t('Others')}};\r\n                        Object.keys(enabledDP).forEach(id => {\r\n                            if (!funcIds.find(eID => newState.enums[eID].common.members.includes(id))) {\r\n                                otherFuncs.common.members.push(id);\r\n                            }\r\n                            if (!roomIds.find(eID => newState.enums[eID].common.members.includes(id))) {\r\n                                otherRooms.common.members.push(id);\r\n                            }\r\n                        });\r\n                        if (otherFuncs.common.members.length) {\r\n                            obj.enums = obj.enums || [];\r\n                            obj.enums.push('enum.functions.' + obj._id);\r\n                            newState.enums['enum.functions.' + obj._id] = otherFuncs;\r\n                        }\r\n                        if (otherRooms.common.members.length) {\r\n                            obj.enums = obj.enums || [];\r\n                            obj.enums.push('enum.rooms.' + obj._id);\r\n                            newState.enums['enum.rooms.' + obj._id] = otherRooms;\r\n                        }\r\n\r\n                        obj.enums && obj.enums.sort((a, b) => newState.enums[a].common.name > newState.enums[b].common.name ? 1 : (newState.enums[a].common.name < newState.enums[b].common.name ? -1 : 0));\r\n\r\n                        return obj;\r\n                    });\r\n\r\n                    insts.sort(sortObj);\r\n\r\n                    if (!this.props.selectedId) {\r\n                        // find first chart\r\n                        let selectedChartId = Object.keys(insts).length && Object.keys(insts[0].enabledDP).length ? Object.keys(insts[0].enabledDP)[0] : null;\r\n                        if (selectedChartId) {\r\n                            setTimeout(() => this.props.onSelectedChanged({id: selectedChartId, instance: insts[0]._id}), 500);\r\n                        }\r\n                    }\r\n                    newState.instances = insts;\r\n                    newState.chartsOpened = chartsOpened;\r\n\r\n                    // update icons asynchronous\r\n                    setTimeout(() => {\r\n                        Promise.all(iconPromises)\r\n                            .then(result => {\r\n                                const instances = JSON.parse(JSON.stringify(this.state.instances));\r\n                                let changed = false;\r\n                                result.forEach(res => {\r\n                                    if (res && res.groupId) {\r\n                                        const inst = instances.find(ins => ins._id === 'system.adapter.' + res.groupId);\r\n                                        if (inst) {\r\n                                            inst.icons[res.id] = res.img;\r\n                                            changed = true;\r\n                                        }\r\n                                    }\r\n                                });\r\n                                changed && this.setState({instances});\r\n                            });\r\n                    }, 100);\r\n\r\n                    resolve(newState);\r\n                });\r\n            }));\r\n    }\r\n\r\n    getObjects(ids, cb, result) {\r\n        result = result || {};\r\n        if (!ids || !ids.length) {\r\n            cb(result);\r\n        } else {\r\n            const id = ids.shift();\r\n            this.props.socket.getObject(id)\r\n                .catch(e => {\r\n                    console.error('Cannot read ' + id + ': ' + e);\r\n                    return null;\r\n                })\r\n                .then(obj => {\r\n                    if (obj) {\r\n                        result[id] = obj;\r\n                    }\r\n                    setTimeout(() => this.getObjects(ids, cb, result), 0);\r\n                });\r\n        }\r\n    }\r\n\r\n    getNewPresetName(prefix) {\r\n        let index = prefix ? '' : '1';\r\n        prefix = prefix || 'preset_';\r\n\r\n        while(!this.isNameUnique(prefix + index)) {\r\n            if (!index) {\r\n                index = 2;\r\n            } else {\r\n                index++;\r\n            }\r\n        }\r\n\r\n        return prefix + index;\r\n    };\r\n\r\n    toggleChartFolder = id => {\r\n        const chartsOpened = JSON.parse(JSON.stringify(this.state.chartsOpened));\r\n        chartsOpened[id] = !chartsOpened[id];\r\n        window.localStorage.setItem('App.echarts.opened', JSON.stringify(chartsOpened));\r\n        const newState = {chartsOpened};\r\n\r\n        let loadChart = null;\r\n\r\n        if (!chartsOpened[id]) {\r\n            const instance = id.split('///')[0];\r\n            if (this.props.selectedId && typeof this.props.selectedId === 'object' && this.props.selectedId.instance === instance) {\r\n                // TODO: Take next nearest opened chart folder\r\n            }\r\n        }\r\n\r\n        this.setState(newState, () => this.props.onSelectedChanged(loadChart));\r\n    };\r\n\r\n    renderSelectIdDialog() {\r\n        if (!this.state.showAddStateDialog) {\r\n            return null;\r\n        } else {\r\n            return <DialogSelectID\r\n                key={'selectDialog_add'}\r\n                socket={ this.props.socket }\r\n                dialogName={'Add'}\r\n                type={'state'}\r\n                title={ I18n.t('Enable logging for state')}\r\n                onOk={id => {\r\n                    console.log('Selected ' + id);\r\n                    const instance = this.state.showAddStateDialog.replace('system.adapter.', '');\r\n                    if (id) {\r\n                        this.props.socket.getObject(id)\r\n                            .then(obj => {\r\n                                if (!obj || !obj.common) {\r\n                                    return this.props.onShowError(I18n.t('Invalid object'));\r\n                                }\r\n                                if (obj.common.custom && obj.common.custom[instance]) {\r\n                                    return this.props.onShowToast(I18n.t('Already enabled'));\r\n                                } else {\r\n                                    obj.common.custom = obj.common.custom || {};\r\n                                    obj.common.custom[instance] = {\r\n                                        enabled: true,\r\n                                    };\r\n                                    this.props.socket.setObject(id, obj)\r\n                                        .then(() => {\r\n                                            const instances = JSON.parse(JSON.stringify(this.state.instances));\r\n                                            const inst = instances.find(item => item._id === 'system.adapter.' + instance);\r\n                                            inst.enabledDP = inst.enabledDP || {};\r\n                                            inst.enabledDP[obj._id] = obj;\r\n                                            this.setState({instances});\r\n                                        })\r\n                                        .catch(e => this.onError(e, `Cannot read object ${id}`));\r\n                                }\r\n                            })\r\n                            .catch(e => this.onError(e, `Cannot read object ${id}`));\r\n                    }\r\n                    this.setState({showAddStateDialog: false});\r\n                } }\r\n                onClose={ () => this.setState({showAddStateDialog: false}) }\r\n            />;\r\n        }\r\n    }\r\n\r\n    renderListItem(group, id, dragging, level) {\r\n        level = level || 0;\r\n        const instance = group._id;\r\n        return <ListItem\r\n            key={instance + '_' + id}\r\n            classes={ {gutters: this.props.classes.noGutters} }\r\n            button\r\n            style={{paddingLeft: LEVEL_PADDING * level}}\r\n            selected={\r\n                this.props.selectedId &&\r\n                typeof this.props.selectedId === 'object' &&\r\n                this.props.selectedId.id === id &&\r\n                this.props.selectedId.instance === instance\r\n            }\r\n            onClick={dragging ? undefined : () => this.props.onSelectedChanged({id, instance})}\r\n        >\r\n            <ListItemIcon classes={{root: this.props.classes.itemIconRoot}}>\r\n                {group.types[id] === 'boolean' ?\r\n                    <IconBooleanChart className={this.props.classes.itemIcon}/>\r\n                    :\r\n                    <IconChart className={this.props.classes.itemIcon}/>\r\n                }\r\n            </ListItemIcon>\r\n            <ListItemText\r\n                classes={{\r\n                    primary: this.props.classes.listItemTitle,\r\n                    secondary: this.props.classes.listItemSubTitle\r\n                }}\r\n                primary={\r\n                    <span>\r\n                        {Utils.getIcon({icon: group.icons[id], prefix: '../../'}, {width: 20, height: 20, borderRadius: 2})}\r\n                        {group.names[id]}\r\n                    </span>\r\n                }\r\n                secondary={id.replace('system.adapter.', '')}\r\n            />\r\n            {!dragging && this.props.multiple && this.props.chartsList ? <ListItemSecondaryAction>\r\n                <Switch\r\n                    edge=\"end\"\r\n                    onChange={e => {\r\n                        const chartsList = JSON.parse(JSON.stringify(this.props.chartsList));\r\n                        const item = chartsList.find(item => item.id === id && item.instance === instance);\r\n                        if (e.target.checked && !item) {\r\n                            chartsList.push({id, instance});\r\n                            chartsList.sort((a, b) => {\r\n                                if (a.instance > b.instance) {\r\n                                    return 1;\r\n                                } else if (a.instance < b.instance) {\r\n                                    return -1;\r\n                                } else {\r\n                                    if (a.id > b.id) {\r\n                                        return 1;\r\n                                    } else if (a.id < b.id) {\r\n                                        return -1;\r\n                                    } else {\r\n                                        return 0;\r\n                                    }\r\n                                }\r\n                            });\r\n                            // if no charts selected => select this one\r\n                            if (typeof this.props.selectedId !== 'object') {\r\n                                this.props.onSelectedChanged({id, instance}, () =>\r\n                                    this.props.onChangeList(chartsList));\r\n                            } else {\r\n                                this.props.onChangeList(chartsList);\r\n                            }\r\n                        } else if (!e.target.checked && item) {\r\n                            chartsList.splice(chartsList.indexOf(item), 1);\r\n                            this.props.onChangeList(chartsList);\r\n                        }\r\n                    }}\r\n                    checked={!!this.props.chartsList.find(item => item.id === id && item.instance === instance)}\r\n                /> </ListItemSecondaryAction>: null}\r\n        </ListItem>\r\n    }\r\n\r\n    renderListItems(group, ids, enumId, renderContext) {\r\n        renderContext.gIndex = renderContext.gIndex || 0;\r\n\r\n        if (!ids || !ids.length) {\r\n            return null;\r\n        }\r\n        const instance = group._id;\r\n\r\n        const level = 1;\r\n\r\n        if (!enumId) {\r\n            return ids.map(id=>\r\n                <Draggable\r\n                    isDragDisabled={!this.props.selectedId || typeof this.props.selectedId === 'object'}\r\n                    key={instance + '_' + id}\r\n                    draggableId={instance + '***' + id}\r\n                    index={renderContext.gIndex++}>\r\n                    {(provided, snapshot) =>\r\n                        [\r\n                            <div\r\n                                key={instance + '_' + id + '_item'}\r\n                                ref={provided.innerRef}\r\n                                {...provided.draggableProps}\r\n                                {...provided.dragHandleProps}\r\n                                style={provided.draggableProps.style}\r\n                                className=\"drag-items\"\r\n                            >\r\n                                {this.renderListItem(group, id, false, level)}\r\n                            </div>,\r\n                            snapshot.isDragging ?\r\n                                <div className=\"react-beatiful-dnd-copy\" key={instance + '_' + id + '_dnd'}>\r\n                                    {this.renderListItem(group, id, true)}\r\n                                </div>: null\r\n                        ]\r\n                    }\r\n                </Draggable>\r\n            );\r\n        }  else {\r\n            const key = instance + '///' + enumId;\r\n            const opened = this.state.chartsOpened[key];\r\n            if (opened) {\r\n                ids = ids.filter(id => this.state.enums[enumId].common.members.includes(id));\r\n            }\r\n            return [\r\n                <ListItem\r\n                    key={key}\r\n                    style={{paddingLeft: LEVEL_PADDING * level}}\r\n                    classes={ {gutters: this.props.classes.noGutters} }\r\n                    className={ clsx(this.props.classes.width100, this.props.classes.folderItem) }\r\n                >\r\n                    <ListItemIcon classes={ {root: this.props.classes.itemIconRoot} } onClick={ () => this.toggleChartFolder(key) }>{ opened ?\r\n                        <IconFolderOpened className={ clsx(this.props.classes.itemIcon, this.props.classes.itemIconFolder) }/> :\r\n                        <IconFolderClosed className={ clsx(this.props.classes.itemIcon, this.props.classes.itemIconFolder) }/>\r\n                    }</ListItemIcon>\r\n                    <ListItemText primary={this.state.enums[enumId].common.name}/>\r\n                    <ListItemSecondaryAction>\r\n                        <IconButton onClick={ () => this.toggleChartFolder(key) } title={ opened ? I18n.t('Collapse') : I18n.t('Expand')  }>\r\n                            { opened ? <IconCollapse/> : <IconExpand/> }\r\n                        </IconButton>\r\n                    </ListItemSecondaryAction>\r\n                </ListItem>,\r\n                opened ? <List key={key + '_LIST'}>\r\n                    {ids.map(id=>\r\n                        <Draggable\r\n                            isDragDisabled={!this.props.selectedId || typeof this.props.selectedId === 'object'}\r\n                            key={instance + '_' + id}\r\n                            draggableId={instance + '***' + id}\r\n                            index={renderContext.gIndex++}>\r\n                            {(provided, snapshot) =>\r\n                                [\r\n                                    <div\r\n                                        key={instance + '_' + id + '_item'}\r\n                                        ref={provided.innerRef}\r\n                                        {...provided.draggableProps}\r\n                                        {...provided.dragHandleProps}\r\n                                        style={provided.draggableProps.style}\r\n                                        className=\"drag-items\"\r\n                                    >\r\n                                        {this.renderListItem(group, id, false, 2)}\r\n                                    </div>,\r\n                                    snapshot.isDragging ?\r\n                                        <div className=\"react-beatiful-dnd-copy\" key={instance + '_' + id + '_dnd'}>\r\n                                            {this.renderListItem(group, id, true)}\r\n                                        </div>: null\r\n                                ]\r\n                            }\r\n                        </Draggable>\r\n                    )}\r\n                </List> : null\r\n            ]\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const renderContext = {gIndex: 0};\r\n        return [\r\n            this.renderSelectIdDialog(),\r\n            <Droppable droppableId=\"Lines\" isDropDisabled={true} key=\"charts\">\r\n                {(provided, snapshot) =>\r\n                    <div ref={provided.innerRef} key=\"chartListDiv\">\r\n                        <List className={ clsx(this.props.classes.scroll, this.props.classes.mainList) } key=\"chartList\">\r\n                            {\r\n                                this.state.instances.map(group => {\r\n                                    let opened = this.state.chartsOpened[group._id];\r\n                                    let children = null;\r\n\r\n                                    // if instance opened\r\n                                    if (opened) {\r\n                                        // no groupBy\r\n                                        const ids = Object.keys(group.enabledDP)\r\n                                            .filter(id => !this.props.search || id.includes(this.props.search) || group.names[id].includes(this.props.search));\r\n\r\n                                        if (!this.props.groupBy) {\r\n                                            ids.sort(sortObj);\r\n                                            children = this.renderListItems(group, ids, null, renderContext);\r\n                                        } else {\r\n                                            children = (group.enums || []).filter(id => id.startsWith('enum.' + this.props.groupBy + '.'))\r\n                                                .map(eID =>\r\n                                                    this.renderListItems(group, ids, eID, renderContext));\r\n                                        }\r\n                                    }\r\n\r\n                                    return [\r\n                                        <ListItem\r\n                                            key={group._id}\r\n                                            classes={ {gutters: this.props.classes.noGutters} }\r\n                                            className={ clsx(this.props.classes.width100, this.props.classes.folderItem) }\r\n                                        >\r\n                                            <ListItemIcon classes={ {root: this.props.classes.itemIconRoot} } onClick={ () => this.toggleChartFolder(group._id) }>\r\n                                                { opened ?\r\n                                                    <IconFolderOpened className={ clsx(this.props.classes.itemIcon, this.props.classes.itemIconFolder) }/> :\r\n                                                    <IconFolderClosed className={ clsx(this.props.classes.itemIcon, this.props.classes.itemIconFolder) }/>\r\n                                                }\r\n                                            </ListItemIcon>\r\n                                            <ListItemText primary={\r\n                                                <span>\r\n                                                    <img className={ this.props.classes.adapterIcon } alt=\"\" src={`../../adapter/${group.name}/${group.icon}`}/>\r\n                                                    {group._id.replace('system.adapter.', '')}\r\n                                                </span>\r\n                                            }/>\r\n                                                <ListItemSecondaryAction>\r\n                                                {opened ? <IconButton\r\n                                                        onClick={() => this.setState({showAddStateDialog: group._id})}\r\n                                                        title={ I18n.t('Enable logging for new state') }\r\n                                                    ><IconAdd/></IconButton> : null}\r\n                                                <IconButton onClick={ () => this.toggleChartFolder(group._id) } title={ opened ? I18n.t('Collapse') : I18n.t('Expand')  }>\r\n                                                    { opened ? <IconCollapse/> : <IconExpand/> }\r\n                                                </IconButton>\r\n                                            </ListItemSecondaryAction>\r\n                                        </ListItem>,\r\n                                        children\r\n                                    ];\r\n                                }\r\n                            )}\r\n                            {provided.placeholder}\r\n                        </List>\r\n                    </div> }\r\n            </Droppable>\r\n        ];\r\n    }\r\n}\r\n\r\nChartsTree.propTypes = {\r\n    socket: PropTypes.object,\r\n    instances: PropTypes.array,\r\n    adapterName: PropTypes.string.isRequired,\r\n    onShowToast: PropTypes.func,\r\n    onShowError: PropTypes.func,\r\n    onChangeList: PropTypes.func,\r\n    chartsList: PropTypes.array,\r\n    theme: PropTypes.object,\r\n    multiple: PropTypes.bool,\r\n    search: PropTypes.string,\r\n    groupBy: PropTypes.string,\r\n    selectedId: PropTypes.oneOfType([\r\n        PropTypes.object,\r\n        PropTypes.string\r\n    ]),\r\n    onSelectedChanged: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default withWidth()(withStyles(styles)(withTheme(ChartsTree)));\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport withWidth from '@material-ui/core/withWidth';\r\nimport {withStyles, withTheme} from '@material-ui/core/styles';\r\n\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport FormGroup from '@material-ui/core/FormGroup';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormControl from '@material-ui/core/FormControl';\r\n// icons\r\nimport {MdAdd as IconAdd} from 'react-icons/md';\r\nimport {MdCreateNewFolder as IconFolderAdd} from 'react-icons/md';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport ClearIcon from '@material-ui/icons/Close';\r\nimport {MdFullscreen as IconNewWindow} from 'react-icons/md';\r\nimport {MdSwapVert as IconReorder} from 'react-icons/md';\r\n\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\nimport PresetsTree from './Components/PresetsTree';\r\nimport ChartsTree from './Components/ChartsTree';\r\n\r\n\r\nconst TOOLBAR_HEIGHT = 48;\r\n\r\nconst styles = theme => ({\r\n    mainListDiv: {\r\n        width: '100%',\r\n        height: '100%',\r\n        overflow: 'hidden',\r\n    },\r\n    mainToolbar: {\r\n        background: theme.palette.primary.main,\r\n    },\r\n    secondaryColors: {\r\n        background: '#888',\r\n        color: theme.palette.type === 'dark' ? '#000' : '#FFF',\r\n    },\r\n    smallMargin: {\r\n        marginTop: '8px !important',\r\n    },\r\n    heightMinusToolbar: {\r\n        height: 'calc(100% - ' + (TOOLBAR_HEIGHT * 2) + 'px)',\r\n        overflow: 'auto'\r\n    },\r\n});\r\n\r\nclass MenuList extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            search: null,\r\n            multiple: window.localStorage.getItem('App.echarts.multiple') === 'true',\r\n            showSearch: null,\r\n            groupBy: window.localStorage.getItem('App.echarts.groupBy') || '',\r\n            addPresetFolderDialog: false,\r\n            reorder: false,\r\n            showReorder: false,\r\n        };\r\n\r\n        try {\r\n            this.isIFrame = window.self !== window.top;\r\n        } catch (e) {\r\n            this.isIFrame = true;\r\n        }\r\n\r\n        if (this.state.multiple) {\r\n            let chartList = window.localStorage.getItem('App.echarts.chartList') || '[]';\r\n            try {\r\n                chartList = JSON.parse(chartList);\r\n            } catch (e) {\r\n                chartList = [];\r\n            }\r\n            setTimeout(() => this.props.onChangeList(chartList), 100);\r\n        }\r\n    }\r\n\r\n    renderListToolbar() {\r\n        return <Toolbar key=\"toolbar\" variant=\"dense\" className={ this.props.classes.mainToolbar }>\r\n            {!this.state.reorder ? <IconButton\r\n                onClick={ () => this.props.onCreatePreset(false) }\r\n                title={ I18n.t('Create new preset') }\r\n            ><IconAdd/></IconButton> : null}\r\n\r\n            {!this.state.reorder ? <IconButton\r\n                onClick={ () => this.setState({addPresetFolderDialog: true}) }\r\n                title={ I18n.t('Create new folder') }\r\n            ><IconFolderAdd/></IconButton> : null}\r\n\r\n            {!this.state.reorder ? <span className={this.props.classes.right}>\r\n                <IconButton onClick={() => this.setState({showSearch: !this.state.showSearch, search: ''})}>\r\n                    <SearchIcon/>\r\n                </IconButton>\r\n            </span> : null}\r\n\r\n            {this.state.showSearch ?\r\n                <TextField\r\n                    value={ this.state.search }\r\n                    className={ this.props.classes.textInput }\r\n                    onChange={ e => this.setState({search: e.target.value}) }\r\n                    InputProps={{\r\n                        endAdornment: this.state.search ?\r\n                            <IconButton\r\n                                onClick={() => this.setState({ search: '' })}>\r\n                                <ClearIcon />\r\n                            </IconButton>\r\n                            : undefined,\r\n                    }}\r\n                /> : null\r\n            }\r\n            <div style={{flexGrow: 1}}/>\r\n\r\n            {(!this.state.showSearch && this.state.showReorder) || this.state.reorder ? <IconButton\r\n                key=\"reorder\"\r\n                title={I18n.t('Reorder presets in folders')}\r\n                className={this.props.classes.toolbarButtons}\r\n                style={{color: this.state.reorder ? 'red' : 'inherit', float: 'right'}}\r\n                onClick={e => {\r\n                    e.stopPropagation();\r\n                    this.setState({reorder: !this.state.reorder});\r\n                }}\r\n            ><IconReorder/></IconButton> : null }\r\n\r\n            {!this.state.showSearch && this.isIFrame ? <IconButton\r\n                onClick={ () => window.open(window.location.href, 'own-echarts') }\r\n                title={ I18n.t('Open in own window') }\r\n                ><IconNewWindow/></IconButton> : null\r\n            }\r\n        </Toolbar>;\r\n    }\r\n\r\n    renderFooter() {\r\n        return <Toolbar key=\"toolbarBottom\" variant=\"dense\" className={ this.props.classes.secondaryColors }>\r\n            <FormGroup row>\r\n                {!this.props.selectedPresetChanged ? <FormControlLabel\r\n                    classes={{root: this.props.secondaryColors}}\r\n                    control={<Switch\r\n                        checked={this.state.multiple}\r\n                        classes={{root: this.props.secondaryColors}}\r\n                        onChange={e => {\r\n                        window.localStorage.setItem('App.echarts.multiple', e.target.checked ? 'true' : 'false');\r\n                        if (e.target.checked) {\r\n                            const selectedId = this.props.selectedId;\r\n                            if (selectedId && typeof selectedId === 'object') {\r\n                                this.setState({multiple: true}, () => this.props.onChangeList([JSON.parse(JSON.stringify(selectedId))]));\r\n                            } else {\r\n                                this.setState({multiple: true}, () => this.props.onChangeList([]));\r\n                            }\r\n                        } else {\r\n                            this.setState({multiple: false}, () => this.props.onChangeList(null));\r\n                        }\r\n                    }} />}\r\n                    label={I18n.t('Multiple')}\r\n                /> : null}\r\n                <FormControl>\r\n                    <InputLabel shrink={true} style={{whiteSpace: 'nowrap'}}>{I18n.t('Group by') }</InputLabel>\r\n                    <Select\r\n                        label={I18n.t('Group by')}\r\n                        onChange={e => {\r\n                            window.localStorage.setItem('App.echarts.groupBy', e.target.value);\r\n                            this.setState({groupBy: e.target.value});\r\n                        }}\r\n                        value={this.state.groupBy || ''}\r\n                        className={this.props.classes.smallMargin}\r\n                        displayEmpty\r\n                    >\r\n                        <MenuItem value=\"\">{I18n.t('None')}</MenuItem>\r\n                        <MenuItem value=\"rooms\">{I18n.t('Rooms')}</MenuItem>\r\n                        <MenuItem value=\"functions\">{I18n.t('Functions')}</MenuItem>\r\n                    </Select>\r\n                </FormControl>\r\n            </FormGroup>\r\n        </Toolbar>;\r\n    }\r\n\r\n    render() {\r\n        return <div className={this.props.classes.mainListDiv} key=\"mainMenuDiv\">\r\n            {this.renderListToolbar()}\r\n            <div className={ this.props.classes.heightMinusToolbar }>\r\n                <PresetsTree\r\n                    socket={this.props.socket}\r\n                    addPresetFolderDialog={this.state.addPresetFolderDialog}\r\n                    onClosePresetFolderDialog={cb => this.setState({addPresetFolderDialog: false}, cb)}\r\n                    onCreatePreset={(isFromCurrentSelection, parent) => this.props.onCreatePreset(isFromCurrentSelection, parent)}\r\n                    onCopyPreset={id => this.props.onCopyPreset(id)}\r\n                    adapterName={this.props.adapterName}\r\n                    selectedPresetChanged={this.props.selectedPresetChanged}\r\n                    onShowToast={toast => this.props.onShowToast(toast)}\r\n                    onShowError={toast => this.props.onShowToast(toast)}\r\n                    onShowReorder={showReorder => {\r\n                        if (showReorder !== this.props.showReorder) {\r\n                            this.setState({showReorder});\r\n                        }\r\n                    }}\r\n                    search={this.state.search}\r\n                    reorder={this.state.reorder}\r\n                    selectedId={this.props.selectedId}\r\n                    systemConfig={this.props.systemConfig}\r\n                    onSelectedChanged={(selectedId, cb) => this.props.onSelectedChanged(selectedId, cb)}\r\n                />\r\n                {!this.state.reorder ?\r\n                    <ChartsTree\r\n                        socket={this.props.socket}\r\n                        instances={this.props.instances}\r\n                        adapterName={this.props.adapterName}\r\n                        onShowToast={toast => this.props.onShowToast(toast)}\r\n                        onShowError={toast => this.props.onShowToast(toast)}\r\n                        search={this.state.search}\r\n                        multiple={this.state.multiple && !this.props.selectedPresetChanged}\r\n                        theme={this.props.theme}\r\n                        groupBy={this.state.groupBy}\r\n                        selectedId={this.props.selectedId}\r\n                        onChangeList={chartList => {\r\n                            window.localStorage.setItem('App.echarts.chartList', JSON.stringify(chartList));\r\n                            this.props.onChangeList(chartList);\r\n                        }}\r\n                        chartsList={this.props.chartsList}\r\n                        onSelectedChanged={(selectedId, cb) => this.props.onSelectedChanged(selectedId, cb)}\r\n                    /> : null }\r\n            </div>\r\n            {!this.state.reorder ? this.renderFooter() : null}\r\n        </div>;\r\n    }\r\n}\r\n\r\nMenuList.propTypes = {\r\n    onChange: PropTypes.func,\r\n    socket: PropTypes.object,\r\n    instances: PropTypes.array,\r\n    adapterName: PropTypes.string.isRequired,\r\n    theme: PropTypes.object,\r\n    onSelectedChanged: PropTypes.func.isRequired,\r\n    onShowToast: PropTypes.func.isRequired,\r\n    systemConfig: PropTypes.object,\r\n    onChangeList: PropTypes.func,\r\n    chartsList: PropTypes.array,\r\n    onCreatePreset: PropTypes.func,\r\n    onCopyPreset: PropTypes.func,\r\n    selectedId: PropTypes.oneOfType([\r\n        PropTypes.object,\r\n        PropTypes.string\r\n    ]),\r\n    selectedPresetChanged: PropTypes.bool,\r\n};\r\n\r\nexport default withWidth()(withStyles(styles)(withTheme(MenuList)));\r\n","import React from 'react';\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport { withTheme } from '@material-ui/core/styles';\r\nimport withWidth from '@material-ui/core/withWidth';\r\nimport clsx from 'clsx';\r\nimport SplitterLayout from 'react-splitter-layout';\r\nimport { MuiThemeProvider } from '@material-ui/core/styles';\r\nimport { DragDropContext} from \"react-beautiful-dnd\";\r\n\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Button from '@material-ui/core/Button';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\n\r\n// icons\r\nimport {MdClose as IconCancel} from 'react-icons/md';\r\nimport {MdSave as IconSave} from 'react-icons/md';\r\nimport {MdMenu as IconMenuClosed} from 'react-icons/md';\r\nimport {MdArrowBack as IconMenuOpened} from 'react-icons/md';\r\n\r\nimport 'react-splitter-layout/lib/index.css';\r\n\r\nimport GenericApp from '@iobroker/adapter-react/GenericApp';\r\nimport Loader from '@iobroker/adapter-react/Components/Loader'\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\nimport '@iobroker/adapter-react/index.css';\r\nimport Utils from '@iobroker/adapter-react/Components/Utils';\r\n\r\nimport SettingsEditor from './SettingsEditor';\r\nimport MainChart from './MainChart';\r\nimport getUrlQuery from './utils/getUrlQuery';\r\nimport DefaultPreset from './Components/DefaultPreset';\r\nimport MenuList from './MenuList';\r\nimport flotConverter from './utils/flotConverter';\r\n\r\nconst styles = theme => ({\r\n    root: {\r\n        flexGrow: 1,\r\n        display: 'flex',\r\n        width: '100%',\r\n        height: '100%',\r\n        background: theme.palette.background.default,\r\n        color: theme.palette.text.primary,\r\n        fontFamily: '\"Roboto\", \"Helvetica\", \"Arial\", sans-serif',\r\n    },\r\n    menuDiv: {\r\n        overflow: 'hidden',\r\n    },\r\n    splitterDivs: {\r\n        '&>div': {\r\n            overflow: 'hidden',\r\n            width: '100%',\r\n            height: '100%',\r\n        },\r\n        '& .layout-splitter': {\r\n            background: theme.type === 'dark' ? '#595858' : '#ccc;'\r\n        }\r\n    },\r\n    content: {\r\n        width: '100%',\r\n        height: '100%',\r\n        backgroundColor: theme.palette.background.default,\r\n        position: 'relative'\r\n    },\r\n    menuDivWithoutMenu: {\r\n        '&>div:first-child': {\r\n            display: 'none'\r\n        },\r\n        '&>.layout-splitter': {\r\n            display: 'none'\r\n        },\r\n    },\r\n    progress: {\r\n        margin: 100\r\n    },\r\n    menuOpenCloseButton: {\r\n        position: 'absolute',\r\n        left: 0,\r\n        borderRadius: '0 5px 5px 0',\r\n        top: 6,\r\n        paddingTop: 8,\r\n        cursor: 'pointer',\r\n        zIndex: 1,\r\n        height: 25,\r\n        width: 20,\r\n        background: theme.palette.secondary.main,\r\n        color: theme.palette.primary.main,\r\n        paddingLeft: 3,\r\n        '&:hover': {\r\n            color: 'white'\r\n        }\r\n    },\r\n    buttonsContainer: {\r\n        '& button': {\r\n            whiteSpace: 'nowrap'\r\n        }\r\n    },\r\n    buttonIcon: {\r\n        marginRight: theme.spacing(0.5),\r\n    },\r\n});\r\n\r\nconst FORBIDDEN_CHARS = /[.\\][*,;'\"`<>\\\\?]/g;\r\n\r\nfunction loadChartParam(name, defaultValue) {\r\n    return window.localStorage.getItem('App.echarts.__' + name) ? window.localStorage.getItem('App.echarts.__' + name) : defaultValue;\r\n}\r\n\r\nclass App extends GenericApp {\r\n    constructor(props) {\r\n        let settings = {socket: {}};\r\n        const query = getUrlQuery();\r\n        settings.socket.port = query.port || (parseInt(window.location.port) >= 3000 && parseInt(window.location.port) <= 3020 ? 8081 : window.location.port);\r\n        settings.socket.host = query.host || window.location.hostname;\r\n        settings.translations = {\r\n            'en': require('./i18n/en'),\r\n            'de': require('./i18n/de'),\r\n            'es': require('./i18n/es'),\r\n            'fr': require('./i18n/fr'),\r\n            'it': require('./i18n/it'),\r\n            'nl': require('./i18n/nl'),\r\n            'pl': require('./i18n/pl'),\r\n            'pt': require('./i18n/pt'),\r\n            'ru': require('./i18n/ru'),\r\n            'zh-cn': require('./i18n/zh-cn'),\r\n        };\r\n        super(props, settings);\r\n    }\r\n\r\n    onConnectionReady() {\r\n        let selectedId = window.localStorage.getItem('App.echarts.selectedId') || null;\r\n        if (selectedId) {\r\n            try {\r\n                selectedId = JSON.parse(selectedId)\r\n            } catch (e) {\r\n                selectedId = null;\r\n            }\r\n        }\r\n\r\n        const newState = {\r\n            ready: false,\r\n            instances: [],\r\n\r\n            selectedId,\r\n            selectedPresetChanged: false,\r\n            presetData: null,\r\n            originalPresetData: null,\r\n            chartsList: null,\r\n            addPresetDialog: null,\r\n            progress: 0,\r\n            autoSave: window.localStorage.getItem('App.echarts.autoSave') === 'true',\r\n\r\n            discardChangesConfirmDialog: false,\r\n\r\n            resizing: false,\r\n            menuOpened: window.localStorage.getItem('App.echarts.menuOpened') !== 'false',\r\n            menuSelectId: '',\r\n            logHorzLayout: window.localStorage.getItem('App.echarts.logHorzLayout') === 'true',\r\n        };\r\n\r\n        this.settingsSize = window.localStorage ? parseFloat(window.localStorage.getItem('App.echarts.settingsSize')) || 150 : 150;\r\n        this.menuSize = window.localStorage ? parseFloat(window.localStorage.getItem('App.echarts.menuSize')) || 500 : 500;\r\n\r\n        this.objects = {};\r\n\r\n        this.socket.getSystemConfig()\r\n            .then(systemConfig => {\r\n                newState.systemConfig = systemConfig;\r\n                newState.presetData = DefaultPreset.getDefaultPreset(systemConfig);\r\n                this.setState(newState);\r\n                return flotConverter(this.socket, this.instance);\r\n            })\r\n            .then(() => this.socket.getAdapterInstances(''))\r\n            // get only history adapters\r\n            .then(instances => instances.filter(entry => entry && entry.common && entry.common.getHistory && entry.common.enabled))\r\n            .then(instances => this.setState({ready: true, instances}))\r\n            .catch(e => this.onError(e, 'Cannot read system config'));\r\n    }\r\n\r\n    getNewPresetName(parentId, prefix, index) {\r\n        index  = index  || (prefix ? '' : '1');\r\n        prefix = prefix || 'preset_';\r\n\r\n        return this.socket.getObject(`${this.adapterName}.${this.instance}.${parentId ? parentId + '.' : ''}${prefix}${index}`)\r\n            .then(obj => {\r\n                if (!obj) {\r\n                    return prefix + index;\r\n                } else {\r\n                    if (!index) {\r\n                        index = 2;\r\n                    } else {\r\n                        index++;\r\n                    }\r\n                    return this.getNewPresetName(parentId, prefix, index);\r\n                }\r\n            })\r\n            .catch(e => prefix + index);\r\n    }\r\n\r\n    getUniqueId(id, name, cb, _count) {\r\n        _count = _count || 0;\r\n        const newId = id + '_' + I18n.t('copy');\r\n        const newName = name + ' ' + I18n.t('copy');\r\n        this.socket.getObject(newId)\r\n            .then(obj => {\r\n                if (obj) {\r\n                    setTimeout(() => this.getUniqueId(newId, newName, cb, _count + 1));\r\n                } else {\r\n                    cb(null, newId, newName);\r\n                }\r\n            })\r\n            .catch(e => {\r\n                if (_count > 10) {\r\n                    cb(I18n.t('Cannot create unique ID'));\r\n                } else {\r\n                    setTimeout(() => this.getUniqueId(newId, newName, cb, _count + 1));\r\n                }\r\n            })\r\n    }\r\n\r\n    onCopyPreset = presetId => {\r\n        this.socket.getObject(presetId)\r\n            .then(obj => {\r\n                this.getUniqueId(presetId, obj.common.name, (err, newId, newName) => {\r\n                    obj._id = newId;\r\n                    obj.common.name = newName;\r\n                    this.socket.setObject(newId, obj)\r\n                        .then(() => this.loadChartOrPreset(newId))\r\n                        .catch(e => this.onError(e, 'Cannot save object'));\r\n                });\r\n            })\r\n            .catch(e => this.onError(e, 'Cannot read object'));\r\n    };\r\n\r\n    onCreatePreset = (isFromCurrentSelection, parentId) => {\r\n        if (isFromCurrentSelection === true) {\r\n            let name;\r\n\r\n            const chartsList = JSON.parse(JSON.stringify(this.state.chartsList || []));\r\n            if (!chartsList.find(item => item.id === this.state.selectedId.id && item.instance === this.state.selectedId.instance)) {\r\n                chartsList.push(this.state.selectedId);\r\n            }\r\n\r\n            // Todo> Detect if all ids are from one enum\r\n\r\n            // create from list selectedId\r\n            return new Promise(resolve => {\r\n                if (chartsList.length === 1) {\r\n                    return this.socket.getObject(chartsList[0].id)\r\n                        .then(obj => resolve(obj));\r\n                } else {\r\n                    resolve(null);\r\n                }\r\n            })\r\n                .then(obj => {\r\n                    if (obj) {\r\n                        name = (obj && obj.common && obj.common.name ? Utils.getObjectNameFromObj(obj, null, {language: I18n.getLanguage()}) : '').trim();\r\n                    }\r\n\r\n                    return this.getNewPresetName(parentId, name)\r\n                        .then(name => {\r\n                            let template = {\r\n                                common: {\r\n                                    name,\r\n                                    expert: true,\r\n                                },\r\n                                native: {\r\n                                    data: JSON.parse(JSON.stringify(this.state.presetData))\r\n                                },\r\n                                type: 'chart'\r\n                            };\r\n                            let id = `${this.adapterName}.0.${parentId ? parentId + '.' : ''}${name.replace(FORBIDDEN_CHARS, '_')}`;\r\n\r\n                            return this.socket.setObject(id, template)\r\n                                .then(() => this.loadChartOrPreset(id))\r\n                                .catch(e => this.onError(e, 'Cannot save object'));\r\n                        });\r\n                })\r\n                .catch(e => this.onError(e, 'Cannot read object'));\r\n\r\n        } else {\r\n            // create empty preset\r\n            return this.getNewPresetName(parentId)\r\n                .then(name => {\r\n                    let template = {\r\n                        common: {\r\n                            name,\r\n                        },\r\n                        native: {\r\n                            url: '',\r\n                            data: DefaultPreset.getDefaultPreset(this.state.systemConfig, null, null, I18n.getLanguage()),\r\n                        },\r\n                        type: 'chart'\r\n                    };\r\n\r\n                    let id = `${this.adapterName}.0.${parentId ? parentId + '.' : ''}${name.replace(FORBIDDEN_CHARS, '_')}`;\r\n\r\n                    return this.socket.setObject(id, template)\r\n                        .then(() => this.loadChartOrPreset(id))\r\n                        .catch(e => this.onError(e, 'Cannot save object'));\r\n                })\r\n                .catch(e => this.showError(e));\r\n        }\r\n    };\r\n\r\n    onError(e, comment) {\r\n        comment && console.error(comment);\r\n        this.showError(e);\r\n    }\r\n\r\n    savePreset = () => {\r\n        if (!this.state.presetData) {\r\n            this.showError(I18n.t('Empty preset cannot be saved!'));\r\n            return Promise.reject();\r\n        } else {\r\n            return this.socket.getObject(this.state.selectedId)\r\n                .then(obj => {\r\n                    if (!obj || !obj.native) {\r\n                        return this.showError(I18n.t('Invalid object'));\r\n                    } else {\r\n                        obj.native.data = this.state.presetData;\r\n                        return this.socket.setObject(obj._id, obj)\r\n                            .then(() => this.setState({originalPresetData: JSON.stringify(this.state.presetData), selectedPresetChanged: false}))\r\n                            .catch(e => this.onError(e, 'Cannot save object'));\r\n                    }\r\n                })\r\n                .catch(e => this.onError(e, 'Cannot read object'));\r\n        }\r\n    };\r\n\r\n    loadChartOrPreset(selectedId, cb) {\r\n        window.localStorage.setItem('App.echarts.selectedId', JSON.stringify(selectedId));\r\n\r\n        if (selectedId && typeof selectedId === 'object') {\r\n            // load chart\r\n            const promises = [];\r\n            if (this.state.chartsList) {\r\n                this.state.chartsList.forEach(item => !this.objects[item.id] && promises.push(this.socket.getObject(item.id)));\r\n                !this.objects[selectedId.id] && !this.state.chartsList.find(item => item.id === selectedId.id) && promises.push(this.socket.getObject(selectedId.id));\r\n            } else {\r\n                this.objects = {};\r\n                promises.push(this.socket.getObject(selectedId.id));\r\n            }\r\n\r\n            return Promise.all(promises)\r\n                .then(results => {\r\n                    results.forEach(obj => obj && (this.objects[obj._id] = obj));\r\n\r\n                    const lines = (this.state.chartsList || []).map(item => DefaultPreset.getDefaultLine(this.state.systemConfig, item.instance, this.objects[item.id], I18n.getLanguage()));\r\n\r\n                    (!this.state.chartsList || !this.state.chartsList.find(item => item.id === selectedId.id && item.instance === selectedId.instance)) &&\r\n                        lines.push(DefaultPreset.getDefaultLine(this.state.systemConfig, selectedId.instance, this.objects[selectedId.id], I18n.getLanguage()));\r\n\r\n                    // combine same units together: e.g. if line1 and line2 are in percent => use same yAxis\r\n                    if (lines.length > 1) {\r\n                        // Find first non empty\r\n                        // ignore all booleans\r\n                        const first = lines.find(item => !item.isBoolean);\r\n                        if (first) {\r\n                            const iFirst = lines.indexOf(first);\r\n                            // set it to left\r\n                            first.yaxe = 'left';\r\n                            // find all lines with the same unit and place them to left\r\n                            if (first.unit) {\r\n                                for (let k = iFirst + 1; k < lines.length; k++) {\r\n                                    if (lines[k].unit === first.unit) {\r\n                                        lines[k].commonYAxis = iFirst;\r\n                                    }\r\n                                }\r\n                            }\r\n                            for (let k = iFirst + 1; k < lines.length; k++) {\r\n                                if (lines[k].unit && lines[k].unit !== first.unit) {\r\n                                    lines[k].yaxe = 'right';\r\n                                    // combine all following lines to one axis\r\n                                    for (let j = k + 1; j < lines.length; j++) {\r\n                                        if (lines[k].unit === lines[j].unit && lines[j].commonYAxis === undefined) {\r\n                                            lines[k].commonYAxis = j;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    let presetData = {\r\n                        marks:          [],\r\n                        lines:          lines,\r\n                        zoom:           true,\r\n                        hoverDetail:    true,\r\n                        aggregate:      loadChartParam('aggregate', 'minmax'),\r\n                        chartType:      loadChartParam('chartType', 'auto'),\r\n                        live:           loadChartParam('live', '30'),\r\n                        timeType:       loadChartParam('timeType', 'relative'),\r\n                        aggregateType:  loadChartParam('aggregateType', 'step'),\r\n                        aggregateSpan:  loadChartParam('aggregateSpan', 300),\r\n                        ticks:          loadChartParam('ticks', ''),\r\n                        range:          loadChartParam('range', 1440),\r\n                        relativeEnd:    loadChartParam('relativeEnd', 'now'),\r\n                        start:          loadChartParam('start', ''),\r\n                        end:            loadChartParam('end', ''),\r\n                        start_time:     loadChartParam('start_time', ''),\r\n                        end_time:       loadChartParam('end_time', ''),\r\n                        noBorder:       'noborder',\r\n                        noedit:         false,\r\n                        animation:      0,\r\n                        legend:         lines.length > 1 ? 'nw' : ''\r\n                    };\r\n\r\n                    this.setState({\r\n                        presetData,\r\n                        originalPresetData: '',\r\n                        selectedPresetChanged: false,\r\n                        selectedId: selectedId,\r\n                    }, () => cb && cb());\r\n                })\r\n                .catch(e => this.onError(e, 'Cannot read object'));\r\n        } else if (selectedId) {\r\n            // load preset\r\n            return this.socket.getObject(selectedId)\r\n                .then(obj => {\r\n                    if (obj && obj.native && obj.native.data) {\r\n\r\n                        const newState = {\r\n                            presetData: obj.native.data,\r\n                            originalPresetData: JSON.stringify(obj.native.data),\r\n                            selectedPresetChanged: false,\r\n                            selectedId,\r\n                        };\r\n\r\n                        this.setState(newState, () => cb && cb());\r\n                    } else {\r\n                        cb && cb();\r\n                    }\r\n                })\r\n                .catch(e => this.onError(e, 'Cannot read object'));\r\n        } else {\r\n            this.setState({\r\n                presetData: null,\r\n                originalPresetData: '',\r\n                selectedPresetChanged: false,\r\n                selectedId: null,\r\n            }, () => cb && cb());\r\n        }\r\n    }\r\n\r\n    discardChangesConfirmDialog() {\r\n        return this.state.discardChangesConfirmDialog ? <Dialog\r\n            maxWidth=\"lg\"\r\n            fullWidth={true}\r\n            open={ true }\r\n            key=\"discardChangesConfirmDialog\"\r\n            onClose={ () => this.setState({discardChangesConfirmDialog: false}, () => this.confirmCB && this.confirmCB(false)) }>\r\n                <DialogTitle>{\r\n                    this.state.discardChangesConfirmDialog === 'chart' ? I18n.t('Are you sure for loading the chart and discard unsaved changes?')\r\n                    : (this.state.discardChangesConfirmDialog === 'preset' ? I18n.t('Are you sure for loading the preset and discard unsaved changes?') :\r\n                        I18n.t('Are you sure for closing folder and discard unsaved changes?'))\r\n                }</DialogTitle>\r\n                <DialogActions className={ clsx(this.props.classes.alignRight, this.props.classes.buttonsContainer) }>\r\n                    <Button variant=\"contained\" onClick={() =>\r\n                        this.setState({discardChangesConfirmDialog: false}, () => this.confirmCB && this.confirmCB(false))}>\r\n                        <IconCancel className={ this.props.classes.buttonIcon }/>\r\n                        { I18n.t('Cancel') }\r\n                    </Button>\r\n                    <Button variant=\"contained\" color=\"secondary\" onClick={() => {\r\n                        this.savePreset()\r\n                            .then(() => this.setState({discardChangesConfirmDialog: false}, () => this.confirmCB && this.confirmCB(true)));\r\n                    }}>\r\n                        <IconSave className={ this.props.classes.buttonIcon }/>\r\n                        { I18n.t('Save current preset and load') }\r\n                    </Button>\r\n                    <Button variant=\"contained\" onClick={() =>\r\n                        this.setState({discardChangesConfirmDialog: false}, () => this.confirmCB && this.confirmCB(true))}>\r\n                        { I18n.t('Load without save') }\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog> : null;\r\n    };\r\n\r\n    renderMain() {\r\n        const {classes} = this.props;\r\n        return [\r\n            <div className={clsx(classes.content, 'iobVerticalSplitter')} key=\"confirmdialog\">\r\n                <div key=\"confirmdiv\" className={classes.menuOpenCloseButton} onClick={() => {\r\n                    window.localStorage && window.localStorage.setItem('App.echarts.menuOpened', this.state.menuOpened ? 'false' : 'true');\r\n                    this.setState({menuOpened: !this.state.menuOpened, resizing: true});\r\n                    setTimeout(() => this.setState({resizing: false}), 300);\r\n                }}>\r\n                    {this.state.menuOpened ? <IconMenuOpened /> : <IconMenuClosed />}\r\n                </div>\r\n                <SplitterLayout\r\n                    key=\"MainSplitter\"\r\n                    vertical={!this.state.logHorzLayout}\r\n                    primaryMinSize={100}\r\n                    secondaryInitialSize={this.settingsSize}\r\n                    //customClassName={classes.menuDiv + ' ' + classes.splitterDivWithoutMenu}\r\n                    onDragStart={() => this.setState({resizing: true})}\r\n                    onSecondaryPaneSizeChange={size => this.settingsSize = parseFloat(size)}\r\n                    onDragEnd={() => {\r\n                        this.setState({resizing: false});\r\n                        window.localStorage && window.localStorage.setItem('App.echarts.settingsSize', this.settingsSize.toString());\r\n                    }}\r\n                >\r\n                    { this.state.selectedId ? <MainChart\r\n                        key=\"MainChart\"\r\n                        visible={!this.state.resizing}\r\n                        theme={this.state.theme}\r\n                        onChange={presetData => this.setState({presetData})}\r\n                        presetData={this.state.presetData}\r\n                        selectedId={this.state.selectedId}\r\n                        chartsList={this.state.chartsList}\r\n                        onCreatePreset={this.onCreatePreset}\r\n                        onCopyPreset={this.onCopyPreset}\r\n                    /> : null}\r\n                    {\r\n                        this.state.presetData && this.state.selectedId && typeof this.state.selectedId === 'string' ? <SettingsEditor\r\n                            socket={this.socket}\r\n                            key=\"Editor\"\r\n                            width={window.innerWidth - this.menuSize}\r\n                            theme={this.state.theme}\r\n                            onChange={presetData => {\r\n                                if (this.state.autoSave) {\r\n                                    this.setState({presetData}, () => this.savePreset());\r\n                                } else {\r\n                                    this.setState({presetData, selectedPresetChanged: JSON.stringify(presetData) !== this.state.originalPresetData});\r\n                                }\r\n                            }}\r\n                            presetData={this.state.presetData}\r\n                            selectedId={this.state.selectedId}\r\n                            verticalLayout={!this.state.logHorzLayout}\r\n                            onLayoutChange={() => this.toggleLogLayout()}\r\n                            connection={this.socket}\r\n                            instances={this.state.instances}\r\n                            systemConfig={this.state.systemConfig}\r\n                            selectedPresetChanged={this.state.selectedPresetChanged}\r\n                            savePreset={this.savePreset}\r\n                            autoSave={this.state.autoSave}\r\n                            onAutoSave={autoSave => {\r\n                                window.localStorage.setItem('App.echarts.autoSave', autoSave ? 'true' : 'false');\r\n                                if (autoSave && this.state.selectedPresetChanged) {\r\n                                    this.savePreset()\r\n                                        .then(() => this.setState({autoSave}));\r\n                                } else {\r\n                                    this.setState({autoSave});\r\n                                }\r\n\r\n                            }}\r\n                        /> : null\r\n                    }\r\n                </SplitterLayout>\r\n            </div>\r\n        ];\r\n    }\r\n\r\n    onDragEnd = result => {\r\n        const { source, destination, draggableId } = result;\r\n        if (destination && draggableId.includes('***') && source.droppableId === 'Lines') {\r\n            const [instance, stateId] = draggableId.split('***');\r\n            this.socket.getObject(stateId)\r\n                .then(obj => {\r\n                    //const len = this.state.presetData.lines.length;\r\n                    //const color = (obj && obj.common && obj.common.color) || PREDEFINED_COLORS[len % PREDEFINED_COLORS.length];\r\n                    const presetData = JSON.parse(JSON.stringify(this.state.presetData));\r\n                    const newLine = DefaultPreset.getDefaultLine(this.state.systemConfig, instance, obj, I18n.getLanguage());\r\n                    if (!destination) {\r\n                        presetData.lines.push(newLine);\r\n                    } else {\r\n                        presetData.lines.splice(destination.index, 0, newLine);\r\n                    }\r\n                    if (presetData.lines.length > 1) {\r\n                        // combine new unit with existing one\r\n                        if (newLine.unit) {\r\n                            for (let i = 0; i < presetData.lines.length; i++) {\r\n                                if (newLine !== presetData.lines[i] && presetData.lines[i].unit === newLine.unit) {\r\n                                    newLine.commonYAxis = i;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    this.setState({presetData, selectedPresetChanged: JSON.stringify(presetData) !== this.state.originalPresetData});\r\n                })\r\n                .catch(e => this.onError(e, 'Cannot read object'));\r\n\r\n        } else if (destination && source.droppableId === destination.droppableId) {\r\n            const presetData = JSON.parse(JSON.stringify(this.state.presetData));\r\n            const [removed] = presetData.lines.splice(source.index, 1);\r\n            presetData.lines.splice(destination.index, 0, removed);\r\n            this.setState({presetData, selectedPresetChanged: JSON.stringify(presetData) !== this.state.originalPresetData});\r\n        }\r\n    };\r\n\r\n    toggleLogLayout() {\r\n        window.localStorage && window.localStorage.setItem('App.echarts.logHorzLayout', this.state.logHorzLayout ? 'false' : 'true');\r\n        this.setState({logHorzLayout: !this.state.logHorzLayout});\r\n    }\r\n\r\n    render() {\r\n        const {classes} = this.props;\r\n\r\n        if (!this.state.ready) {\r\n            return <MuiThemeProvider theme={this.state.theme}>\r\n                <Loader theme={this.state.themeType}/>\r\n            </MuiThemeProvider>;\r\n        }\r\n\r\n        return <MuiThemeProvider theme={this.state.theme}>\r\n            <React.Fragment>\r\n                <div className={classes.root} key=\"divSide\">\r\n                    <DragDropContext onDragEnd={this.onDragEnd}>\r\n                        <SplitterLayout\r\n                            key=\"sidemenuwidth\"\r\n                            vertical={false}\r\n                            primaryMinSize={300}\r\n                            primaryIndex={1}\r\n                            secondaryMinSize={300}\r\n                            secondaryInitialSize={this.menuSize}\r\n                            customClassName={classes.splitterDivs + ' ' + (!this.state.menuOpened ? classes.menuDivWithoutMenu : '')}\r\n                            onDragStart={() => this.setState({resizing: true})}\r\n                            onSecondaryPaneSizeChange={size => this.menuSize = parseFloat(size)}\r\n                            onDragEnd={() => {\r\n                                this.setState({resizing: false});\r\n                                window.localStorage && window.localStorage.setItem('App.echarts.menuSize', this.menuSize.toString());\r\n                            }}\r\n                        >\r\n                            <MenuList\r\n                                key=\"menuList\"\r\n                                socket={this.socket}\r\n                                theme={this.state.theme}\r\n                                adapterName={this.adapterName}\r\n                                instances={this.state.instances}\r\n                                systemConfig={this.state.systemConfig}\r\n                                onShowToast={toast => this.showToast(toast)}\r\n                                selectedPresetChanged={this.state.selectedPresetChanged}\r\n                                chartsList={this.state.chartsList}\r\n                                selectedId={this.state.selectedId}\r\n                                onCopyPreset={this.onCopyPreset}\r\n                                onCreatePreset={this.onCreatePreset}\r\n                                onChangeList={(chartsList, cb) => {\r\n                                    // if some deselected\r\n                                    let selectedId = this.state.selectedId;\r\n                                    if (chartsList && this.state.chartsList && chartsList.length && chartsList.length < this.state.chartsList.length) {\r\n                                        const removedLine = this.state.chartsList.find(item => !chartsList.find(it => it.id === item.id && it.instance === item.instance));\r\n                                        const index = this.state.chartsList.indexOf(removedLine);\r\n                                        if (this.state.chartsList[index + 1]) {\r\n                                            selectedId = this.state.chartsList[index + 1];\r\n                                        } else if (this.state.chartsList[index - 1]) {\r\n                                            selectedId = this.state.chartsList[index - 1];\r\n                                        } else {\r\n                                            selectedId = chartsList[0];\r\n                                        }\r\n                                    }\r\n                                    this.setState({chartsList}, () => this.loadChartOrPreset(selectedId, cb));\r\n                                }}\r\n                                onSelectedChanged={(selectedId, cb) => {\r\n                                    if (cb && this.state.selectedPresetChanged) {\r\n                                        this.confirmCB = confirmed => {\r\n                                            if (confirmed) {\r\n                                                this.loadChartOrPreset(selectedId, () => cb && cb(selectedId));\r\n                                            } else {\r\n                                                cb(false); // cancel\r\n                                            }\r\n                                            this.confirmCB = null;\r\n                                        };\r\n\r\n                                        this.setState({discardChangesConfirmDialog: selectedId && typeof selectedId === 'object' ? 'chart' : (selectedId ? 'preset' : 'folder')});\r\n                                    } else {\r\n                                        this.loadChartOrPreset(selectedId, () => cb && cb(selectedId));\r\n                                    }\r\n                                }}\r\n                            />\r\n                            {this.renderMain()}\r\n                        </SplitterLayout>\r\n                    </DragDropContext>\r\n                </div>\r\n                { this.discardChangesConfirmDialog() }\r\n                { this.renderError() }\r\n                { this.renderToast() }\r\n            </React.Fragment>\r\n        </MuiThemeProvider>;\r\n    }\r\n}\r\n\r\nexport default withWidth()(withStyles(styles)(withTheme(App)));\r\n","export default function getUrlQuery() {\r\n    const parts = (window.location.search || '').replace(/^\\?/, '').split('&');\r\n    const query = {};\r\n    parts.forEach(item => {\r\n        const [name, val] = item.split('=');\r\n        query[decodeURIComponent(name)] = val !== undefined ? decodeURIComponent(val) : true;\r\n    });\r\n    return query;\r\n}","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read http://bit.ly/CRA-PWA.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { MuiThemeProvider} from '@material-ui/core/styles';\r\nimport * as Sentry from '@sentry/browser';\r\nimport * as SentryIntegrations from '@sentry/integrations';\r\n\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { version } from '../package.json';\r\nimport theme from '@iobroker/adapter-react/Theme';\r\nimport Utils from '@iobroker/adapter-react/Components/Utils';\r\n\r\nwindow.adapterName = 'echarts';\r\nlet themeName = Utils.getThemeName();\r\n\r\nconsole.log('iobroker.' + window.adapterName + '@' + version + ' using theme \"' + themeName + '\"');\r\n\r\nfunction build() {\r\n    return ReactDOM.render(\r\n        <MuiThemeProvider theme={theme(themeName)}>\r\n            <App\r\n                onThemeChange={_theme => {\r\n                    themeName = _theme;\r\n                    build();\r\n                }}\r\n            />\r\n        </MuiThemeProvider>,\r\n        document.getElementById('root')\r\n    );\r\n}\r\n\r\n// if not local development\r\nif (window.location.host !== 'localhost:3000') {\r\n    Sentry.init({\r\n        dsn: 'https://709f116e1de34029921e4f2696d6740f@sentry.iobroker.net/88',\r\n        release: 'iobroker.' + window.adapterName + '@' + version,\r\n        integrations: [new SentryIntegrations.Dedupe()],\r\n        beforeSend: function (event, hint) {\r\n            let ignore = false;\r\n\r\n            // ignore some errors\r\n            if (event.exception &&\r\n                event.exception.values &&\r\n                event.exception.values[0] && event.exception.values[0].value) {\r\n                if (event.exception.values[0].value.includes('ioBroker is not connected')) {\r\n                    ignore = true;\r\n                }\r\n            }\r\n\r\n            return ignore ? null : event;\r\n        },\r\n    });\r\n}\r\n\r\nbuild();\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}