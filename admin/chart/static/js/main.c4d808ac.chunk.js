(this["webpackJsonpecharts.index"]=this["webpackJsonpecharts.index"]||[]).push([[0],{251:function(e){e.exports=JSON.parse('{"a":"0.3.8"}')},413:function(e,t,a){"use strict";(function(e){var o=a(74),i=a(75);function n(e){e=(e||"").toString().replace(/^\?/,"");var t={};return e.split("&").forEach((function(e){if(e=e.trim()){var a=e.split("="),o=decodeURIComponent(a[0]).trim();if(a.length>1)if(t[o]=decodeURIComponent(a[1]),"true"===t[o])t[o]=!0;else if("false"===t[o])t[o]=!1;else{var i=parseFloat(t[o]);i.toString()===t[o]&&(t[o]=i)}else t[o]=!0}})),t}function s(e){if(e.lines&&(e.l=e.lines,delete e.lines),e._ids){var t=e._ids?e._ids.split(";"):[],a=e._colors?e._colors.split(";"):[],o=e._names?e._names.split(";"):[],i=e._units?e._units.split(";"):[];e.l=[];for(var n=0;n<t.length;n++)e.l.push({id:t[n],offset:0,name:o[n]||"",aggregate:"onchange",color:a[n]||"blue",thickness:e.strokeWidth||1,shadowsize:e.strokeWidth||1,min:e.min||"",max:e.max||"",unit:i[n]||""});e.aggregateType="step",e.aggregateSpan=300,e.relativeEnd="now"}if(e.l)for(var s=0;s<e.l.length;s++)e.l[s].art&&(e.l[s].aggregate=e.l[s].art,delete e.l[s].art),e.instance&&!e.l[s].instance&&(e.l[s].instance=e.instance),e.l[s].yOffset=parseFloat(e.l[s].yOffset)||0,e.l[s].offset=parseFloat(e.l[s].offset)||0,e.l[s].validTime=parseFloat(e.l[s].validTime)||0;if(e.l=e.l||[],e.m){e.marks=[];for(var r=0;r<e.m.length;r++)e.marks[r]={lineId:e.m[r].l,upperValueOrId:e.m[r].v,lowerValueOrId:e.m[r].vl,color:e.m[r].c,fill:e.m[r].f,ol:e.m[r].t,os:e.m[r].s,text:e.m[r].d,textPosition:e.m[r].p,textOffset:e.m[r].py,textColor:e.m[r].fc,textSize:e.m[r].fs};delete e.m}return e.marks=e.marks||[],e.l.length||e.l.push({id:"",unit:""}),e.width=e.width||"100%",e.height=e.height||"100%",e.timeFormat=e.timeFormat||"",e.useComma="true"===e.useComma||!0===e.useComma,e.zoom="true"===e.zoom||!0===e.zoom,e.export="true"===e.export||!0===e.export,e.grid_hideX="true"===e.grid_hideX||!0===e.grid_hideX,e.grid_hideY="true"===e.grid_hideY||!0===e.grid_hideY,e.hoverDetail="true"===e.hoverDetail||!0===e.hoverDetail,e.noLoader="true"===e.noLoader||!0===e.noLoader,e.noedit="true"===e.noedit||!0===e.noedit,e.animation=parseInt(e.animation)||0,e.afterComma=void 0===e.afterComma?2:parseInt(e.afterComma,10),e.timeType=e.timeType||"relative",e}var r=function(){function e(t,a,i){var n=this;Object(o.a)(this,e),i=Object.assign({updateTimeout:300},i||{}),this.socket=t,this.updateTimeout=i.updateTimeout||300,this.serverSide=i.serverSide||!1,this.seriesData=[],this.ticks=null,this.liveInterval=null,this.navOptions={},this.sessionId=1,this.updateInterval=null,this.presetSubscribed=!1,this.defaultHistory="",this.onUpdateFunc=null,this.onReadingFunc=null,this.onErrorFunc=null,this.objectPromises={},this.debug=!1,this.zoomData=null,this.serverSide||(this.lastHash=window.location.hash,a||(this.onHashInstalled=!0,this.onHashChangeBound=this.onHashChange.bind(this),window.addEventListener("hashchange",this.onHashChangeBound,!1)),this.onPresetUpdateBound=this.onPresetUpdate.bind(this)),this.socket.getSystemConfig().then((function(e){return n.systemConfig=e&&e.common?e.common:{},n.defaultHistory=n.systemConfig.defaultHistory,n.analyseAndLoadConfig(a)}))}return Object(i.a)(e,[{key:"analyseAndLoadConfig",value:function(e){var t=this;if(e)"string"===typeof e?this.preset=e:this.config=s(e);else{var a=n(window.location.search);if(this.debug=!0===a.debug||"true"===a.debug||1===a.debug||"1"===a.debug,a.preset&&"string"===typeof a.preset)this.preset=a.preset;else{var o=n((window.location.hash||"").toString().replace(/^#/,""));if(o.data)try{o.data=JSON.parse(o.data)}catch(r){o.data={}}if(a.data)try{a.data=JSON.parse(a.data)}catch(r){a.data={}}var i=Object.assign(a.data||{},o.data||{},!0);void 0!==o.noLoader&&(i.noLoader=!0===o.noLoader||"true"===o.noLoader||1===o.noLoader||"1"===o.noLoader),void 0!==a.noLoader&&(i.noLoader=!0===a.noLoader||"true"===a.noLoader||1===a.noLoader||"1"===a.noLoader),this.config=s(i)}}this.seriesData=[],this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.preset?((this.preset.startsWith("echarts.")||this.preset.startsWith("flot."))&&this.preset.includes(".")||(this.preset="echarts.0."+this.preset),this.socket.getObject(this.preset).then((function(e){if(!e||!e.native||!e.native.data||"chart"!==e.type)return console.error("[ChartModel] Invalid object ".concat(t.preset,": ").concat(JSON.stringify(e)));t.config=s(e.native.data),t.config.useComma=void 0===t.config.useComma?!0===t.systemConfig.isFloatComma||"true"===t.systemConfig.isFloatComma:"true"===t.config.useComma||!0===t.config.useComma,t.config.lang=t.systemConfig.language,t.config.live=parseInt(t.config.live,10)||0,t.config.debug=t.debug,t.readData(),t.serverSide||t.presetSubscribed===t.preset||(t.presetSubscribed&&t.socket.unsubscribeObject(t.presetSubscribed,t.onPresetUpdateBound),t.presetSubscribed=t.preset,t.socket.subscribeObject(t.preset,t.onPresetUpdateBound)),t.serverSide||!t.config.live||t.zoomData&&t.zoomData.stopLive||(t.updateInterval=setInterval((function(){return t.readData()}),1e3*t.config.live))}))):(this.config.useComma=void 0===this.config.useComma?!0===this.systemConfig.isFloatComma||"true"===this.systemConfig.isFloatComma:"true"===this.config.useComma||!0===this.config.useComma,this.config.lang=this.systemConfig.language,this.config.live=parseInt(this.config.live,10)||0,this.config.debug=this.debug,this.readData(),this.serverSide||!this.config.live||this.zoomData&&this.zoomData.stopLive||(this.updateInterval=setInterval((function(){return t.readData()}),1e3*this.config.live)))}},{key:"onHashChange",value:function(){this.lastHash!==window.location.hash&&(this.lastHash=window.location.hash,this.analyseAndLoadConfig())}},{key:"onPresetUpdate",value:function(e,t){var a=this;e===this.preset&&(this.presetUpdateTimeout&&clearTimeout(this.presetUpdateTimeout),this.presetUpdateTimeout=setTimeout((function(){var e;a.presetUpdateTimeout=null,e=s(t?t.native.data:{}),JSON.stringify(e)!==JSON.stringify(a.config)&&(a.config=e,a.updateInterval&&clearInterval(a.updateInterval),a.updateInterval=null,!a.config.live||a.zoomData&&a.zoomData.stopLive||(a.updateInterval=setInterval((function(){return a.readData()}),1e3*a.config.live)),a.readData())}),100))}},{key:"setNewRange",value:function(e){var t=this;if(this.debug&&console.log("[ChartModel] [".concat((new Date).toISOString(),"] setNewRange: ").concat(JSON.stringify(e))),e)if(e.stopLive)this.zoomData=this.zoomData||{},this.zoomData.stopLive=!0,this.updateInterval&&(console.log("Clear interval"),clearInterval(this.updateInterval),this.updateInterval=null);else{var a=this.zoomData&&this.zoomData.stopLive;a&&delete this.zoomData.stopLive,this.zoomData&&JSON.stringify(this.zoomData)===JSON.stringify(e)?a&&(this.zoomData.stopLive=!0):(this.zoomData=e,a&&(this.zoomData.stopLive=!0),this.readOnZoomTimeout&&clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=setTimeout((function(){t.readOnZoomTimeout=null,t.readData()}),this.updateTimeout))}else this.zoomData&&(this.zoomData=null,this.readOnZoomTimeout&&clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=setTimeout((function(){t.readOnZoomTimeout=null,!t.config.live||t.zoomData&&t.zoomData.stopLive||(console.log("Restore update"),t.updateInterval&&clearInterval(t.updateInterval),t.updateInterval=setInterval((function(){return t.readData()}),1e3*t.config.live)),t.readData()}),this.updateTimeout))}},{key:"destroy",value:function(){this.readOnZoomTimeout&&(clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=null),this.presetUpdateTimeout&&(clearTimeout(this.presetUpdateTimeout),this.presetUpdateTimeout=null),this.presetSubscribed&&(this.socket.unsubscribeObject(this.presetSubscribed,this.onPresetUpdateBound),this.presetSubscribed=null),this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.serverSide||(this.onHashInstalled&&window.removeEventListener("hashchange",this.onHashChangeBound,!1),this.onHashInstalled=!1)}},{key:"onUpdate",value:function(e){this.onUpdateFunc=e}},{key:"onReading",value:function(e){this.onReadingFunc=e}},{key:"onError",value:function(e){this.onErrorFunc=e}},{key:"getConfig",value:function(){return this.config}},{key:"getSystemConfig",value:function(){return this.systemConfig}},{key:"setConfig",value:function(e){this.analyseAndLoadConfig(e)}},{key:"getStartStop",value:function(e,t){var a,o,i,n={};if(this.config.l[e].offset=this.config.l[e].offset||0,"string"===typeof this.config.range&&this.config.range.includes("m")&&this.config.l.length>1)for(var s=parseInt(this.config.range,10)||1,r=0;r<this.config.l.length;r++)if(this.config.l[r].offset&&0!==this.config.l[r].offset){i=this.addTime(this.now,this.config.l[0].offset);var c=new Date(i);c.setMonth(c.getMonth()-s),this.config.range=Math.floor((i-c.getTime())/6e4)+"";break}if(t)return this.zoomData?(o=this.zoomData.start,a=this.zoomData.end):o=(a=this.addTime(this.now,this.config.l[e].offset))-t,n={start:o,end:a,ignoreNull:void 0===this.config.l[e].ignoreNull?this.config.ignoreNull:this.config.l[e].ignoreNull,aggregate:this.config.l[e].aggregate||this.config.aggregate||"minmax",count:1,from:!1,ack:!1,q:!1,addID:!1},this.config.start=this.addTime(a,this.config.range,!1,!0),this.config.end=a,n;if(this.zoomData)o=this.zoomData.start,a=this.zoomData.end;else if("static"===this.config.timeType){var l,h;l=void 0!==this.config.start_time?this.config.start_time.split(":").map(Number):[0,0],h=void 0!==this.config.end_time?this.config.end_time.split(":").map(Number):[24,0],o=new Date(this.config.start).setHours(l[0],l[1]),a=new Date(this.config.end).setHours(h[0],h[1]),o=this.addTime(o,this.config.l[e].offset),a=this.addTime(a,this.config.l[e].offset)}else{if(this.config.relativeEnd=this.config.relativeEnd||"now","now"===this.config.relativeEnd)i=new Date(this.now);else if(-1!==this.config.relativeEnd.indexOf("minute")){var u=parseInt(this.config.relativeEnd,10)||1;(i=new Date(this.now)).setMinutes(Math.floor(i.getMinutes()/u)*u+u),i.setSeconds(0),i.setMilliseconds(0)}else if(-1!==this.config.relativeEnd.indexOf("hour")){var d=parseInt(this.config.relativeEnd,10)||1;(i=new Date(this.now)).setHours(Math.floor(i.getHours()/d)*d+d),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0)}else"today"===this.config.relativeEnd?((i=new Date(this.now)).setDate(i.getDate()+1),i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0)):"weekUsa"===this.config.relativeEnd?((i=new Date(this.now)).setDate(i.getDate()-i.getDay()+7),i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0)):"weekEurope"===this.config.relativeEnd?(0===(i=new Date(this.now)).getDay()?i.setDate(i.getDate()+1):i.setDate(i.getDate()-i.getDay()+8),i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0)):"month"===this.config.relativeEnd?((i=new Date(this.now)).setMonth(i.getMonth()+1),i.setDate(1),i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0)):"year"===this.config.relativeEnd&&((i=new Date(this.now)).setFullYear(i.getFullYear()+1),i.setMonth(0),i.setDate(1),i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0));this.config.range=this.config.range||"30m",a=this.addTime(i,this.config.l[e].offset),o=this.addTime(a,this.config.range,!1,!0)}return n={start:o,end:a,ignoreNull:void 0===this.config.l[e].ignoreNull?this.config.ignoreNull:this.config.l[e].ignoreNull,aggregate:this.config.l[e].aggregate||this.config.aggregate||"minmax",from:!1,ack:!1,q:!1,addID:!1},"step"===this.config.aggregateType?n.step=1e3*this.config.aggregateSpan:"count"===this.config.aggregateType&&(n.count=this.config.aggregateSpan||300),this.config.start=o,this.config.end=a,n}},{key:"readOneChart",value:function(e,t,a,o){var i=this,n=this.getStartStop(a);n.instance=t,n.sessionId=this.sessionId,this.debug&&console.log("[ChartModel] "+new Date(n.start)+" - "+new Date(n.end)),this.socket.getHistoryEx(e,n).then((function(e){if(i.sessionId&&e.sessionId&&e.sessionId!==i.sessionId)return console.warn("[ChartModel] Ignore request with sessionId=".concat(e.sessionId,", actual is ").concat(i.sessionId));if(e&&e.values){n.yOffset=i.config.l[a].yOffset;var t=e.values;i.seriesData[a]=[];for(var o=i.seriesData[a],s=0;s<t.length;s++)"true"===t[s].val||!0===t[s].val?t[s].val=1:"false"!==t[s].val&&!1!==t[s].val||(t[s].val=0),"string"===typeof t[s].val&&(t[s].val=parseFloat(t[s].val)),o.push({value:[t[s].ts,null!==t[s].val?t[s].val+n.yOffset:null]});if(o.length){o[0].value[0]>n.start&&o.unshift({value:[n.start,null],exact:!1});var r=o[o.length-1];r.value[0]<n.end&&(i.config.l[a].validTime&&n.end-1e3*i.config.l[a].validTime<=r.value[0]?o.push({value:[n.end,r.value[1]],exact:!1}):o.push({value:[n.end,null],exact:!1}))}else o.push({value:[n.start,null],exact:!1}),o.push({value:[n.end,null],exact:!1});e.values=null,e=null}return Promise.resolve()})).catch((function(e){return e&&console.error("[ChartModel] "+e)})).then((function(){return o(e,a)}))}},{key:"_readObject",value:function(e){return this.objectPromises[e]||(this.objectPromises[e]=this.socket.getObject(e)),this.objectPromises[e]}},{key:"_readOneLine",value:function(e,t){var a=this;return this._readObject(this.config.l[e].id).then((function(t){return t&&t.common&&(a.config.l[e].name=a.config.l[e].name||t.common.name,a.config.l[e].unit=a.config.l[e].unit||(t.common.unit?t.common.unit.replace("\ufffd","\xb0"):""),a.config.l[e].type=t.common.type,"auto"===a.config.l[e].chartType&&(a.config.l[e].chartType="boolean"===t.common.type?"steps":"line",a.config.l[e].aggregate="boolean"===t.common.type?"onchange":"minmax")),Promise.resolve()})).catch((function(t){return console.error("[ChartModel] Cannot read object ".concat(a.config.l[e].id,": ").concat(t)),Promise.resolve()})).then((function(){a.config.l[e].name=a.config.l[e].name||a.config.l[e].id,a.config.l[e].unit=a.config.l[e].unit||"","auto"===a.config.l[e].chartType&&(a.config.l[e].chartType="line",a.config.l[e].aggregate="minmax"),"object"===typeof a.config.l[e].name&&(a.config.l[e].name=a.config.l[e].name[a.systemConfig.language]||a.config.l[e].name.en),a.readOneChart(a.config.l[e].id,a.config.l[e].instance||a.defaultHistory,e,t)}))}},{key:"_readData",value:function(e,t){var a=this;if((t=t||0)>=this.config.l.length)return e();""!==this.config.l[t]&&void 0!==this.config.l[t]&&this.seriesData.push([]),this._readOneLine(t,(function(){return setTimeout((function(){return a._readData(e,t+1)}),10)}))}},{key:"readTicks",value:function(e){var t=this;if(this.config.ticks){var a=JSON.parse(JSON.stringify(this.getStartStop(0)));a.instance=this.config.l[0].instance||this.defaultHistory,a.sessionId=this.sessionId,a.aggregate="onchange",this.debug&&console.log("[ChartModel] Ticks: "+new Date(a.start)+" - "+new Date(a.end)),this.socket.getHistoryEx(this.config.ticks,a).then((function(e){if(t.sessionId&&e.sessionId&&e.sessionId!==t.sessionId)return console.warn("[ChartModel] Ignore request with sessionId=".concat(e.sessionId,", actual is ").concat(t.sessionId));if(e&&e.values){var o=t.ticks||[];t.ticks&&t.ticks.length&&t.ticks.splice(0,t.ticks.length);for(var i=e.values,n=0;n<i.length;n++)null!==i[n].val&&o.push({value:[i[n].ts,i[n].val]});o.length?(o[0][0]>a.start&&o.unshift({value:[a.start,""]}),o[o.length-1][0]<a.end&&o.push({value:[a.end,""]})):(o.push({value:[a.start,""]}),o.push({value:[a.end,""]})),e.values=null,e=null,t.ticks=o}return Promise.resolve()})).catch((function(e){return console.error("[ChartModel] ".concat(e))})).then((function(){return e&&e(t.ticks)}))}else e(null)}},{key:"readValue",value:function(e,t,a){this.socket.getState(e).then((function(e){a(t,e&&parseFloat(e.val)||0)})).catch((function(e){console.error("[ChartModel] ".concat(e)),a(t,0)}))}},{key:"readMarkings",value:function(e,t){var a=this;return t=t||0,!this.config.marks||!this.config.marks.length||t>=this.config.marks.length?e():new Promise((function(e){(a.config.marks[t].upperValueOrId||0===a.config.marks[t].upperValueOrId)&&parseFloat(a.config.marks[t].upperValueOrId).toString()!==a.config.marks[t].upperValueOrId.toString().replace(/\.0*$/,"")&&a.config.marks[t].upperValueOrId.toString().includes(".")?a.socket.getState(a.config.marks[t].upperValueOrId).then((function(o){o&&void 0!==o.val&&null!==o.val?a.config.marks[t].upperValue=parseFloat(o.val)||0:a.config.marks[t].upperValue=null,e()})):e()})).then((function(){return new Promise((function(e){(a.config.marks[t].lowerValueOrId||0===a.config.marks[t].lowerValueOrId)&&parseFloat(a.config.marks[t].lowerValueOrId).toString()!==a.config.marks[t].lowerValueOrId.replace(/\.0*$/,"")&&a.config.marks[t].lowerValueOrId.includes(".")?a.socket.getState(a.config.marks[t].lowerValueOrId).then((function(o){o&&void 0!==o.val&&null!==o.val?a.config.marks[t].lowerValue=parseFloat(o.val)||0:a.config.marks[t].lowerValue=null,e()})):e()}))})).then((function(){return setTimeout((function(){return a.readMarkings(e,t+1)}),0)}))}},{key:"addTime",value:function(e,t,a,o){return e=new Date(e),"string"===typeof t?"m"===t[1]?(t=parseInt(t,10),e.setMonth(a?e.getMonth()+t:e.getMonth()-t),e=e.getTime()):"y"===t[1]?(t=parseInt(t,10),e.setFullYear(a?e.getFullYear()+t:e.getFullYear()-t),e=e.getTime()):(e=e.getTime(),o?a?e+=6e4*(parseInt(t,10)||0):e-=6e4*(parseInt(t,10)||0):a?e+=1e3*(parseInt(t,10)||0):e-=1e3*(parseInt(t,10)||0)):(e=e.getTime(),o?a?e+=6e4*(parseInt(t,10)||0):e-=6e4*(parseInt(t,10)||0):a?e+=1e3*(parseInt(t,10)||0):e-=1e3*(parseInt(t,10)||0)),e}},{key:"readData",value:function(){var e=this;this.readOnZoomTimeout&&(clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=null),this.now=Date.now(),console.log("Read till "+new Date(this.now)),this.sessionId=this.sessionId||0,this.sessionId++,this.sessionId>16777215&&(this.sessionId=1),this.config.l?(this.onReadingFunc&&this.onReadingFunc(!0),this.seriesData=[],this._readData((function(){return e.readTicks((function(t){return e.readMarkings((function(){e.onUpdateFunc(e.seriesData)}))}))}))):(this.onErrorFunc&&this.onErrorFunc("No config provided"),this.onReadingFunc&&this.onReadingFunc(!1))}}]),e}();e.exports=r,t.a=r}).call(this,a(155)(e))},415:function(e,t,a){"use strict";(function(e){var o=a(74),i=a(75),n={azul:["#f2385a","#f5a503","#4ad9d9","#f7879c","#c1d7a8","#4dffd2","#fccfd7","#d5f6f6"],"bee-inspired":["#001727","#805500","#ffff00","#ffd11a","#f2d71f","#f2be19","#f3a81a","#fff5cc"],blue:["#1790cf","#1bb2d8","#99d2dd","#88b0bb","#1c7099","#038cc4","#75abd0","#afd6dd"],infographic:["#C1232B","#27727B","#FCCE10","#E87C25","#B5C334","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0"],vintage:["#d87c7c","#919e8b","#d7ab82","#6e7074","#61a0a8","#efa18d","#787464","#cc7e63","#724e58","#4b565b"],dark:["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78","#73a373","#73b9bc","#7289ab","#91ca8c","#f49f42"],macarons:["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],shine:["#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487"],roma:["#E01F54","#001852","#f5e8c8","#b8d2c7","#c6b38e","#a4d8c2","#f3d999","#d3758f","#dcc392","#2e4783","#82b6e9","#ff6347","#a092f1","#0a915d","#eaf889","#6699FF","#ff6666","#3cb371","#d5b158","#38b6b6"],royal:["#3f7ea6","#993366","#408000","#8c6f56","#a65149","#731f17","#adc2eb","#d9c3b0"],"dark-blue":["#00305a","#004b8d","#0074d9","#4192d9","#7abaf2","#99cce6","#d6ebf5","#eeeeee"],"tech-blue":["#4d4d4d","#3a5897","#007bb6","#7094db","#0080ff","#b3b3ff","#00bdec","#33ccff","#ccddff","#eeeeee"],red:["#d8361b","#f16b4c","#f7b4a9","#d26666","#99311c","#c42703","#d07e75"],"red-velvet":["#8b1a2d","#a7314b","#e6004c","#ff8066","#8e5c4e","#ff1a66","#d6c582","#f0d4af"],green:["#408829","#68a54a","#a9cba2","#86b379","#397b29","#8abb6f","#759c6a","#bfd3b7"],light:["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"],gray:["#757575","#c7c7c7","#dadada","#8b8b8b","#b5b5b5","#e9e9e9"],"dark-bold":["#458c6b","#f2da87","#d9a86c","#d94436","#a62424","#76bc9b","#cce6da","#eeeeee"]};function s(e){return(e=(e||"").toString()).length<2?"0"+e:e}var r=function(){function e(t,a,i,n){if(Object(o.a)(this,e),this.moment=t,!this.moment)throw new Error("moment must be set and initialized");this.config=n?JSON.parse(JSON.stringify(n)):null,this.calcTextWidth=i,this.themeType=a||"light",this.chart={yAxis:[]}}return Object(i.a)(e,[{key:"setThemeName",value:function(e){this.themeType=e||"light"}},{key:"setConfig",value:function(e){this.config=e}},{key:"getHelperChartData",value:function(){return this.chart}},{key:"convertData",value:function(e,t,a){var o=e[t];if(!o||!o.length)return[];var i=this.chart.yAxis[a]||{max:null,min:null};this.chart.yAxis[a]=i;for(var n=0;n<o.length;n++)null!==o[n].value[1]&&((null===i.min||i.min>o[n].value[1])&&(i.min=o[n].value[1]),(null===i.max||i.max<o[n].value[1])&&(i.max=o[n].value[1]));return(null===this.chart.xMin||this.chart.xMin>o[0].value[0])&&(this.chart.xMin=o[0].value[0]),(null===this.chart.xMax||this.chart.xMax<o[o.length-1].value[0])&&(this.chart.xMax=o[o.length-1].value[0]),o}},{key:"getSeries",value:function(e,t){var a=this;this.chart.xMin=null,this.chart.xMax=null;var o=0;return this.config.l.map((function(i,s){var r=i.color||(n[t]?n[t][o%n[t].length]:"");i.color||o++;var c=""===i.commonYAxis||void 0===i.commonYAxis?s:parseInt(i.commonYAxis)||0,l={name:i.name,xAxisIndex:0,yAxisIndex:c,type:"scatterplot"===i.chartType?"scatter":"line",showSymbol:"scatterplot"===i.chartType||i.points,hoverAnimation:!0,animation:!1,step:"steps"===i.chartType?"end":void 0,smooth:"spline"===i.chartType,data:a.convertData(e,s,c),itemStyle:{color:r},symbolSize:"scatterplot"===i.chartType||i.points?i.symbolSize||3:void 0,symbol:"circle",lineStyle:{width:i.thickness||1,shadowBlur:i.shadowsize?i.shadowsize+1:0,shadowOffsetY:i.shadowsize?i.shadowsize+1:0,shadowColor:r,type:i.dashes?"dashed":i.lineStyle||"solid"}};return parseFloat(i.fill)&&(l.areaStyle={color:r,opacity:parseFloat(i.fill)}),l}))}},{key:"getXAxis",value:function(){return[{type:"time",splitLine:{show:!this.config.grid_hideX,lineStyle:"off"===this.config.l[0].xaxe?{color:"rgba(0,0,0,0)",type:"dashed"}:this.config.grid_color?{color:this.config.grid_color,type:"dashed"}:{type:"dashed"}},splitNumber:parseInt(this.config.l[0].xticks,10)||void 0,position:"top"===this.config.l[0].xaxe?"top":"bottom",min:this.chart.xMin,max:this.chart.xMax,axisTick:{alignWithLabel:!0,lineStyle:"off"===this.config.l[0].xaxe?{color:"rgba(0,0,0,0)"}:this.config.x_ticks_color?{color:this.config.x_ticks_color}:void 0},axisLabel:{formatter:this.xFormatter.bind(this),color:"off"===this.config.l[0].xaxe?"rgba(0,0,0,0)":this.config.x_labels_color||void 0}}]}},{key:"getYAxis",value:function(e,t){var a=this;return this.config.l.map((function(e,o){if(!e||""!==e.commonYAxis&&void 0!==e.commonYAxis)return{};var i=parseFloat(e.min),n=parseFloat(e.max),s=a.chart.yAxis;if(s[o]){var r=s[o].max-s[o].min;isNaN(i)&&(i=s[o].min-.1*r,r>25e3?i=1e4*Math.floor(i/1e4):r>5e3?i=1e3*Math.floor(i/1e3):r>200?i=100*Math.floor(i/100):r>30?i=10*Math.floor(i/10):r>10?i=Math.floor(i):r>1&&(i=Math.floor(10*i)/10)),isNaN(n)&&(n=s[o].max+.1*r,r>25e3?n=1e4*Math.ceil(n/1e4):r>5e3?n=1e3*Math.ceil(n/1e3):r>200?n=100*Math.ceil(n/100):r>30?n=10*Math.ceil(n/10):r>10?n=Math.ceil(n):r>1&&(n=Math.floor(10*n)/10))}else isNaN(i)&&(i=void 0),isNaN(n)&&(n=void 0);var c="off"===e.yaxe?"rgba(0,0,0,0)":a.config.grid_color||void 0;return"leftColor"!==e.yaxe&&"rightColor"!==e.yaxe||(c=t[o].itemStyle.color),{type:"value",min:i,max:n,position:"left"===e.yaxe||"off"===e.yaxe||"leftColor"===e.yaxe?"left":"right"===e.yaxe||"rightColor"===e.yaxe||o?"right":"left",splitLine:o?void 0:{show:!a.config.grid_hideY,lineStyle:{color:c||void 0,type:"dashed"}},splitNumber:parseInt(e.yticks,10)||void 0,axisLabel:{formatter:function(e){return a.yFormatter(e,o,!0)},color:"off"===e.yaxe||"leftColor"===e.yaxe||"rightColor"===e.yaxe?c:a.config.y_labels_color||void 0},axisTick:{alignWithLabel:!0,lineStyle:c?{color:c}:a.config.y_ticks_color?{color:a.config.y_ticks_color}:void 0}}}))}},{key:"getMarkings",value:function(e){var t=this;return this.config.marks&&this.config.marks.forEach((function(a){var o=void 0!==a.lowerValue?a.lowerValue:parseFloat(a.lowerValueOrId),i=void 0!==a.upperValue?a.upperValue:parseFloat(a.upperValueOrId),n=null!==o&&!isNaN(o),s=null!==i&&!isNaN(i),r=e.series[a.lineId];if(n&&s&&(r.markArea=r.markArea||{symbol:["none","none"],itemStyle:{color:a.color||r.itemStyle.color,borderWidth:0,opacity:parseFloat(a.fill)},data:[]},r.markArea.data.push([{yAxis:o,name:a.text||""},{yAxis:i}])),n||s)for(var c=0;c<2;c++)if((c||s)&&(!c||n)){var l=c?o:i;if(r.markLine=r.markLine||{symbol:["none","none"],data:[]},r.markLine.data.push({yAxis:l,name:a.text,lineStyle:{color:a.color||r.itemStyle.color,width:parseFloat(a.ol)||1,shadowBlur:parseFloat(a.os)?parseFloat(a.os)+1:0,shadowOffsetY:parseFloat(a.os)?parseFloat(a.os)+1:0,shadowColor:a.color,type:a.lineStyle||"solid"},label:{show:!!a.text,formatter:function(e){return e.name},position:"r"===a.textPosition?"end":"start",distance:-1*a.textOffset||-35,textStyle:{color:a.textColor||"#FFF",fontStyle:"normal",fontSize:a.textSize||void 0}}}),t.config.l[a.lineId]){var h=parseFloat(t.config.l[a.lineId].min);isNaN(h)&&t.chart.yAxis[a.lineId]&&t.chart.yAxis[a.lineId].min>l&&l<0&&(e.yAxis[0].min=l);var u=parseFloat(t.config.l[a.lineId].min);isNaN(u)&&t.chart.yAxis[a.lineId]&&t.chart.yAxis[a.lineId].max<l&&(e.yAxis[0].max=l)}}})),e}},{key:"yFormatter",value:function(e,t,a,o){if("boolean"===this.config.l[t].type)return e?"TRUE":"FALSE";if(null===e||void 0===e)return"";var i=this.config.l[t].afterComma;return void 0!==i&&null!==i?(e=parseFloat(e),this.config.useComma?e.toFixed(i).replace(".",",")+(a?this.config.l[t].unit:""):e.toFixed(i)+(a?this.config.l[t].unit:"")):(o&&(e=Math.round(1e4*e)/1e4),this.config.useComma?(e=parseFloat(e)||0).toString().replace(".",",")+(a?this.config.l[t].unit:""):e.toString()+(a?this.config.l[t].unit:""))}},{key:"isXLabelHasBreak",value:function(){return this.config.timeFormat?this.config.timeFormat.replace("<br/>","\n").includes("\n"):!this.chart.withSeconds&&(this.chart.withTime,!0)}},{key:"xFormatter",value:function(e,t){var a=new Date(e);return this.config.timeFormat?this.moment(a).format(this.config.timeFormat).replace("<br/>","\n"):this.chart.withSeconds?s(a.getHours())+":"+s(a.getMinutes())+":"+s(a.getSeconds()):this.chart.withTime?s(a.getHours())+":"+s(a.getMinutes())+"\n"+s(a.getDate())+"."+s(a.getMonth()+1):s(a.getDate())+"."+s(a.getMonth()+1)+"\n"+a.getFullYear()}},{key:"getInterpolatedValue",value:function(e,t,a,o){var i=this.option.series[e].data;if(!i||!i[0]||i[0].value[0]>t||i[i.length-1].value[0]<t)return null;for(var n=0;n<i.length-1;n++){if(i[n].value[0]===t)return{exact:!0,val:i[n].value[1]};if(i[n].value[0]<t&&t<i[n+1].value[0]){var s=i[n].value[1],r=i[n+1].value[1];if(null===r||void 0===r||null===s||void 0===s)return o?null:{exact:!1,val:null};if("boolean"===a)return{exact:!1,val:s};var c=i[n+1].value[0]-i[n].value[0];return{exact:!1,val:(1-(i[n+1].value[0]-t)/c)*(r-s)+s}}}return o?null:{exact:!1,val:null}}},{key:"renderTooltip",value:function(e){var t=this,a=e[0].value[0],o=new Date(a),i=!0===this.config.hoverNoNulls||"true"===this.config.hoverNoNulls,n=this.option.series.map((function(o,n){var s,r=e.find((function(e){return e.seriesIndex===n}));if(r&&(s={exact:void 0===r.data.exact||r.data.exact,val:r.value[1]}),!(s=s||t.getInterpolatedValue(n,a,t.config.l[n].type,i)))return"";var c=null===s.val?"null":t.yFormatter(s.val,n,!1,!s.exact);return'<div style="width: 100%; display: inline-flex; justify-content: space-around; color: '.concat(o.itemStyle.color,'">')+'<div style="display: flex;margin-right: 4px">'.concat(o.name,":</div>")+'<div style="display: flex; flex-grow: 1"></div>'+'<div style="display: flex;">'.concat(s.exact?"":"i ","<b>").concat(c,"</b>").concat(null!==s.val?t.config.l[n].unit:"","</div>")+"</div>"})),s=this.config.timeFormat||"dd, MM Do YYYY, h:mm:ss.SSS";return"<b>".concat(this.moment(o).format(s),"</b><br/>").concat(n.filter((function(e){return e})).join("<br/>"))}},{key:"getLegend",value:function(e){return this.config.legend&&"none"!==this.config.legend?{data:this.config.l.map((function(e){return e.name})),show:!0,left:"nw"===this.config.legend||"sw"===this.config.legend?this.chart.padLeft+1:void 0,right:"ne"===this.config.legend||"se"===this.config.legend?this.chart.padRight+1:void 0,top:"nw"===this.config.legend||"ne"===this.config.legend?10:void 0,bottom:"sw"===this.config.legend||"se"===this.config.legend?e+20:void 0,backgroundColor:this.config.legBg||void 0,textStyle:{color:this.config.legColor||("light"===this.themeType?"#000":"#FFF")}}:void 0}},{key:"getTitle",value:function(e){if(this.config.title){var t={};return(this.config.titlePos||"top:35;left:65").split(";").forEach((function(e){var a=e.split(":");t[a[0].trim()]=parseInt(a[1].trim(),10)})),{text:this.config.title,textStyle:{fontSize:this.config.titleSize?parseInt(this.config.titleSize,10):20,color:this.config.titleColor||("light"===this.themeType?"#000":"#FFF")},textVerticalAlign:t.bottom?"bottom":"top",textAlign:50===t.left?"center":-5===t.right?"right":"left",top:35===t.top?5:50===t.top?"50%":void 0,left:50===t.left?"50%":65===t.left?this.chart.padLeft:void 0,bottom:t.bottom?t.bottom>0?t.bottom+e-10:t.bottom:void 0,right:5===t.right?this.chart.padRight:void 0}}}},{key:"getOption",value:function(e,t){var a=this;t&&(this.config=JSON.parse(JSON.stringify(t)));var o=this.config.theme;o&&"default"!==o||(o="light"===this.themeType?"roma":"dark-bold"),this.debug=this.config&&this.config.debug,this.debug&&console.log("[ChartView ] [".concat((new Date).toISOString(),"] ").concat(JSON.stringify(this.config,null,2)));var i=this.getSeries(e,o);this.config.start&&(this.chart.xMax<this.config.end&&(this.chart.xMax=this.config.end),this.chart.xMin>this.config.start&&(this.chart.xMin=this.config.start)),this.chart.diff=this.chart.xMax-this.chart.xMin,this.chart.withTime=this.chart.diff<6048e5,this.chart.withSeconds=this.chart.diff<18e5;var n=this.getYAxis(o,i),s=this.getXAxis(),r={theme:o,backgroundColor:"transparent",animation:!this.config.noAnimation&&!this.config.noLoader,grid:{backgroundColor:this.config.bg_custom||"transparent",show:!!this.config.bg_custom,left:0,top:8,right:0,bottom:this.isXLabelHasBreak()?40:24},tooltip:this.config.hoverDetail?{trigger:"axis",formatter:function(e){return a.renderTooltip(e)},hoverAnimation:!0,axisPointer:{animation:!0}}:void 0,xAxis:s,yAxis:n,series:i};this.getMarkings(r);var c=0,l=0;return i.forEach((function(e,t){var o=r.yAxis[e.yAxisIndex];if(!o){var i=a.config.l[e.yAxisIndex]?a.config.l[e.yAxisIndex].commonYAxis:void 0;if(void 0===i)return void console.log("Cannot find Y axis for line "+t);o=r.yAxis[i]}var n=a.yFormatter(o.min,t,!0),s=a.yFormatter(o.min||o.max!==o.min?o.max:.8,t,!0),h=o.position;if(!("off"===h||o.axisLabel&&"rgba(0,0,0,0)"===o.axisLabel.color)){var u=a.calcTextWidth(n)+4,d=a.calcTextWidth(s)+4;"left"===h||"leftColor"===h?(u>c&&(c=u),d>c&&(c=d)):(u>l&&(l=u),d>l&&(l=d))}})),r.grid.left=c+10,r.grid.right=l+10+(!0===this.config.export||"true"===this.config.export?20:0),this.chart.padLeft=r.grid.left,this.chart.padRight=r.grid.right,r.legend=this.getLegend(20),r.title=this.getTitle(20),this.config.grid_color||(r.yAxis.forEach((function(e){return e.splitLine&&delete e.splitLine.lineStyle})),r.xAxis.forEach((function(e){return e.splitLine&&delete e.splitLine.lineStyle}))),this.option=r,this.option}}]),e}();e.exports=r,t.a=r}).call(this,a(155)(e))},428:function(e,t,a){e.exports=a(892)},433:function(e,t,a){},439:function(e,t){},441:function(e,t){},452:function(e,t){},454:function(e,t){},481:function(e,t){},483:function(e,t){},484:function(e,t){},489:function(e,t){},491:function(e,t){},510:function(e,t){},522:function(e,t){},525:function(e,t){},881:function(e){e.exports=JSON.parse('{"Save as image":"Save as image","Reset pan and zoom":"Reset pan and zoom","Save chart as svg":"Save chart as SVG","Unfortunately your browser does not support this feature":"Unfortunately your browser does not support this feature"}')},882:function(e){e.exports=JSON.parse('{"Save as image":"Als Bild speichern","Reset pan and zoom":"Verschiebung und Zoomen zur\xfccksetzen","Save chart as svg":"Diagramm als SVG speichern","Unfortunately your browser does not support this feature":"Leider unterst\xfctzt Ihr Browser diese Funktion nicht"}')},883:function(e){e.exports=JSON.parse('{"Save as image":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u0430\u043a \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435","Reset pan and zoom":"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0441\u0434\u0432\u0438\u0433 \u0438 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","Save chart as svg":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0433\u0440\u0430\u0444\u0438\u043a \u043a\u0430\u043a SVG","Unfortunately your browser does not support this feature":"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u0432\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u044d\u0442\u0443 \u0444\u0443\u043d\u043a\u0446\u0438\u044e"}')},884:function(e){e.exports=JSON.parse('{"Save as image":"Salvar como imagem","Reset pan and zoom":"Redefinir panor\xe2mica e zoom","Save chart as svg":"Salvar gr\xe1fico como SVG","Unfortunately your browser does not support this feature":"Infelizmente, seu navegador n\xe3o oferece suporte a esse recurso"}')},885:function(e){e.exports=JSON.parse('{"Save as image":"Bewaar als afbeelding","Reset pan and zoom":"Stel pannen en zoomen opnieuw in","Save chart as svg":"Bewaar grafiek als SVG","Unfortunately your browser does not support this feature":"Helaas ondersteunt uw browser deze functie niet"}')},886:function(e){e.exports=JSON.parse('{"Save as image":"Enregistrer comme image","Reset pan and zoom":"R\xe9initialiser le panoramique et le zoom","Save chart as svg":"Enregistrer le graphique au format SVG","Unfortunately your browser does not support this feature":"Malheureusement, votre navigateur ne prend pas en charge cette fonctionnalit\xe9"}')},887:function(e){e.exports=JSON.parse('{"Save as image":"Salva come immagine","Reset pan and zoom":"Reimposta panoramica e zoom","Save chart as svg":"Salva grafico come SVG","Unfortunately your browser does not support this feature":"Purtroppo il tuo browser non supporta questa funzionalit\xe0"}')},888:function(e){e.exports=JSON.parse('{"Save as image":"Guardar como imagen","Reset pan and zoom":"Restablecer panor\xe1mica y zoom","Save chart as svg":"Guardar gr\xe1fico como SVG","Unfortunately your browser does not support this feature":"Lamentablemente, su navegador no es compatible con esta funci\xf3n."}')},889:function(e){e.exports=JSON.parse('{"Save as image":"Zapisz jako obraz","Reset pan and zoom":"Zresetuj przesuwanie i powi\u0119kszanie","Save chart as svg":"Zapisz wykres jako SVG","Unfortunately your browser does not support this feature":"Niestety Twoja przegl\u0105darka nie obs\u0142uguje tej funkcji"}')},890:function(e){e.exports=JSON.parse('{"Save as image":"\u53e6\u5b58\u4e3a\u56fe\u7247","Reset pan and zoom":"\u91cd\u7f6e\u5e73\u79fb\u548c\u7f29\u653e","Save chart as svg":"\u5c06\u56fe\u8868\u53e6\u5b58\u4e3aSVG","Unfortunately your browser does not support this feature":"\u4e0d\u5e78\u7684\u662f\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u6b64\u529f\u80fd"}')},892:function(e,t,a){"use strict";a.r(t);var o=a(1),i=a.n(o),n=a(31),s=a.n(n),r=a(917),c=a(923),l=a(922),h=(a(433),a(74)),u=a(75),d=a(188),f=a(185),g=a(16),p=a(311),m=a(924),v=a(410),y=a.n(v),b=a(919),x=a(113),w=a.n(x),S=a(411),k=a.n(S),D=a(42),I=a.n(D),T=a(189),C=a.n(T),M=a(412),O=a.n(M),z=a(183),R=a.n(z),E=(a(552),a(413)),F=a(920),N=a(186),L=a(40),_=a.n(L),A=(a(553),a(554),a(555),a(556),a(557),a(558),a(559),a(560),a(561),a(562),a(414)),B=a.n(A),H=a(4),U=a.n(H),j=(a(349),a(356),a(357),a(361),a(362),a(363),a(415)),V=(a(642),a(855),a(856),a(857),a(858),a(859),a(860),a(861),a(862),a(863),a(864),a(865),a(866),a(867),a(868),a(869),a(870),a(385),a(390),a(246),a(394),a(391),a(408),null);function J(e,t,a){var o=(V||(V=document.createElement("canvas"))).getContext("2d");o.font="".concat(t||12,"px ").concat(a||"Microsoft YaHei");var i=o.measureText(e);return Math.ceil(i.width)}var P=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var o;return Object(h.a)(this,a),(o=t.call(this,e)).updateProperties=function(e){if(o.updatePropertiesTimeout=null,o.echartsReact&&"function"===typeof o.echartsReact.getEchartsInstance){var t=o.echartsReact.getEchartsInstance(),a=e.config&&e.config.l&&e.config.l.map((function(e){return e.id}))||[];a.sort();var i=JSON.stringify(a)!==JSON.stringify(o.lastIds);i&&(o.lastIds=a,t.clear()),o.option=o.chartOption.getOption(e.data,e.config),o.debug&&console.log("[ChartView ] [".concat((new Date).toISOString(),"] updateProperties: {min: ").concat(o.option.xAxis[0].min,", ").concat(o.option.xAxis[0].max,"}"));try{t.setOption(o.option,i)}catch(n){console.error("Cannot apply options: "+JSON.stringify(o.option))}}},o.onResize=function(){o.timerResize&&clearTimeout(o.timerResize),o.timerResize=setTimeout((function(){o.timerResize=null,o.componentDidUpdate()}))},o.onMouseMove=function(e){if(o.mouseDown){o.divResetButton.current&&"block"!==o.divResetButton.current.style.display&&(o.divResetButton.current.style.display="block");var t=o.chartOption.getHelperChartData(),a=t.lastX-(e.offsetX-t.padLeft);t.lastX=e.offsetX-t.padLeft;var i=t.xMax-t.xMin,n=o.state.chartWidth-t.padRight-t.padLeft,s=Math.round(a*i/n);t.xMin+=s,t.xMax+=s,o.setNewRange()}},o.onMouseDown=function(e){o.mouseDown=!0,o.chartOption.getHelperChartData().lastX=e.offsetX,o.zr&&!o.zr._mousemove&&(o.zr._mousemove=!0,o.zr.on("mousemove",o.onMouseMove)),o.props.config.live&&o.props.onRangeChange&&(console.log("Stop update"),o.props.onRangeChange({stopLive:!0}))},o.onMouseUp=function(){o.mouseDown=!1,o.setNewRange(!0),o.zr&&o.zr._mousemove&&(o.zr._mousemove=!1,o.zr.off("mousemove",o.onMouseMove))},o.onMouseWheel=function(e){var t=o.chartOption.getHelperChartData(),a=t.xMax-t.xMin,i=o.state.chartWidth-t.padRight-t.padLeft,n=(e.offsetX-t.padLeft)/i,s=a-(a*=e.wheelDelta>0?1.1:.9);t.xMax+=s*(1-n),t.xMin-=s*n,o.setNewRange(),o.updateDataTimer&&clearTimeout(o.updateDataTimer),o.updateDataTimer=setTimeout((function(){return o.setNewRange(!0)}),1e3)},o.onTouchStart=function(e){e.preventDefault(),o.mouseDown=!0;var t=e.touches||e.originalEvent.touches;if(t){var a=o.chartOption.getHelperChartData();a.lastX=t[t.length-1].pageX,t.length>1?a.lastWidth=Math.abs(t[0].pageX-t[1].pageX):a.lastWidth=null}},o.onTouchEnd=function(e){e.preventDefault(),o.mouseDown=!1,o.setNewRange(!0)},o.onTouchMove=function(e){e.preventDefault();var t=e.touches||e.originalEvent.touches;if(t){var a=o.chartOption.getHelperChartData(),i=t[t.length-1].pageX-a.padLeft;if(o.mouseDown)if(t.length>1){var n=Math.abs(t[0].pageX-t[1].pageX);if(null!==a.lastWidth&&n!==a.lastWidth){var s=a.xMax-a.xMin,r=o.state.chartWidth-a.padRight-a.padLeft,c=n>a.lastWidth?1.1:.9,l=(t[0].pageX>t[1].pageX?t[1].pageX-a.padLeft+n/2:t[0].pageX-a.padLeft+n/2)/r,h=s-(s*=c);a.xMax+=h*(1-l),a.xMin-=h*l,o.setNewRange()}a.lastWidth=n}else{var u=a.lastX-i,d=a.xMax-a.xMin,f=o.state.chartWidth-a.padRight-a.padLeft,g=Math.round(u*d/f);a.xMin+=g,a.xMax+=g,o.setNewRange()}a.lastX=i}},o.state={chartHeight:null,chartWidth:null},o.echartsReact=i.a.createRef(),o.divRef=i.a.createRef(),o.divResetButton=i.a.createRef(),_.a.locale(I.a.getLanguage()),o.lastIds=o.props.config&&o.props.config.l&&o.props.config.l.map((function(e){return e.id}))||[],o.lastIds.sort(),o.chartOption=new j.a(_.a,o.props.themeType,J),o}return Object(u.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(e.data===this.state.data)return null;this.updatePropertiesTimeout&&clearTimeout(this.updatePropertiesTimeout),this.updatePropertiesTimeout=setTimeout(this.updateProperties,100,e)}},{key:"setNewRange",value:function(e){var t=this.chartOption.getHelperChartData();if(t.diff=t.xMax-t.xMin,t.withTime=t.diff<6048e5,t.withSeconds=t.diff<18e5,console.log("[ChartView ] [".concat((new Date).toISOString(),"] setNewRange: ").concat(!!e,", {min: ").concat(t.xMin,", max: ").concat(t.xMax,"}")),e)this.updateDataTimer&&clearTimeout(this.updateDataTimer),this.updateDataTimer=null,this.props.onRangeChange&&this.props.onRangeChange({start:t.xMin,end:t.xMax});else{console.log("[ChartView ] [".concat((new Date).toISOString(),"] setOption in setNewRange")),this.option.xAxis[0].min=t.xMin,this.option.xAxis[0].max=t.xMax;try{this.echartsReact&&"function"===typeof this.echartsReact.getEchartsInstance&&this.echartsReact.getEchartsInstance().setOption({xAxis:{min:t.xMin,max:t.xMax}})}catch(a){console.error("Cannot apply options 1: "+JSON.stringify(this.option))}}}},{key:"installEventHandlers",value:function(){this.zr=this.echartsReact&&this.echartsReact.getEchartsInstance&&this.echartsReact.getEchartsInstance().getZr(),this.zr&&this.props.config.zoom&&!this.zr._iobInstalled?(this.zr._iobInstalled=!0,this.zr.on("mousedown",this.onMouseDown),this.zr.on("mouseup",this.onMouseUp),this.zr.on("mousewheel",this.onMouseWheel),this.zr.on("touchstart",this.onTouchStart),this.zr.on("touchend",this.onTouchEnd),this.zr.on("touchmove",this.onTouchMove)):this.zr&&!this.props.config.zoom&&this.zr._iobInstalled&&(this.zr._iobInstalled=!1,this.zr.off("mousedown",this.onMouseDown),this.zr.off("mouseup",this.onMouseUp),this.zr.off("mousewheel",this.onMouseWheel),this.zr&&this.zr._mousemove&&(this.zr._mousemove=!1,this.zr.off("mousemove",this.onMouseMove)),this.zr.off("touchstart",this.onTouchStart),this.zr.off("touchend",this.onTouchEnd),this.zr.off("touchmove",this.onTouchMove))}},{key:"renderChart",value:function(){var e=this;return this.props.data?(this.option=this.option||this.chartOption.getOption(this.props.data,this.props.config),this.debug&&console.log("[ChartView ] [".concat((new Date).toISOString(),"] render chart")),i.a.createElement(B.a,{ref:function(t){return e.echartsReact=t},echarts:U.a,option:this.option,notMerge:!0,lazyUpdate:!0,theme:this.option.theme,style:{height:this.state.chartHeight+"px",width:"100%"},opts:{renderer:"svg"},onEvents:{rendered:function(t){e.props.config.zoom&&e.installEventHandlers()}}})):i.a.createElement(b.a,null)}},{key:"componentDidUpdate",value:function(){var e=this;if(this.divRef.current){var t="noborder"!==this.props.config.noBorder&&parseFloat(this.props.config.border_width)||0,a=parseFloat(this.props.config.border_padding)||0,o=this.divRef.current.offsetHeight-2*(t+a);if(this.state.chartHeight!==o){var i=this.divRef.current.offsetWidth-2*(t+a);setTimeout((function(){return e.setState({chartHeight:o,chartWidth:i})}),10)}}}},{key:"renderResetButton",value:function(){var e=this;return i.a.createElement(F.a,{ref:this.divResetButton,size:"small",color:"default",style:{display:"none"},className:this.props.classes.resetButton,title:I.a.t("Reset pan and zoom"),onClick:function(){e.divResetButton.current&&(e.divResetButton.current.style.display="none"),e.props.onRangeChange&&e.props.onRangeChange()}},i.a.createElement(N.b,{className:this.props.classes.resetButtonIcon}))}},{key:"renderExportButton",value:function(){var e=this;return this.props.config.export?i.a.createElement(N.a,{color:this.props.config.exportColor||"default",className:this.props.classes.exportButton,title:I.a.t("Save chart as svg"),onClick:function(){if(e.echartsReact&&"function"===typeof e.echartsReact.getEchartsInstance){var t=e.echartsReact.getEchartsInstance().getDataURL({pixelRatio:2,backgroundColor:e.props.config.window_bg||("dark"===e.props.themeType?"#000":"#FFF")}),a=document.createElement("a");document.body.appendChild(a),a.href=t,a.target="_self";var o="";o=1===e.props.config.l.length?e.props.config.l[0].name:"chart";var i=e.option,n=new Date(i.xAxis[0].max||i.series[0].data[i.series[0].data.length-1].value[0]);try{a.download="".concat(n.getFullYear(),"_").concat((n.getMonth()+1).toString().padStart(2,"0"),"_").concat(n.getDate().toString().padStart(2,"0"))+"_".concat(n.getHours().toString().padStart(2,"0"),"_").concat(n.getMinutes().toString().padStart(2,"0"),"_").concat(o,".svg"),a.click()}catch(s){console.error("Cannot access download: "+s),window.alert(I.a.t("Unfortunately your browser does not support this feature"))}}}}):null}},{key:"render",value:function(){var e=this;this.divRef.current||setTimeout((function(){return e.forceUpdate()}),10);var t="noborder"!==this.props.config.noBorder&&parseFloat(this.props.config.border_width)||0,a=parseFloat(this.props.config.border_padding)||0;return i.a.createElement("div",{ref:this.divRef,className:this.props.classes.chart,style:{borderWidth:t,width:t||a?"calc(100% - "+(2*(t+a)+1)+"px":void 0,height:t||a?"calc(100% - "+2*(t+a)+"px":void 0,background:this.props.config.window_bg||void 0,borderColor:"noborder"!==this.props.config.noBorder&&this.props.config.border_color||void 0,borderStyle:"noborder"!==this.props.config.noBorder&&t?this.props.config.border_style||"solid":"hidden",padding:a||0}},this.renderExportButton(),this.renderResetButton(),null!==this.state.chartHeight?this.renderChart():null)}}]),a}(i.a.Component),W=Object(m.a)()(Object(g.a)((function(e){return{chart:{maxHeight:"100%",maxWidth:"100%",width:"100%",height:"100%",overflow:"hidden",position:"relative"},exportButton:{position:"absolute",top:40,right:5,width:20,height:20,zIndex:2,opacity:.7,cursor:"pointer"},resetButton:{position:"absolute",top:10,right:25,zIndex:2,opacity:.7},resetButtonIcon:{paddingTop:6}}}))(P)),X=function(e){Object(d.a)(o,e);var t=Object(f.a)(o);function o(e){var n;Object(h.a)(this,o),(n=t.call(this,e)).onReceiveMessage=function(e){if(e&&"chartReady"!==e.data)try{var t=JSON.parse(e.data);n.chartData?n.chartData.setConfig(t):n.createChartData(t)}catch(a){return console.log("Cannot parse "+e.data)}};var s=n.createTheme(),r=w.a.parseQuery(window.location.search),c=w.a.parseQuery((window.location.hash||"").replace(/^#/,""));n.state={connected:!1,seriesData:null,noLoader:r.noLoader||c.noLoader||!1,theme:s,themeName:n.getThemeName(s),themeType:n.getThemeType(s),noBackground:r.noBG||c.noBG||!1},n.inEdit="1"===r.edit||1===r.edit||!0===r.edit||"true"===r.edit||"1"===c.edit||1===c.edit||!0===c.edit||"true"===c.edit,n.divRef=i.a.createRef(),n.progressRef=i.a.createRef();var l={en:a(871),de:a(872),ru:a(873),pt:a(874),nl:a(875),fr:a(876),it:a(877),es:a(878),pl:a(879),"zh-cn":a(880)},u={en:a(881),de:a(882),ru:a(883),pt:a(884),nl:a(885),fr:a(886),it:a(887),es:a(888),pl:a(889),"zh-cn":a(890)};Object.keys(l).forEach((function(e){return l[e]=Object.assign(l[e],u[e])})),I.a.setTranslations(l);try{n.isIFrame=window.self!==window.top}catch(d){n.isIFrame=!0}return n.socket=new C.a({name:window.adapterName,onProgress:function(e){e===T.PROGRESS.CONNECTING?n.setState({connected:!1}):(T.PROGRESS.READY,n.setState({connected:!0}))},onReady:function(e,t){I.a.setLanguage(n.socket.systemLang),n.socket.getSystemConfig().then((function(e){var t,a;if(n.systemLang=(null===e||void 0===e||null===(t=e.common)||void 0===t?void 0:t.language)||"en",n.isFloatComma=(null===e||void 0===e||null===(a=e.common)||void 0===a?void 0:a.isFloatComma)||!1,n.inEdit){if(window.addEventListener("message",n.onReceiveMessage),window.self!==window.parent)try{window.parent.postMessage("chartReady")}catch(d){console.warn("Cannot send ready event to parent window")}}else n.createChartData()}))},onError:function(e){console.error(e),n.showError(e)}}),n}return Object(u.a)(o,[{key:"createChartData",value:function(e){var t=this;this.chartData=new E.a(this.socket,e),this.chartData.onError((function(e){return t.showError(I.a.t(e))})),this.chartData.onReading((function(e){return t.showProgress(e)})),this.chartData.onUpdate((function(e){return t.setState({seriesData:e},(function(){return t.showProgress(!1)}))}))}},{key:"showProgress",value:function(e){this.progressRef.current&&(this.progressRef.current.style.display=e?"block":"none")}},{key:"componentWillUnmount",value:function(){this.inEdit&&window.removeEventListener("message",this.onReceiveMessage,!1),this.chartData&&this.chartData.destroy()}},{key:"createTheme",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return R()(w.a.getThemeName(e))}},{key:"getThemeName",value:function(e){return e.name}},{key:"getThemeType",value:function(e){return e.palette.type}},{key:"showError",value:function(e){this.setState({errorText:e})}},{key:"renderError",value:function(){var e=this;return this.state.errorText?i.a.createElement(O.a,{classes:{},text:this.state.errorText,onClose:function(){return e.setState({errorText:""})}}):null}},{key:"render",value:function(){var e=this;if(!this.state.connected||!this.state.seriesData)return this.state.noLoader?null:i.a.createElement(r.a,{theme:this.state.theme},i.a.createElement(k.a,{theme:this.state.themeType}));var t=this.chartData.getConfig(),a=y()(JSON.stringify((t&&t.l&&t.l.map((function(e){return e.id}))||[]).sort())).toString();return this.state.seriesData&&t.debug&&console.log("seriesData: "+JSON.stringify(this.state.seriesData)),i.a.createElement(r.a,{theme:this.state.theme},i.a.createElement("div",{ref:this.divRef,className:this.props.classes.root,style:{width:t.width,height:t.height,background:this.state.noBackground?void 0:this.state.theme.palette.background.default,color:this.state.theme.palette.text.primary}},i.a.createElement(b.a,{ref:this.progressRef,style:{display:"block"},className:this.props.classes.progress}),i.a.createElement(W,{key:a,socket:this.socket,t:I.a.t,noAnimation:this.state.noLoader,data:this.state.seriesData,config:t,lang:I.a.getLanguage(),themeType:this.state.themeType,onRangeChange:function(t){return e.chartData.setNewRange(t)}}),this.renderError()))}}]),o}(o.Component),Y=Object(m.a)()(Object(g.a)((function(e){return{root:{width:"100%",height:"100%",position:"relative"},progress:{position:"absolute",top:0,left:0,right:0}}}))(Object(p.a)(X)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z=a(251);window.adapterName="echarts-show";var G=w.a.getThemeName();console.log("iobroker."+window.adapterName+"@"+Z.a+' using theme "'+G+'"'),"localhost:3000"!==window.location.host&&c.a({dsn:"https://cf39325071144219aa91bb3510addcdf@sentry.iobroker.net/95",release:"iobroker."+window.adapterName+"@"+Z.a,integrations:[new l.a]}),function e(){return s.a.render(i.a.createElement(r.a,{theme:R()(G)},i.a.createElement(Y,{onThemeChange:function(t){G=t,e()}})),document.getElementById("root"))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[428,1,2]]]);
//# sourceMappingURL=main.c4d808ac.chunk.js.map