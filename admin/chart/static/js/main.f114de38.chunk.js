(this["webpackJsonpecharts.index"]=this["webpackJsonpecharts.index"]||[]).push([[0],{141:function(t){t.exports=JSON.parse('{"a":"0.0.1"}')},216:function(t,e,s){t.exports=s(401)},221:function(t,e,s){},401:function(t,e,s){"use strict";s.r(e);var i=s(0),n=s.n(i),a=s(21),o=s.n(a),r=s(425),h=(s(429),s(428),s(221),s(9)),c=s(151),l=s(430),g=s(41),d=s.n(g),f=s(203),m=s.n(f),u=s(48),p=s.n(u),v=s(110),w=s.n(v),b=s(204),y=s.n(b),D=s(108),T=s.n(D);s(246);function x(t,e){const s={},i={true:!0,false:!1,null:null};return t.replace(/\+/g," ").split("&").forEach(t=>{const n=t.split("=");let a,o=decodeURIComponent(n[0]),r=0,h=o.split("]["),c=h.length-1;if(/\[/.test(h[0])&&/]$/.test(h[c])?(h[c]=h[c].replace(/]$/,""),h=h.shift().split("[").concat(h),c=h.length-1):c=0,2===n.length)if(a=decodeURIComponent(n[1]),e&&(a=a&&!isNaN(a)&&+a+""===a?+a:"undefined"===a?void 0:void 0!==i[a]?i[a]:a),c){let t=s;for(;r<=c;r++)o=""===h[r]?t.length:h[r],t=t[o]=r<c?t[o]||(h[r+1]&&isNaN(h[r+1])?{}:[]):a}else"[object Array]"===Object.prototype.toString.call(s[o])?s[o].push(a):!{}.hasOwnProperty.call(s,o)?s[o]=a:s[o]=[s[o],a];else o&&(s[o]=e?void 0:"")}),s}function S(t){if(t.lines&&(t.l=JSON.parse(JSON.stringify(t.lines)),delete t.lines),t._ids){const e=t._ids?t._ids.split(";"):[],s=t._colors?t._colors.split(";"):[],i=t._names?t._names.split(";"):[],n=t._units?t._units.split(";"):[];t.l=[];for(let a=0;a<e.length;a++)t.l.push({id:e[a],offset:0,name:i[a]||"",aggregate:"onchange",color:s[a]||"blue",thickness:t.strokeWidth||1,shadowsize:t.strokeWidth||1,min:t.min||"",max:t.max||"",unit:n[a]||""});t.aggregateType="step",t.aggregateSpan=300,t.relativeEnd="now"}if(t.l)for(let e=0;e<t.l.length;e++)t.l[e].art&&(t.l[e].aggregate=t.l[e].art,delete t.l[e].art),t.instance&&!t.l[e].instance&&(t.l[e].instance=t.instance);return t.l=t.l||[],t.l.length||t.l.push({id:"",unit:""}),t.width=t.width||"100%",t.height=t.height||"100%",t.timeFormat=t.timeFormat||"%H:%M:%S %e.%m.%y",t.useComma="true"===t.useComma||!0===t.useComma,t.zoom="true"===t.zoom||!0===t.zoom,t.export="true"===t.export||!0===t.export,t.grid_hideX="true"===t.grid_hideX||!0===t.grid_hideX,t.grid_hideY="true"===t.grid_hideY||!0===t.grid_hideY,t.hoverDetail="true"===t.hoverDetail||!0===t.hoverDetail,t.noLoader="true"===t.noLoader||!0===t.noLoader,t.noedit="true"===t.noedit||!0===t.noedit,t.animation=parseInt(t.animation)||0,t.afterComma=void 0===t.afterComma?2:parseInt(t.afterComma,10),t.timeType=t.timeType||"relative",t}var I=class{constructor(t,e){this.onHashChange=()=>{this.lastHash!==window.location.hash&&(this.lastHash=window.location.hash,this.analyseAndLoadConfig())},this.onPresetUpdate=(t,e)=>{this.config=S(e?e.native.data:{}),this.seriesData=JSON.parse(JSON.stringify(this.seriesData)),this.onUpdateFunc&&this.onUpdateFunc(this.seriesData)},this.onStateChange=(t,e)=>{if(this.state.seriesData&&this.config&&this.config.m){console.log("State update "+t+" - "+e.val);for(let s=0;s<this.config.m.length;s++)this.config.m[s].oid===t&&(this.config.m[s].v=parseFloat(e.val)||0),this.config.m[s].oidl===t&&(this.config.m[s].vl=parseFloat(e.val)||0)}},this.socket=t,this.seriesData=[],this.ticks=null,this.liveInterval=null,this.navOptions={},this.subscribes=[],this.subscribed=!1,this.sessionId=1,this.onUpdateFunc=null,this.onReadingFunc=null,this.onErrorFunc=null,this.lastHash=window.location.hash,e||(this.onHashInstalled=!0,window.addEventListener("hashchange",this.onHashChange,!1)),this.analyseAndLoadConfig(e)}analyseAndLoadConfig(t){if(t)"string"===typeof t?this.preset=t:this.config=t;else{const t=d.a.parseQuery(window.location.search);if(t.preset)this.preset=t.preset;else{const t=Object.assign(x((window.location.search||"").toString().replace(/^\?/,""),!0),x((window.location.hash||"").toString().replace(/^#/,""),!0));this.config=S(t)}}this.preset?this.socket.getObject(this.preset).then(t=>{this.config=S(t.native.data),this.readData(),this.socket.subscribeObject(this.preset,this.onPresetUpdate)}):this.readData()}destroy(){this.subscribed&&(this.subscribes.forEach(t=>this.socket.unsubscribeState(t,this.onStateChange)),this.subscribes=[],this.subscribed=null),this.preset&&this.socket.unsubscribeObject(this.preset,this.onPresetUpdate),this.onHashInstalled&&window.removeEventListener("hashchange",this.onHashChange,!1),this.onHashInstalled=!1}onUpdate(t){this.onUpdateFunc=t}onReading(t){this.onReadingFunc=t}onError(t){this.onErrorFunc=t}getConfig(){return this.config}getStartStop(t,e){let s,i,n,a={};this.config.l[t].offset=this.config.l[t].offset||0;if("string"===typeof this.config.range&&this.config.range.includes("m")&&this.config.l.length>1){const t=parseInt(this.config.range,10)||1;for(let e=0;e<this.config.l.length;e++)if(this.config.l[e].offset&&0!==this.config.l[e].offset){n=this.addTime(this.now,this.config.l[0].offset);const e=new Date(n);e.setMonth(e.getMonth()-t),this.config.range=Math.floor((n-e.getTime())/6e4)+"";break}}if(this.config.zoomed)return this.navOptions[t].end=this.config.l[t].zMax,this.navOptions[t].start=this.config.l[t].zMin,this.navOptions[t];if(e)return s=this.addTime(this.now,this.config.l[t].offset),i=s-e,a={start:i,end:s,ignoreNull:void 0===this.config.l[t].ignoreNull?this.config.ignoreNull:this.config.l[t].ignoreNull,aggregate:this.config.l[t].aggregate||this.config.aggregate||"minmax",count:1,from:!1,ack:!1,q:!1,addID:!1},this.navOptions[t].end=s,this.navOptions[t].start=this.addTime(s,this.config.range,!1,!0),a;if("static"===this.config.timeType){let e,n;e=void 0!==this.config.start_time?this.config.start_time.split(":").map(Number):[0,0],n=void 0!==this.config.end_time?this.config.end_time.split(":").map(Number):[24,0],i=new Date(this.config.start).setHours(e[0],e[1]),s=new Date(this.config.end).setHours(n[0],n[1]),i=this.addTime(i,this.config.l[t].offset),s=this.addTime(s,this.config.l[t].offset)}else{if(this.config.relativeEnd=this.config.relativeEnd||"now","now"===this.config.relativeEnd)n=new Date(this.now);else if(-1!==this.config.relativeEnd.indexOf("minute")){const t=parseInt(this.config.relativeEnd,10)||1;n=new Date(this.now),n.setMinutes(Math.floor(n.getMinutes()/t)*t+t),n.setSeconds(0),n.setMilliseconds(0)}else if(-1!==this.config.relativeEnd.indexOf("hour")){const t=parseInt(this.config.relativeEnd,10)||1;n=new Date(this.now),n.setHours(Math.floor(n.getHours()/t)*t+t),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0)}else"today"===this.config.relativeEnd?(n=new Date(this.now),n.setDate(n.getDate()+1),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0)):"weekUsa"===this.config.relativeEnd?(n=new Date(this.now),n.setDate(n.getDate()-n.getDay()+7),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0)):"weekEurope"===this.config.relativeEnd?(n=new Date(this.now),0===n.getDay()?n.setDate(n.getDate()+1):n.setDate(n.getDate()-n.getDay()+8),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0)):"month"===this.config.relativeEnd?(n=new Date(this.now),n.setMonth(n.getMonth()+1),n.setDate(1),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0)):"year"===this.config.relativeEnd&&(n=new Date(this.now),n.setFullYear(n.getFullYear()+1),n.setMonth(0),n.setDate(1),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0));this.config.range=this.config.range||"30m",s=this.addTime(n,this.config.l[t].offset),i=this.addTime(s,this.config.range,!1,!0)}return a={start:i,end:s,ignoreNull:void 0===this.config.l[t].ignoreNull?this.config.ignoreNull:this.config.l[t].ignoreNull,aggregate:this.config.l[t].aggregate||this.config.aggregate||"minmax",from:!1,ack:!1,q:!1,addID:!1},"step"===this.config.aggregateType?a.step=1e3*this.config.aggregateSpan:"count"===this.config.aggregateType&&(a.count=this.config.aggregateSpan||this.chartRef.current.clientWidth/10),this.navOptions[t]=a,a}readOneChart(t,e,s,i){const n=this.getStartStop(s);n.instance=e,n.sessionId=this.sessionId,this.config.l[s].yOffset=parseFloat(this.config.l[s].yOffset)||0,console.log(new Date(n.start)+" - "+new Date(n.end)),this.socket.getHistoryEx(t,n).then(t=>{if(this.sessionId&&t.sessionId&&t.sessionId!==this.sessionId)return console.warn("Ignore request with sessionId=".concat(t.sessionId,", actual is ").concat(this.sessionId));if(t&&t.values){n.yOffset=this.config.l[s].yOffset;const e=t.values,i=this.seriesData[s];for(let t=0;t<e.length;t++)"true"===e[t].val||!0===e[t].val?e[t].val=1:"false"!==e[t].val&&!1!==e[t].val||(e[t].val=0),"string"===typeof e[t].val&&(e[t].val=parseFloat(e[t].val)),i.push({value:[e[t].ts,null!==e[t].val?e[t].val+n.yOffset:null]});i.length?(i[0][0]>n.start&&i.unshift({value:[n.start,null]}),i[i.length-1][0]<n.end&&i.push({value:[n.end,null]})):(i.push({value:[n.start,null]}),i.push({value:[n.end,null]})),t.values=null,t=null}return Promise.resolve()}).catch(t=>t&&console.error(t)).then(()=>i(t,s))}_readOneLine(t,e){return this.socket.getObject(this.config.l[t].id).then(e=>(e&&e.common&&(this.config.l[t].name=this.config.l[t].name||e.common.name,this.config.l[t].unit=this.config.l[t].unit||(e.common.unit?e.common.unit.replace("\ufffd","\xb0"):""),this.config.l[t].type=e.common.type,"auto"===this.config.l[t].chartType&&(this.config.l[t].chartType="boolean"===e.common.type?"steps":"line",this.config.l[t].aggregate="boolean"===e.common.type?"onchange":"minmax")),Promise.resolve())).catch(e=>(console.error("Cannot read object ".concat(this.config.l[t].id,": ").concat(e)),Promise.resolve())).then(()=>{this.config.l[t].name=this.config.l[t].name||this.config.l[t].id,this.config.l[t].unit=this.config.l[t].unit||"","auto"===this.config.l[t].chartType&&(this.config.l[t].chartType="line",this.config.l[t].aggregate="minmax"),"object"===typeof this.config.l[t].name&&(this.config.l[t].name=this.config.l[t].name[this.state.systemConfig.language]||this.config.l[t].name.en),this.readOneChart(this.config.l[t].id,this.config.l[t].instance,t,e)})}_readData(t,e){if((e=e||0)>=this.config.l.length)return t();""!==this.config.l[e]&&void 0!==this.config.l[e]&&this.seriesData.push([]),this._readOneLine(e,()=>setTimeout(()=>this._readData(t,e+1),10))}readTicks(t){if(this.config.ticks){const e=0,s=JSON.parse(JSON.stringify(this.getStartStop(e)));s.instance=this.config.l[e].instance,s.sessionId=this.sessionId,s.aggregate="onchange",console.log("Ticks: "+new Date(s.start)+" - "+new Date(s.end)),this.socket.getHistoryEx(this.config.ticks,s).then(t=>{if(this.sessionId&&t.sessionId&&t.sessionId!==this.sessionId)return console.warn("Ignore request with sessionId=".concat(t.sessionId,", actual is ").concat(this.sessionId));if(t&&t.values){const e=this.ticks||[];this.ticks&&this.ticks.length&&this.ticks.splice(0,this.ticks.length);const i=t.values;for(let t=0;t<i.length;t++)null!==i[t].val&&e.push({value:[i[t].ts,i[t].val]});e.length?(e[0][0]>s.start&&e.unshift({value:[s.start,""]}),e[e.length-1][0]<s.end&&e.push({value:[s.end,""]})):(e.push({value:[s.start,""]}),e.push({value:[s.end,""]})),t.values=null,t=null,this.ticks=e}return Promise.resolve()}).catch(t=>console.error(t)).then(()=>t&&t(this.ticks))}else t(null)}readValue(t,e,s){this.socket.getState(t).then(t=>{s(e,t&&parseFloat(t.val)||0)}).catch(t=>{console.error(t),s(e,0)})}readMarkings(t,e){if(e=e||0,!this.config.m||!this.config.m.length||e>=this.config.m.length)return t();!this.config.m[e].oid&&this.config.m[e].v&&parseFloat(this.config.m[e].v).toString()!==this.config.m[e].v&&this.config.m[e].v.includes(".")?(this.subscribes.includes(this.config.m[e].v)||this.subscribes.push(this.config.m[e].v),this.readValue(this.config.m[e].v,e,(s,i)=>{this.config.m[s].oid=this.config.m[s].v,this.config.m[s].v=i,!this.config.m[e].oidl&&this.config.m[e].vl&&parseFloat(this.config.m[e].vl).toString()!==this.config.m[e].vl&&this.config.m[e].vl.includes(".")?(this.subscribes.includes(this.config.m[e].vl)||this.subscribes.push(this.config.m[e].vl),this.readValue(this.config.m[e].vl,e,(s,i)=>{this.config.m[s].oidl=this.config.m[s].vl,this.config.m[s].vl=i,setTimeout(()=>this.readMarkings(t,e+1),0)})):setTimeout(()=>this.readMarkings(t,e+1),0)})):!this.config.m[e].oidl&&this.config.m[e].vl&&parseFloat(this.config.m[e].vl).toString()!==this.config.m[e].vl&&this.config.m[e].vl.includes(".")?(this.subscribes.includes(this.config.m[e].vl)||this.subscribes.push(this.config.m[e].vl),this.readValue(this.config.m[e].vl,e,(s,i)=>{this.config.m[s].oidl=this.config.m[s].vl,this.config.m[s].vl=i,setTimeout(()=>this.readMarkings(t,e+1),0)})):setTimeout(()=>this.readMarkings(t,e+1),0)}subscribeAll(t,e,s){s=s||0,!t||!t.length||s>=t.length?e():(this.socket.subscribeState(t[s],this.onStateChange),setTimeout(()=>this.subscribeAll(t,e,s+1),0))}addTime(t,e,s,i){return t=new Date(t),"string"===typeof e?"m"===e[1]?(e=parseInt(e,10),t.setMonth(s?t.getMonth()+e:t.getMonth()-e),t=t.getTime()):"y"===e[1]?(e=parseInt(e,10),t.setFullYear(s?t.getFullYear()+e:t.getFullYear()-e),t=t.getTime()):(t=t.getTime(),i?s?t+=6e4*(parseInt(e,10)||0):t-=6e4*(parseInt(e,10)||0):s?t+=1e3*(parseInt(e,10)||0):t-=1e3*(parseInt(e,10)||0)):(t=t.getTime(),i?s?t+=6e4*(parseInt(e,10)||0):t-=6e4*(parseInt(e,10)||0):s?t+=1e3*(parseInt(e,10)||0):t-=1e3*(parseInt(e,10)||0)),t}readData(){this.now=Date.now(),this.sessionId=this.sessionId||0,this.sessionId++,this.sessionId>16777215&&(this.sessionId=1),this.config.l?(this.onReadingFunc&&this.onReadingFunc(!0),this._readData(()=>this.readTicks(t=>this.readMarkings(()=>{this.subscribed?this.onUpdateFunc(this.seriesData):(this.subscribed=!0,this.subscribeAll(this.subscribes,()=>this.onUpdateFunc(this.seriesData)))})))):(this.onErrorFunc&&this.onErrorFunc("No config provided"),this.onReadingFunc&&this.onReadingFunc(!1))}},E=s(427),k=s(205),M=s.n(k),R=s(11),O=s.n(R);s(314),s(335),s(344),s(345),s(362),s(363),s(372),s(381);function F(t){return t<10?"0"+t:t}class C extends n.a.Component{constructor(t){super(t),this.onResize=()=>{this.timerResize&&clearTimeout(this.timerResize),this.timerResize=setTimeout(()=>{this.timerResize=null,this.componentDidUpdate()})},this.state={chartHeight:300,chartWidth:500},this.echartsReact=n.a.createRef(),this.divRef=n.a.createRef(),this.chart={}}componentDidMount(){window.addEventListener("resize",this.onResize)}componentWillUnmount(){window.removeEventListener("resize",this.onResize)}convertData(t){const e=this.props.data[t];return e.length?(this.chart.min||(this.chart.min=e[0].ts,this.chart.max=e[e.length-1].ts),e):[]}getSeries(){return this.props.config.l.map((t,e)=>({xAxisIndex:0,type:"line",showSymbol:!1,hoverAnimation:!0,animation:!1,data:this.convertData(e),lineStyle:{color:t.color}}))}getOption(){console.log(JSON.stringify(this.props.config,null,2));let t={};this.props.config.titlePos&&this.props.config.titlePos.split(";").forEach(e=>{const s=e.split(":");t[s[0].trim()]=parseInt(s[1].trim(),10)});const e={backgroundColor:"transparent",animation:!this.props.config.noAnimation&&!this.props.config.noLoader,title:{text:this.props.config.title||"",textStyle:{fontSize:this.props.config.titleSize?parseInt(this.props.config.titleSize,10):void 0,color:this.props.config.titleColor||void 0},padding:[8,0,0,90],textVerticalAlign:t.bottom?"bottom":"top",textAlign:50===t.left?"center":-5===t.right?"right":"left",top:35===t.top?0:50===t.top?"50%":void 0,left:50===t.left?"50%":65===t.left?0:void 0,bottom:t.bottom?t.bottom>0?t.bottom+20:t.bottom:void 0,right:5===t.right?25:void 0},grid:{backgroundColor:this.props.config.bg_custom||"transparent",show:!!this.props.config.bg_custom,left:80,top:8,right:25,bottom:40},tooltip:this.props.config.export?{trigger:"axis",formatter:t=>{const e=new Date(t[0].value[0]),s=t.map(t=>null===t.value[1]?"null":t.value[1]+this.props.config.l[t.seriesIndex].unit);return"".concat(e.toLocaleString(),".").concat((i=e.getMilliseconds(),i<10?"00"+i:i<100?"0"+i:i),": ").concat(s.join(", "));var i},axisPointer:{animation:!0}}:void 0,xAxis:[{type:"time",splitLine:{show:!this.props.config.grid_hideX,lineStyle:this.props.config.grid_color?{color:this.props.config.grid_color}:void 0},min:this.chart.min,max:this.chart.max,axisTick:{alignWithLabel:!0},axisLabel:{formatter:(t,e)=>{const s=new Date(t);return this.chart.withSeconds?F(s.getHours())+":"+F(s.getMinutes())+":"+F(s.getSeconds()):this.chart.withTime?F(s.getHours())+":"+F(s.getMinutes())+"\n"+F(s.getDate())+"."+F(s.getMonth()+1):F(s.getDate())+"."+F(s.getMonth()+1)+"\n"+s.getFullYear()},color:this.props.config.x_labels_color||void 0}}],yAxis:[{type:"value",boundaryGap:[0,"100%"],splitLine:{show:!this.props.config.grid_hideY,lineStyle:this.props.config.grid_color?{color:this.props.config.grid_color}:void 0},axisLabel:{formatter:"{value}"+this.props.config.l[0].unit,color:this.props.config.y_labels_color||void 0},axisTick:{alignWithLabel:!0}}],toolbox:this.props.config.export?{left:"right",feature:{saveAsImage:{title:this.props.t("Save as image"),show:!0}}}:void 0,series:this.getSeries()};return this.props.config.grid_color||(e.yAxis.forEach(t=>delete t.splitLine.lineStyle),e.xAxis.forEach(t=>delete t.splitLine.lineStyle)),e}static getDerivedStateFromProps(t,e){return t.data!==e.data?{data:t.data}:null}updateChart(t,e,s,i){t&&(this.start=t),e&&(this.end=e),t=t||this.start,e=e||this.end,this.readTimeout&&clearTimeout(this.readTimeout),this.readTimeout=setTimeout(()=>{this.readTimeout=null;const n=this.chart.max-this.chart.min;n!==this.chart.diff&&(this.chart.diff=n,this.chart.withTime=this.chart.diff<6048e5,this.chart.withSeconds=this.chart.diff<18e5),s?this.readHistory(t,e).then(t=>{"function"===typeof this.echartsReact.getEchartsInstance&&this.echartsReact.getEchartsInstance().setOption({series:[{data:this.convertData(t)}],xAxis:{min:this.chart.min,max:this.chart.max}}),i&&i()}):("function"===typeof this.echartsReact.getEchartsInstance&&this.echartsReact.getEchartsInstance().setOption({series:[{data:this.convertData()}],xAxis:{min:this.chart.min,max:this.chart.max}}),i&&i())},400)}setNewRange(t){this.chart.diff=this.chart.max-this.chart.min,this.chart.withTime=this.chart.diff<6048e5,this.chart.withSeconds=this.chart.diff<18e5,"absolute"!==this.state.relativeRange?this.setState({relativeRange:"absolute"}):(this.echartsReact.getEchartsInstance().setOption({xAxis:{min:this.chart.min,max:this.chart.max}}),t&&this.updateChart(this.chart.min,this.chart.max,!0))}setRelativeInterval(t,e,s){e||(window.localStorage.setItem("App.relativeRange",t),this.setState({relativeRange:t}));const i=new Date;i.getMilliseconds()&&i.setMilliseconds(1e3),i.getSeconds()&&i.setSeconds(60),this.chart.max=i.getTime(),"day"===t?(i.setHours(0),i.setMinutes(0),this.chart.min=i.getTime()):"week"===t?(i.setHours(0),i.setMinutes(0),i.setFullYear(i.getFullYear()-1),i.getDay()?i.setDate(i.getDate()-i.getDay()-1):i.setDate(i.getDate()-6),this.chart.min=i.getTime()):"2weeks"===t?(i.setHours(0),i.setMinutes(0),i.setFullYear(i.getFullYear()-1),i.getDay()?i.setDate(i.getDate()-i.getDay()-8):i.setDate(i.getDate()-13),this.chart.min=i.getTime()):"month"===t?(i.setHours(0),i.setMinutes(0),i.setDate(1),this.chart.min=i.getTime()):"year"===t?(i.setHours(0),i.setMinutes(0),i.setDate(1),i.setMonth(0),this.chart.min=i.getTime()):"12months"===t?(i.setHours(0),i.setMinutes(0),i.setFullYear(i.getFullYear()-1),this.chart.min=i.getTime()):(t=parseInt(t,10),this.chart.min=this.chart.max-6e4*t),this.updateChart(this.chart.min,this.chart.max,!0,s)}installEventHandlers(){this.echartsReact.getEchartsInstance().getZr()}renderChart(){if(this.state.data){const t=this.getOption();return n.a.createElement(M.a,{ref:t=>this.echartsReact=t,echarts:O.a,option:t,notMerge:!0,lazyUpdate:!0,theme:"dark"===this.props.themeType?"dark":"",style:{height:this.state.chartHeight+"px",width:"100%"},opts:{renderer:"svg"},onEvents:{rendered:t=>{this.installEventHandlers()}}})}return n.a.createElement(E.a,null)}componentDidUpdate(){if(this.divRef.current){const t=this.divRef.current.offsetWidth,e=this.divRef.current.offsetHeight;this.state.chartHeight!==e&&setTimeout(()=>this.setState({chartHeight:e,chartWidth:t}),10)}}render(){return this.divRef.current||setTimeout(()=>this.forceUpdate(),10),n.a.createElement("div",{ref:this.divRef,className:this.props.classes.chart,style:{background:this.props.config.window_bg||void 0}},this.renderChart())}}var N=Object(l.a)()(Object(h.a)(t=>({chart:{maxHeight:"100%",maxWidth:"100%",width:"100%",height:"100%",overflow:"hidden"}}))(C));class H extends i.Component{constructor(t){super(t);const e=this.createTheme();this.state={connected:!1,reading:!0,seriesData:null,noLoader:d.a.parseQuery(window.location.search).noLoader||d.a.parseQuery((window.location.hash||"").replace(/^#/,"")).noLoader||!1,theme:e,themeName:this.getThemeName(e),themeType:this.getThemeType(e)},this.divRef=n.a.createRef();const i={en:s(387),de:s(388),ru:s(389),pt:s(390),nl:s(391),fr:s(392),it:s(393),es:s(394),pl:s(395),"zh-cn":s(396)};p.a.setTranslations(i);try{this.isIFrame=window.self!==window.top}catch(a){this.isIFrame=!0}this.socket=new w.a({name:window.adapterName,doNotLoadAllObjects:!0,onProgress:t=>{t===v.PROGRESS.CONNECTING?this.setState({connected:!1}):(v.PROGRESS.READY,this.setState({connected:!0}))},onReady:(t,e)=>{p.a.setLanguage(this.socket.systemLang),this.socket.getSystemConfig().then(t=>{var e,s;this.systemLang=(null===t||void 0===t||null===(e=t.common)||void 0===e?void 0:e.language)||"en",this.isFloatComma=(null===t||void 0===t||null===(s=t.common)||void 0===s?void 0:s.isFloatComma)||!1,this.chartData=new I(this.socket),this.chartData.onError(t=>this.showError(p.a.t(t))),this.chartData.onReading(t=>this.setState({reading:t})),this.chartData.onUpdate(t=>this.setState({seriesData:t}))})},onError:t=>{console.error(t),this.showError(t)}})}componentWillUnmount(){this.chartData&&this.chartData.destroy()}createTheme(t=""){return T()(d.a.getThemeName(t))}getThemeName(t){return t.name}getThemeType(t){return t.palette.type}showError(t){this.setState({errorText:t})}renderError(){return this.state.errorText?n.a.createElement(y.a,{text:this.state.errorText,onClose:()=>this.setState({errorText:""})}):null}render(){if(!this.state.connected||!this.state.seriesData)return this.state.noLoader?null:n.a.createElement(r.a,{theme:this.state.theme},n.a.createElement(m.a,{theme:this.state.themeType}));this.state.seriesData&&console.log("seriesData: "+JSON.stringify(this.state.seriesData));const t=this.chartData.getConfig();return n.a.createElement(r.a,{theme:this.state.theme},n.a.createElement("div",{ref:this.divRef,className:this.props.classes.root,style:{width:t.width,height:t.height,background:this.state.theme.palette.background.default,color:this.state.theme.palette.text.primary}},n.a.createElement(N,{socket:this.socket,t:p.a.t,noAnimation:this.state.noLoader,data:this.state.seriesData,config:this.chartData.getConfig(),lang:p.a.getLanguage(),themeType:this.state.themeType}),this.renderError()))}}var _=Object(l.a)()(Object(h.a)(t=>({root:{width:"100%",height:"100%"}}))(Object(c.a)(H)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var L=s(141);window.adapterName="echarts-index";let A=d.a.getThemeName();console.log("iobroker."+window.adapterName+"@"+L.a+' using theme "'+A+'"'),window.location.host,function t(){return o.a.render(n.a.createElement(r.a,{theme:T()(A)},n.a.createElement(_,{onThemeChange:e=>{A=e,t()}})),document.getElementById("root"))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(t=>{t.unregister()})}},[[216,1,2]]]);
//# sourceMappingURL=main.f114de38.chunk.js.map