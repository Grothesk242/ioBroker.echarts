(this["webpackJsonpecharts.index"]=this["webpackJsonpecharts.index"]||[]).push([[0],{152:function(e){e.exports=JSON.parse('{"a":"0.0.1"}')},233:function(e,t,i){e.exports=i(441)},238:function(e,t,i){},429:function(e){e.exports=JSON.parse('{"Save as image":"Save as image","Reset pan and zoom":"Reset pan and zoom"}')},430:function(e){e.exports=JSON.parse('{"Save as image":"Als Bild speichern","Reset pan and zoom":"Verschiebung und Zoomen zur\xfccksetzen"}')},431:function(e){e.exports=JSON.parse('{"Save as image":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u0430\u043a \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435","Reset pan and zoom":"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0441\u0434\u0432\u0438\u0433 \u0438 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"}')},432:function(e){e.exports=JSON.parse('{"Save as image":"Salvar como imagem","Reset pan and zoom":"Redefinir panor\xe2mica e zoom"}')},433:function(e){e.exports=JSON.parse('{"Save as image":"Bewaar als afbeelding","Reset pan and zoom":"Stel pannen en zoomen opnieuw in"}')},434:function(e){e.exports=JSON.parse('{"Save as image":"Enregistrer comme image","Reset pan and zoom":"R\xe9initialiser le panoramique et le zoom"}')},435:function(e){e.exports=JSON.parse('{"Save as image":"Salva come immagine","Reset pan and zoom":"Reimposta panoramica e zoom"}')},436:function(e){e.exports=JSON.parse('{"Save as image":"Guardar como imagen","Reset pan and zoom":"Restablecer panor\xe1mica y zoom"}')},437:function(e){e.exports=JSON.parse('{"Save as image":"Zapisz jako obraz","Reset pan and zoom":"Zresetuj przesuwanie i powi\u0119kszanie"}')},438:function(e){e.exports=JSON.parse('{"Save as image":"\u53e6\u5b58\u4e3a\u56fe\u7247","Reset pan and zoom":"\u91cd\u7f6e\u5e73\u79fb\u548c\u7f29\u653e"}')},441:function(e,t,i){"use strict";i.r(t);var n=i(0),o=i.n(n),a=i(21),s=i.n(a),r=i(466),c=(i(472),i(471),i(238),i(70)),l=i(71),h=i(116),u=i(114),g=i(10),d=i(163),f=i(473),m=i(468),p=i(41),v=i.n(p),y=i(217),w=i.n(y),b=i(33),D=i.n(b),T=i(117),S=i.n(T),z=i(218),k=i.n(z),I=i(112),x=i.n(I);i(263);function R(e,t){var i={},n={true:!0,false:!1,null:null};return e.replace(/\+/g," ").split("&").forEach((function(e){var o,a=e.split("="),s=decodeURIComponent(a[0]),r=0,c=s.split("]["),l=c.length-1;if(/\[/.test(c[0])&&/]$/.test(c[l])?(c[l]=c[l].replace(/]$/,""),l=(c=c.shift().split("[").concat(c)).length-1):l=0,2===a.length)if(o=decodeURIComponent(a[1]),t&&(o=o&&!isNaN(o)&&+o+""===o?+o:"undefined"===o?void 0:void 0!==n[o]?n[o]:o),l)for(var h=i;r<=l;r++)h=h[s=""===c[r]?h.length:c[r]]=r<l?h[s]||(c[r+1]&&isNaN(c[r+1])?{}:[]):o;else"[object Array]"===Object.prototype.toString.call(i[s])?i[s].push(o):!{}.hasOwnProperty.call(i,s)?i[s]=o:i[s]=[i[s],o];else s&&(i[s]=t?void 0:"")})),i}function O(e){if(e.lines&&(e.l=JSON.parse(JSON.stringify(e.lines)),delete e.lines),e._ids){var t=e._ids?e._ids.split(";"):[],i=e._colors?e._colors.split(";"):[],n=e._names?e._names.split(";"):[],o=e._units?e._units.split(";"):[];e.l=[];for(var a=0;a<t.length;a++)e.l.push({id:t[a],offset:0,name:n[a]||"",aggregate:"onchange",color:i[a]||"blue",thickness:e.strokeWidth||1,shadowsize:e.strokeWidth||1,min:e.min||"",max:e.max||"",unit:o[a]||""});e.aggregateType="step",e.aggregateSpan=300,e.relativeEnd="now"}if(e.l)for(var s=0;s<e.l.length;s++)e.l[s].art&&(e.l[s].aggregate=e.l[s].art,delete e.l[s].art),e.instance&&!e.l[s].instance&&(e.l[s].instance=e.instance);return e.l=e.l||[],e.l.length||e.l.push({id:"",unit:""}),e.width=e.width||"100%",e.height=e.height||"100%",e.timeFormat=e.timeFormat||"%H:%M:%S %e.%m.%y",e.useComma="true"===e.useComma||!0===e.useComma,e.zoom="true"===e.zoom||!0===e.zoom,e.export="true"===e.export||!0===e.export,e.grid_hideX="true"===e.grid_hideX||!0===e.grid_hideX,e.grid_hideY="true"===e.grid_hideY||!0===e.grid_hideY,e.hoverDetail="true"===e.hoverDetail||!0===e.hoverDetail,e.noLoader="true"===e.noLoader||!0===e.noLoader,e.noedit="true"===e.noedit||!0===e.noedit,e.animation=parseInt(e.animation)||0,e.afterComma=void 0===e.afterComma?2:parseInt(e.afterComma,10),e.timeType=e.timeType||"relative",e}var C=function(){function e(t,i,n){var o=this;Object(c.a)(this,e),this.onHashChange=function(){o.lastHash!==window.location.hash&&(o.lastHash=window.location.hash,o.analyseAndLoadConfig())},this.onPresetUpdate=function(e,t){e===o.preset&&(o.presetUpdateTimeout&&clearTimeout(o.presetUpdateTimeout),o.presetUpdateTimeout=setTimeout((function(){var e;o.presetUpdateTimeout=null,e=O(t?t.native.data:{}),JSON.stringify(e)!==JSON.stringify(o.config)&&(o.config=e,o.updateInterval&&clearInterval(o.updateInterval),o.updateInterval=null,!o.config.live||o.zoomData&&o.zoomData.stopLive||(o.updateInterval=setInterval((function(){return o.readData()}),1e3*o.config.live)),o.readData())}),100))},n=Object.assign({updateTimeout:300},n||{}),this.socket=t,this.updateTimeout=n.updateTimeout||300,this.seriesData=[],this.ticks=null,this.liveInterval=null,this.navOptions={},this.sessionId=1,this.updateInterval=null,this.presetSubscribed=!1,this.onUpdateFunc=null,this.onReadingFunc=null,this.onErrorFunc=null,this.objectPromises={},this.lastHash=window.location.hash,this.debug=!1,this.zoomData=null,i||(this.onHashInstalled=!0,window.addEventListener("hashchange",this.onHashChange,!1)),this.socket.getSystemConfig().then((function(e){return o.systemConfig=e&&e.common?e.common:{},o.analyseAndLoadConfig(i)}))}return Object(l.a)(e,[{key:"analyseAndLoadConfig",value:function(e){var t=this;if(e)"string"===typeof e?this.preset=e:this.config=e;else{var i=v.a.parseQuery(window.location.search);if(this.debug=!0===i.debug||"true"===i.debug||1===i.debug||"1"===i.debug,i.preset)this.preset=i.preset;else{var n=Object.assign(R((window.location.search||"").toString().replace(/^\?/,""),!0),R((window.location.hash||"").toString().replace(/^#/,""),!0));this.config=O(n)}}this.seriesData=[],this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.preset?(this.preset.startsWith("echarts.")&&this.preset.startsWith("flot.")&&this.preset.includes(".")||(this.preset="echarts.0."+this.preset),this.socket.getObject(this.preset).then((function(e){if(!e||!e.native||!e.native.data||"chart"!==e.type)return console.error("[ChartModel] Invalid object ".concat(t.preset,": ").concat(JSON.stringify(e)));t.config=O(e.native.data),t.config.useComma=void 0===t.config.useComma?!0===t.systemConfig.isFloatComma||"true"===t.systemConfig.isFloatComma:"true"===t.config.useComma||!0===t.config.useComma,t.config.lang=t.systemConfig.language,t.config.live=parseInt(t.config.live,10)||0,t.config.debug=t.debug,t.readData(),t.presetSubscribed!==t.preset&&(t.presetSubscribed&&t.socket.unsubscribeObject(t.presetSubscribed,t.onPresetUpdate),t.presetSubscribed=t.preset,t.socket.subscribeObject(t.preset,t.onPresetUpdate)),!t.config.live||t.zoomData&&t.zoomData.stopLive||(t.updateInterval=setInterval((function(){return t.readData()}),1e3*t.config.live))}))):(this.config.useComma=void 0===this.config.useComma?!0===this.systemConfig.isFloatComma||"true"===this.systemConfig.isFloatComma:"true"===this.config.useComma||!0===this.config.useComma,this.config.lang=this.systemConfig.language,this.config.live=parseInt(this.config.live,10)||0,this.config.debug=this.debug,this.readData(),!this.config.live||this.zoomData&&this.zoomData.stopLive||(this.updateInterval=setInterval((function(){return t.readData()}),1e3*this.config.live)))}},{key:"setNewRange",value:function(e){var t=this;if(this.debug&&console.log("[ChartModel] [".concat((new Date).toISOString(),"] setNewRange: ").concat(JSON.stringify(e))),e)if(e.stopLive)this.zoomData=this.zoomData||{},this.zoomData.stopLive=!0,this.updateInterval&&(console.log("Clear interval"),clearInterval(this.updateInterval),this.updateInterval=null);else{var i=this.zoomData&&this.zoomData.stopLive;i&&delete this.zoomData.stopLive,this.zoomData&&JSON.stringify(this.zoomData)===JSON.stringify(e)?i&&(this.zoomData.stopLive=!0):(this.zoomData=e,i&&(this.zoomData.stopLive=!0),this.readOnZoomTimeout&&clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=setTimeout((function(){t.readOnZoomTimeout=null,t.readData()}),this.updateTimeout))}else this.zoomData&&(this.zoomData=null,this.readOnZoomTimeout&&clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=setTimeout((function(){t.readOnZoomTimeout=null,!t.config.live||t.zoomData&&t.zoomData.stopLive||(console.log("Restore update"),t.updateInterval&&clearInterval(t.updateInterval),t.updateInterval=setInterval((function(){return t.readData()}),1e3*t.config.live)),t.readData()}),this.updateTimeout))}},{key:"destroy",value:function(){this.readOnZoomTimeout&&(clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=null),this.presetUpdateTimeout&&(clearTimeout(this.presetUpdateTimeout),this.presetUpdateTimeout=null),this.presetSubscribed&&(this.socket.unsubscribeObject(this.presetSubscribed,this.onPresetUpdate),this.presetSubscribed=null),this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.onHashInstalled&&window.removeEventListener("hashchange",this.onHashChange,!1),this.onHashInstalled=!1}},{key:"onUpdate",value:function(e){this.onUpdateFunc=e}},{key:"onReading",value:function(e){this.onReadingFunc=e}},{key:"onError",value:function(e){this.onErrorFunc=e}},{key:"getConfig",value:function(){return this.config}},{key:"getStartStop",value:function(e,t){var i,n,o,a={};if(this.config.l[e].offset=this.config.l[e].offset||0,"string"===typeof this.config.range&&this.config.range.includes("m")&&this.config.l.length>1)for(var s=parseInt(this.config.range,10)||1,r=0;r<this.config.l.length;r++)if(this.config.l[r].offset&&0!==this.config.l[r].offset){o=this.addTime(this.now,this.config.l[0].offset);var c=new Date(o);c.setMonth(c.getMonth()-s),this.config.range=Math.floor((o-c.getTime())/6e4)+"";break}if(t)return this.zoomData?(n=this.zoomData.start,i=this.zoomData.end):n=(i=this.addTime(this.now,this.config.l[e].offset))-t,a={start:n,end:i,ignoreNull:void 0===this.config.l[e].ignoreNull?this.config.ignoreNull:this.config.l[e].ignoreNull,aggregate:this.config.l[e].aggregate||this.config.aggregate||"minmax",count:1,from:!1,ack:!1,q:!1,addID:!1},this.config.start=this.addTime(i,this.config.range,!1,!0),this.config.end=i,a;if(this.zoomData)n=this.zoomData.start,i=this.zoomData.end;else if("static"===this.config.timeType){var l,h;l=void 0!==this.config.start_time?this.config.start_time.split(":").map(Number):[0,0],h=void 0!==this.config.end_time?this.config.end_time.split(":").map(Number):[24,0],n=new Date(this.config.start).setHours(l[0],l[1]),i=new Date(this.config.end).setHours(h[0],h[1]),n=this.addTime(n,this.config.l[e].offset),i=this.addTime(i,this.config.l[e].offset)}else{if(this.config.relativeEnd=this.config.relativeEnd||"now","now"===this.config.relativeEnd)o=new Date(this.now);else if(-1!==this.config.relativeEnd.indexOf("minute")){var u=parseInt(this.config.relativeEnd,10)||1;(o=new Date(this.now)).setMinutes(Math.floor(o.getMinutes()/u)*u+u),o.setSeconds(0),o.setMilliseconds(0)}else if(-1!==this.config.relativeEnd.indexOf("hour")){var g=parseInt(this.config.relativeEnd,10)||1;(o=new Date(this.now)).setHours(Math.floor(o.getHours()/g)*g+g),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)}else"today"===this.config.relativeEnd?((o=new Date(this.now)).setDate(o.getDate()+1),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)):"weekUsa"===this.config.relativeEnd?((o=new Date(this.now)).setDate(o.getDate()-o.getDay()+7),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)):"weekEurope"===this.config.relativeEnd?(0===(o=new Date(this.now)).getDay()?o.setDate(o.getDate()+1):o.setDate(o.getDate()-o.getDay()+8),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)):"month"===this.config.relativeEnd?((o=new Date(this.now)).setMonth(o.getMonth()+1),o.setDate(1),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)):"year"===this.config.relativeEnd&&((o=new Date(this.now)).setFullYear(o.getFullYear()+1),o.setMonth(0),o.setDate(1),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0));this.config.range=this.config.range||"30m",i=this.addTime(o,this.config.l[e].offset),n=this.addTime(i,this.config.range,!1,!0)}return a={start:n,end:i,ignoreNull:void 0===this.config.l[e].ignoreNull?this.config.ignoreNull:this.config.l[e].ignoreNull,aggregate:this.config.l[e].aggregate||this.config.aggregate||"minmax",from:!1,ack:!1,q:!1,addID:!1},"step"===this.config.aggregateType?a.step=1e3*this.config.aggregateSpan:"count"===this.config.aggregateType&&(a.count=this.config.aggregateSpan||this.chartRef.current.clientWidth/10),this.config.start=n,this.config.end=i,a}},{key:"readOneChart",value:function(e,t,i,n){var o=this,a=this.getStartStop(i);a.instance=t,a.sessionId=this.sessionId,this.config.l[i].yOffset=parseFloat(this.config.l[i].yOffset)||0,this.debug&&console.log("[ChartModel] "+new Date(a.start)+" - "+new Date(a.end)),this.socket.getHistoryEx(e,a).then((function(e){if(o.sessionId&&e.sessionId&&e.sessionId!==o.sessionId)return console.warn("[ChartModel] Ignore request with sessionId=".concat(e.sessionId,", actual is ").concat(o.sessionId));if(e&&e.values){a.yOffset=o.config.l[i].yOffset;var t=e.values;o.seriesData[i]=[];for(var n=o.seriesData[i],s=0;s<t.length;s++)"true"===t[s].val||!0===t[s].val?t[s].val=1:"false"!==t[s].val&&!1!==t[s].val||(t[s].val=0),"string"===typeof t[s].val&&(t[s].val=parseFloat(t[s].val)),n.push({value:[t[s].ts,null!==t[s].val?t[s].val+a.yOffset:null]});n.length?(n[0][0]>a.start&&n.unshift({value:[a.start,null]}),n[n.length-1][0]<a.end&&n.push({value:[a.end,null]})):(n.push({value:[a.start,null]}),n.push({value:[a.end,null]})),e.values=null,e=null}return Promise.resolve()})).catch((function(e){return e&&console.error("[ChartModel] "+e)})).then((function(){return n(e,i)}))}},{key:"_readObject",value:function(e){return this.objectPromises[e]||(this.objectPromises[e]=this.socket.getObject(e)),this.objectPromises[e]}},{key:"_readOneLine",value:function(e,t){var i=this;return this._readObject(this.config.l[e].id).then((function(t){return t&&t.common&&(i.config.l[e].name=i.config.l[e].name||t.common.name,i.config.l[e].unit=i.config.l[e].unit||(t.common.unit?t.common.unit.replace("\ufffd","\xb0"):""),i.config.l[e].type=t.common.type,"auto"===i.config.l[e].chartType&&(i.config.l[e].chartType="boolean"===t.common.type?"steps":"line",i.config.l[e].aggregate="boolean"===t.common.type?"onchange":"minmax")),Promise.resolve()})).catch((function(t){return console.error("[ChartModel] Cannot read object ".concat(i.config.l[e].id,": ").concat(t)),Promise.resolve()})).then((function(){i.config.l[e].name=i.config.l[e].name||i.config.l[e].id,i.config.l[e].unit=i.config.l[e].unit||"","auto"===i.config.l[e].chartType&&(i.config.l[e].chartType="line",i.config.l[e].aggregate="minmax"),"object"===typeof i.config.l[e].name&&(i.config.l[e].name=i.config.l[e].name[i.systemConfig.language]||i.config.l[e].name.en),i.readOneChart(i.config.l[e].id,i.config.l[e].instance,e,t)}))}},{key:"_readData",value:function(e,t){var i=this;if((t=t||0)>=this.config.l.length)return e();""!==this.config.l[t]&&void 0!==this.config.l[t]&&this.seriesData.push([]),this._readOneLine(t,(function(){return setTimeout((function(){return i._readData(e,t+1)}),10)}))}},{key:"readTicks",value:function(e){var t=this;if(this.config.ticks){var i=JSON.parse(JSON.stringify(this.getStartStop(0)));i.instance=this.config.l[0].instance,i.sessionId=this.sessionId,i.aggregate="onchange",this.debug&&console.log("[ChartModel] Ticks: "+new Date(i.start)+" - "+new Date(i.end)),this.socket.getHistoryEx(this.config.ticks,i).then((function(e){if(t.sessionId&&e.sessionId&&e.sessionId!==t.sessionId)return console.warn("[ChartModel] Ignore request with sessionId=".concat(e.sessionId,", actual is ").concat(t.sessionId));if(e&&e.values){var n=t.ticks||[];t.ticks&&t.ticks.length&&t.ticks.splice(0,t.ticks.length);for(var o=e.values,a=0;a<o.length;a++)null!==o[a].val&&n.push({value:[o[a].ts,o[a].val]});n.length?(n[0][0]>i.start&&n.unshift({value:[i.start,""]}),n[n.length-1][0]<i.end&&n.push({value:[i.end,""]})):(n.push({value:[i.start,""]}),n.push({value:[i.end,""]})),e.values=null,e=null,t.ticks=n}return Promise.resolve()})).catch((function(e){return console.error("[ChartModel] ".concat(e))})).then((function(){return e&&e(t.ticks)}))}else e(null)}},{key:"readValue",value:function(e,t,i){this.socket.getState(e).then((function(e){i(t,e&&parseFloat(e.val)||0)})).catch((function(e){console.error("[ChartModel] ".concat(e)),i(t,0)}))}},{key:"readMarkings",value:function(e,t){var i=this;if(t=t||0,!this.config.m||!this.config.m.length||t>=this.config.m.length)return e();!this.config.m[t].oid&&this.config.m[t].v&&parseFloat(this.config.m[t].v).toString()!==this.config.m[t].v&&this.config.m[t].v.includes(".")?this.readValue(this.config.m[t].v,t,(function(n,o){i.config.m[n].oid=i.config.m[n].v,i.config.m[n].v=o,!i.config.m[t].oidl&&i.config.m[t].vl&&parseFloat(i.config.m[t].vl).toString()!==i.config.m[t].vl&&i.config.m[t].vl.includes(".")?i.readValue(i.config.m[t].vl,t,(function(n,o){i.config.m[n].oidl=i.config.m[n].vl,i.config.m[n].vl=o,setTimeout((function(){return i.readMarkings(e,t+1)}),0)})):setTimeout((function(){return i.readMarkings(e,t+1)}),0)})):!this.config.m[t].oidl&&this.config.m[t].vl&&parseFloat(this.config.m[t].vl).toString()!==this.config.m[t].vl&&this.config.m[t].vl.includes(".")?this.readValue(this.config.m[t].vl,t,(function(n,o){i.config.m[n].oidl=i.config.m[n].vl,i.config.m[n].vl=o,setTimeout((function(){return i.readMarkings(e,t+1)}),0)})):setTimeout((function(){return i.readMarkings(e,t+1)}),0)}},{key:"addTime",value:function(e,t,i,n){return e=new Date(e),"string"===typeof t?"m"===t[1]?(t=parseInt(t,10),e.setMonth(i?e.getMonth()+t:e.getMonth()-t),e=e.getTime()):"y"===t[1]?(t=parseInt(t,10),e.setFullYear(i?e.getFullYear()+t:e.getFullYear()-t),e=e.getTime()):(e=e.getTime(),n?i?e+=6e4*(parseInt(t,10)||0):e-=6e4*(parseInt(t,10)||0):i?e+=1e3*(parseInt(t,10)||0):e-=1e3*(parseInt(t,10)||0)):(e=e.getTime(),n?i?e+=6e4*(parseInt(t,10)||0):e-=6e4*(parseInt(t,10)||0):i?e+=1e3*(parseInt(t,10)||0):e-=1e3*(parseInt(t,10)||0)),e}},{key:"readData",value:function(){var e=this;this.readOnZoomTimeout&&(clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=null),this.now=Date.now(),this.sessionId=this.sessionId||0,this.sessionId++,this.sessionId>16777215&&(this.sessionId=1),this.config.l?(this.onReadingFunc&&this.onReadingFunc(!0),this.seriesData=[],this._readData((function(){return e.readTicks((function(t){return e.readMarkings((function(){e.onUpdateFunc(e.seriesData)}))}))}))):(this.onErrorFunc&&this.onErrorFunc("No config provided"),this.onReadingFunc&&this.onReadingFunc(!1))}}]),e}(),M=i(469),E=i(221),N=i(27),_=i.n(N),F=(i(265),i(266),i(267),i(268),i(269),i(270),i(271),i(272),i(273),i(274),i(219)),L=i.n(F),j=i(7),H=i.n(j);i(341),i(359),i(363),i(372),i(373),i(389),i(390),i(395),i(404),i(413);function P(e){return e.toString().padStart(2,"0")}var U=function(e){Object(h.a)(i,e);var t=Object(u.a)(i);function i(e){var n;return Object(c.a)(this,i),(n=t.call(this,e)).updateProperties=function(e){if(n.updatePropertiesTimeout=null,"function"===typeof n.echartsReact.getEchartsInstance){n.debug&&console.log("[ChartView ] [".concat((new Date).toISOString(),"] updateProperties"));var t=n.echartsReact.getEchartsInstance();t.clear(),t.setOption(n.getOption(e))}},n.onResize=function(){n.timerResize&&clearTimeout(n.timerResize),n.timerResize=setTimeout((function(){n.timerResize=null,n.componentDidUpdate()}))},n.onMouseMove=function(e){if(n.mouseDown){n.divResetButton.current&&"block"!==n.divResetButton.current.style.display&&(n.divResetButton.current.style.display="block");var t=n.chart.lastX-(e.offsetX-100);n.chart.lastX=e.offsetX-100;var i=n.chart.max-n.chart.min,o=n.state.chartWidth-30-100,a=Math.round(t*i/o);n.chart.min+=a,n.chart.max+=a,n.setNewRange()}},n.onMouseDown=function(e){n.mouseDown=!0,n.chart.lastX=e.offsetX,n.zr&&!n.zr._mousemove&&(n.zr._mousemove=!0,n.zr.on("mousemove",n.onMouseMove)),n.props.config.live&&n.props.onRangeChange&&(console.log("Stop update"),n.props.onRangeChange({stopLive:!0}))},n.onMouseUp=function(){n.mouseDown=!1,n.setNewRange(!0),n.zr&&n.zr._mousemove&&(n.zr._mousemove=!1,n.zr.off("mousemove",n.onMouseMove))},n.onMouseWheel=function(e){var t=n.chart.max-n.chart.min,i=n.state.chartWidth-30-100,o=(e.offsetX-100)/i,a=t-(t*=e.wheelDelta>0?1.1:.9);n.chart.max+=a*(1-o),n.chart.min-=a*o,n.setNewRange(),n.updateDataTimer&&clearTimeout(n.updateDataTimer),n.updateDataTimer=setTimeout((function(){return n.setNewRange(!0)}),1e3)},n.onTouchStart=function(e){e.preventDefault(),n.mouseDown=!0;var t=e.touches||e.originalEvent.touches;t&&(n.chart.lastX=t[t.length-1].pageX,t.length>1?n.chart.lastWidth=Math.abs(t[0].pageX-t[1].pageX):n.chart.lastWidth=null)},n.onTouchEnd=function(e){e.preventDefault(),n.mouseDown=!1,n.setNewRange(!0)},n.onTouchMove=function(e){e.preventDefault();var t=e.touches||e.originalEvent.touches;if(t){var i=t[t.length-1].pageX-100;if(n.mouseDown)if(t.length>1){var o=Math.abs(t[0].pageX-t[1].pageX);if(null!==n.chart.lastWidth&&o!==n.chart.lastWidth){var a=n.chart.max-n.chart.min,s=n.state.chartWidth-30-100,r=o>n.chart.lastWidth?1.1:.9,c=(t[0].pageX>t[1].pageX?t[1].pageX-100+o/2:t[0].pageX-100+o/2)/s,l=a-(a*=r);n.chart.max+=l*(1-c),n.chart.min-=l*c,n.setNewRange()}n.chart.lastWidth=o}else{var h=n.chart.lastX-i,u=n.chart.max-n.chart.min,g=n.state.chartWidth-30-100,d=Math.round(h*u/g);n.chart.min+=d,n.chart.max+=d,n.setNewRange()}n.chart.lastX=i}},n.state={chartHeight:300,chartWidth:500},n.echartsReact=o.a.createRef(),n.divRef=o.a.createRef(),n.divResetButton=o.a.createRef(),n.chart={},_.a.locale(D.a.getLanguage()),n}return Object(l.a)(i,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(e.data===this.state.data)return null;this.updatePropertiesTimeout&&clearTimeout(this.updatePropertiesTimeout),this.updatePropertiesTimeout=setTimeout(this.updateProperties,100,e)}},{key:"convertData",value:function(e,t){var i=(e=e||this.props).data[t];return i&&i.length?((null===this.chart.min||this.chart.min>i[0].value[0])&&(this.chart.min=i[0].value[0]),(null===this.chart.max||this.chart.max<i[i.length-1].value[0])&&(this.chart.max=i[i.length-1].value[0]),i):[]}},{key:"getSeries",value:function(e){var t=this;return e=e||this.props,this.chart.min=null,this.chart.max=null,e.config.l.map((function(i,n){var o={name:i.name,xAxisIndex:0,type:"scatterplot"===i.chartType?"scatter":"line",showSymbol:"scatterplot"===i.chartType||i.points,hoverAnimation:!0,animation:!1,step:"steps"===i.chartType?"start":void 0,smooth:"spline"===i.chartType,data:t.convertData(e,n),itemStyle:{color:i.color},symbolSize:"scatterplot"===i.chartType||i.points?i.symbolSize||3:void 0,symbol:"circle",lineStyle:{width:i.thickness||1,shadowBlur:i.shadowsize?i.shadowsize+1:0,shadowOffsetY:i.shadowsize?i.shadowsize+1:0,shadowColor:i.color,type:i.dashes?"dashed":i.lineStyle||"solid"}};return i.fill&&(o.areaStyle={color:i.color,opacity:parseFloat(i.fill)}),o}))}},{key:"yFormatter",value:function(e,t,i){if("boolean"===(i=i||this.props).config.l[t].type)return e?"TRUE":"FALSE";var n=i.config.l[t].afterComma;return void 0!==n&&null!==n?(e=parseFloat(e),i.config.useComma?e.toFixed(n).replace(".",","):e.toFixed(n)):i.config.useComma?(e=parseFloat(e)).toString().replace(".",","):e}},{key:"renderTooltip",value:function(e,t){var i=this,n=new Date(t[0].value[0]),o=t.map((function(t){var n=null===t.value[1]?"null":i.yFormatter(t.value[1],t.seriesIndex,e);return'<div style="width: 100%; display: inline-flex; justify-content: space-around; color: '.concat(e.config.l[t.seriesIndex].color,'">')+'<div style="display: flex;">'.concat(e.config.l[t.seriesIndex].name,":</div>")+'<div style="display: flex; flex-grow: 1"></div>'+'<div style="display: flex;"><b>'.concat(n,"</b>").concat(null!==t.value[1]?e.config.l[t.seriesIndex].unit:"","</div>")+"</div>"})),a=e.config.timeFormat||"dddd, MMMM Do YYYY, h:mm:ss.SSS";return"<b>".concat(_()(n).format(a),"</b><br/>").concat(o.join("<br/>"))}},{key:"getOption",value:function(e){var t=this;e=e||this.props,this.debug=e.config&&e.config.debug,this.debug&&console.log("[ChartView ] [".concat((new Date).toISOString(),"] ").concat(JSON.stringify(e.config,null,2)));var i={};e.config.titlePos&&e.config.titlePos.split(";").forEach((function(e){var t=e.split(":");i[t[0].trim()]=parseInt(t[1].trim(),10)}));var n=e.config.legend&&"none"!==e.config.legend?{data:e.config.l.map((function(e){return e.name})),show:!0,left:"nw"===e.config.legend||"sw"===e.config.legend?101:void 0,right:"ne"===e.config.legend||"se"===e.config.legend?31:void 0,top:"nw"===e.config.legend||"ne"===e.config.legend?10:void 0,bottom:"sw"===e.config.legend||"se"===e.config.legend?40:void 0,backgroundColor:e.config.legBg}:void 0,o=this.getSeries(e);e.config.start&&(this.chart.max<e.config.end&&(this.chart.max=e.config.end),this.chart.min>e.config.start&&(this.chart.min=e.config.start)),this.chart.diff=this.chart.max-this.chart.min,this.chart.withTime=this.chart.diff<6048e5,this.chart.withSeconds=this.chart.diff<18e5;var a={backgroundColor:"transparent",animation:!e.config.noAnimation&&!e.config.noLoader,title:{text:e.config.title||"",textStyle:{fontSize:e.config.titleSize?parseInt(e.config.titleSize,10):void 0,color:e.config.titleColor||void 0},padding:[8,0,0,90],textVerticalAlign:i.bottom?"bottom":"top",textAlign:50===i.left?"center":-5===i.right?"right":"left",top:35===i.top?5:50===i.top?"50%":void 0,left:50===i.left?"50%":65===i.left?15:void 0,bottom:i.bottom?i.bottom>0?i.bottom+20-5:i.bottom:void 0,right:5===i.right?35:void 0},legend:n,grid:{backgroundColor:e.config.bg_custom||"transparent",show:!!e.config.bg_custom,left:100,top:8,right:30,bottom:40},tooltip:e.config.hoverDetail?{trigger:"axis",formatter:function(i){return t.renderTooltip(e,i)},hoverAnimation:!0,axisPointer:{animation:!0}}:void 0,xAxis:[{type:"time",splitLine:{show:!e.config.grid_hideX,lineStyle:e.config.grid_color?{color:e.config.grid_color}:void 0},min:this.chart.min,max:this.chart.max,axisTick:{alignWithLabel:!0},axisLabel:{formatter:function(i,n){var o=new Date(i);return e.config.timeFormat?_()(o).format(e.config.timeFormat).replace("<br/>","\n"):t.chart.withSeconds?P(o.getHours())+":"+P(o.getMinutes())+":"+P(o.getSeconds()):t.chart.withTime?P(o.getHours())+":"+P(o.getMinutes())+"\n"+P(o.getDate())+"."+P(o.getMonth()+1):P(o.getDate())+"."+P(o.getMonth()+1)+"\n"+o.getFullYear()},color:e.config.x_labels_color||void 0}}],yAxis:[{type:"value",boundaryGap:[0,"100%"],splitLine:{show:!e.config.grid_hideY,lineStyle:e.config.grid_color?{color:e.config.grid_color}:void 0},axisLabel:{formatter:function(t){return e.config.useComma&&(t=t.toString().replace(".",",")),t+e.config.l[0].unit},color:e.config.y_labels_color||void 0},axisTick:{alignWithLabel:!0}}],toolbox:!0===e.config.export||"true"===e.config.export?{left:"right",feature:{saveAsImage:{title:e.t("Save as image"),show:!0}}}:void 0,series:o};return e.config.grid_color||(a.yAxis.forEach((function(e){return delete e.splitLine.lineStyle})),a.xAxis.forEach((function(e){return delete e.splitLine.lineStyle}))),a}},{key:"setNewRange",value:function(e){this.chart.diff=this.chart.max-this.chart.min,this.chart.withTime=this.chart.diff<6048e5,this.chart.withSeconds=this.chart.diff<18e5,this.debug&&console.log("[ChartView ] [".concat((new Date).toISOString(),"] setNewRange: ").concat(!!e)),e?(this.updateDataTimer&&clearTimeout(this.updateDataTimer),this.updateDataTimer=null,this.props.onRangeChange&&this.props.onRangeChange({start:this.chart.min,end:this.chart.max})):(this.debug&&console.log("[ChartView ] [".concat((new Date).toISOString(),"] setOption in setNewRange")),this.echartsReact.getEchartsInstance().setOption({xAxis:{min:this.chart.min,max:this.chart.max}}))}},{key:"installEventHandlers",value:function(){this.zr=this.echartsReact.getEchartsInstance().getZr(),this.zr&&this.props.config.zoom&&!this.zr._iobInstalled?(this.zr._iobInstalled=!0,this.zr.on("mousedown",this.onMouseDown),this.zr.on("mouseup",this.onMouseUp),this.zr.on("mousewheel",this.onMouseWheel),this.zr.on("touchstart",this.onTouchStart),this.zr.on("touchend",this.onTouchEnd),this.zr.on("touchmove",this.onTouchMove)):this.zr&&!this.props.config.zoom&&this.zr._iobInstalled&&(this.zr._iobInstalled=!1,this.zr.off("mousedown",this.onMouseDown),this.zr.off("mouseup",this.onMouseUp),this.zr.off("mousewheel",this.onMouseWheel),this.zr&&this.zr._mousemove&&(this.zr._mousemove=!1,this.zr.off("mousemove",this.onMouseMove)),this.zr.off("touchstart",this.onTouchStart),this.zr.off("touchend",this.onTouchEnd),this.zr.off("touchmove",this.onTouchMove))}},{key:"renderChart",value:function(){var e=this;if(this.props.data){var t=this.getOption();return this.debug&&console.log("[ChartView ] [".concat((new Date).toISOString(),"] render chart")),o.a.createElement(L.a,{ref:function(t){return e.echartsReact=t},echarts:H.a,option:t,notMerge:!0,lazyUpdate:!0,theme:"dark"===this.props.themeType?"dark":"",style:{height:this.state.chartHeight+"px",width:"100%"},opts:{renderer:"svg"},onEvents:{rendered:function(t){e.props.config.zoom&&e.installEventHandlers()}}})}return o.a.createElement(m.a,null)}},{key:"componentDidUpdate",value:function(){var e=this;if(this.divRef.current){var t=parseFloat(this.props.config.border_width)||0,i=t&&parseFloat(this.props.config.border_padding)||0,n=this.divRef.current.offsetHeight-2*(t+i);if(this.state.chartHeight!==n){var o=this.divRef.current.offsetWidth-2*(t+i);setTimeout((function(){return e.setState({chartHeight:n,chartWidth:o})}),10)}}}},{key:"renderResetButton",value:function(){var e=this;return o.a.createElement(M.a,{ref:this.divResetButton,size:"small",color:"default",style:{display:"none"},className:this.props.classes.resetButton,title:D.a.t("Reset pan and zoom"),onClick:function(){e.divResetButton.current&&(e.divResetButton.current.style.display="none"),e.props.onRangeChange&&e.props.onRangeChange()}},o.a.createElement(E.a,{className:this.props.classes.resetButtonIcon}))}},{key:"render",value:function(){var e=this;this.divRef.current||setTimeout((function(){return e.forceUpdate()}),10);var t=parseFloat(this.props.config.border_width)||0,i=parseFloat(this.props.config.border_padding)||0;return o.a.createElement("div",{ref:this.divRef,className:this.props.classes.chart,style:{width:t?"calc(100% - "+2*(t+i)+"px":void 0,height:t?"calc(100% - "+2*(t+i)+"px":void 0,background:this.props.config.window_bg||void 0,borderWidth:t,borderColor:this.props.config.border_color||void 0,borderStyle:t?this.props.config.border_style||"solid":"",padding:t&&i?i:0}},this.renderResetButton(),this.renderChart())}}]),i}(o.a.Component),W=Object(f.a)()(Object(g.a)((function(e){return{chart:{maxHeight:"100%",maxWidth:"100%",width:"100%",height:"100%",overflow:"hidden",position:"relative"},resetButton:{position:"absolute",top:10,right:25,zIndex:2,opacity:.7},resetButtonIcon:{paddingTop:6}}}))(U)),J=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(c.a)(this,n);var s=(a=t.call(this,e)).createTheme();a.state={connected:!1,seriesData:null,noLoader:v.a.parseQuery(window.location.search).noLoader||v.a.parseQuery((window.location.hash||"").replace(/^#/,"")).noLoader||!1,theme:s,themeName:a.getThemeName(s),themeType:a.getThemeType(s),noBackground:v.a.parseQuery(window.location.search).noBG||v.a.parseQuery((window.location.hash||"").replace(/^#/,"")).noBG||!1},a.divRef=o.a.createRef(),a.progressRef=o.a.createRef();var r={en:i(419),de:i(420),ru:i(421),pt:i(422),nl:i(423),fr:i(424),it:i(425),es:i(426),pl:i(427),"zh-cn":i(428)},l={en:i(429),de:i(430),ru:i(431),pt:i(432),nl:i(433),fr:i(434),it:i(435),es:i(436),pl:i(437),"zh-cn":i(438)};Object.keys(r).forEach((function(e){return r[e]=Object.assign(r[e],l[e])})),D.a.setTranslations(r);try{a.isIFrame=window.self!==window.top}catch(h){a.isIFrame=!0}return a.socket=new S.a({name:window.adapterName,onProgress:function(e){e===T.PROGRESS.CONNECTING?a.setState({connected:!1}):(T.PROGRESS.READY,a.setState({connected:!0}))},onReady:function(e,t){D.a.setLanguage(a.socket.systemLang),a.socket.getSystemConfig().then((function(e){var t,i;a.systemLang=(null===e||void 0===e||null===(t=e.common)||void 0===t?void 0:t.language)||"en",a.isFloatComma=(null===e||void 0===e||null===(i=e.common)||void 0===i?void 0:i.isFloatComma)||!1,a.chartData=new C(a.socket),a.chartData.onError((function(e){return a.showError(D.a.t(e))})),a.chartData.onReading((function(e){return a.showProgress(e)})),a.chartData.onUpdate((function(e){return a.setState({seriesData:e},(function(){return a.showProgress(!1)}))}))}))},onError:function(e){console.error(e),a.showError(e)}}),a}return Object(l.a)(n,[{key:"showProgress",value:function(e){this.progressRef.current&&(this.progressRef.current.style.display=e?"block":"none")}},{key:"componentWillUnmount",value:function(){this.chartData&&this.chartData.destroy()}},{key:"createTheme",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return x()(v.a.getThemeName(e))}},{key:"getThemeName",value:function(e){return e.name}},{key:"getThemeType",value:function(e){return e.palette.type}},{key:"showError",value:function(e){this.setState({errorText:e})}},{key:"renderError",value:function(){var e=this;return this.state.errorText?o.a.createElement(k.a,{classes:{},text:this.state.errorText,onClose:function(){return e.setState({errorText:""})}}):null}},{key:"render",value:function(){var e=this;if(!this.state.connected||!this.state.seriesData)return this.state.noLoader?null:o.a.createElement(r.a,{theme:this.state.theme},o.a.createElement(w.a,{theme:this.state.themeType}));var t=this.chartData.getConfig();return this.state.seriesData&&t.debug&&console.log("seriesData: "+JSON.stringify(this.state.seriesData)),o.a.createElement(r.a,{theme:this.state.theme},o.a.createElement("div",{ref:this.divRef,className:this.props.classes.root,style:{width:t.width,height:t.height,background:this.state.noBackground?void 0:this.state.theme.palette.background.default,color:this.state.theme.palette.text.primary}},o.a.createElement(m.a,{ref:this.progressRef,style:{display:"block"},className:this.props.classes.progress}),o.a.createElement(W,{socket:this.socket,t:D.a.t,noAnimation:this.state.noLoader,data:this.state.seriesData,config:t,lang:D.a.getLanguage(),themeType:this.state.themeType,onRangeChange:function(t){return e.chartData.setNewRange(t)}}),this.renderError()))}}]),n}(n.Component),X=Object(f.a)()(Object(g.a)((function(e){return{root:{width:"100%",height:"100%",position:"relative"},progress:{position:"absolute",top:0,left:0,right:0}}}))(Object(d.a)(J)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var B=i(152);window.adapterName="echarts-show";var A=v.a.getThemeName();console.log("iobroker."+window.adapterName+"@"+B.a+' using theme "'+A+'"'),window.location.host,function e(){return s.a.render(o.a.createElement(r.a,{theme:x()(A)},o.a.createElement(X,{onThemeChange:function(t){A=t,e()}})),document.getElementById("root"))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[233,1,2]]]);
//# sourceMappingURL=main.46fb1864.chunk.js.map