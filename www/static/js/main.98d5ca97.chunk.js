(this["webpackJsonpecharts.index"]=this["webpackJsonpecharts.index"]||[]).push([[0],{245:function(t){t.exports=JSON.parse('{"a":"0.3.4"}')},409:function(t,e){function i(t){t=(t||"").toString().replace(/^\?/,"");var e={};return t.split("&").forEach(t=>{if(t=t.trim()){var i=t.split("="),s=decodeURIComponent(i[0]).trim();if(i.length>1)if(e[s]=decodeURIComponent(i[1]),"true"===e[s])e[s]=!0;else if("false"===e[s])e[s]=!1;else{var a=parseFloat(e[s]);a.toString()===e[s]&&(e[s]=a)}else e[s]=!0}}),e}function s(t){if(t.lines&&(t.l=t.lines,delete t.lines),t._ids){var e=t._ids?t._ids.split(";"):[],i=t._colors?t._colors.split(";"):[],s=t._names?t._names.split(";"):[],a=t._units?t._units.split(";"):[];t.l=[];for(var o=0;o<e.length;o++)t.l.push({id:e[o],offset:0,name:s[o]||"",aggregate:"onchange",color:i[o]||"blue",thickness:t.strokeWidth||1,shadowsize:t.strokeWidth||1,min:t.min||"",max:t.max||"",unit:a[o]||""});t.aggregateType="step",t.aggregateSpan=300,t.relativeEnd="now"}if(t.l)for(var n=0;n<t.l.length;n++)t.l[n].art&&(t.l[n].aggregate=t.l[n].art,delete t.l[n].art),t.instance&&!t.l[n].instance&&(t.l[n].instance=t.instance),t.l[n].yOffset=parseFloat(t.l[n].yOffset)||0,t.l[n].offset=parseFloat(t.l[n].offset)||0,t.l[n].validTime=parseFloat(t.l[n].validTime)||0;if(t.l=t.l||[],t.m){t.marks=[];for(var r=0;r<t.m.length;r++)t.marks[r]={lineId:t.m[r].l,upperValueOrId:t.m[r].v,lowerValueOrId:t.m[r].vl,color:t.m[r].c,fill:t.m[r].f,ol:t.m[r].t,os:t.m[r].s,text:t.m[r].d,textPosition:t.m[r].p,textOffset:t.m[r].py,textColor:t.m[r].fc,textSize:t.m[r].fs};delete t.m}return t.marks=t.marks||[],t.l.length||t.l.push({id:"",unit:""}),t.width=t.width||"100%",t.height=t.height||"100%",t.timeFormat=t.timeFormat||"",t.useComma="true"===t.useComma||!0===t.useComma,t.zoom="true"===t.zoom||!0===t.zoom,t.export="true"===t.export||!0===t.export,t.grid_hideX="true"===t.grid_hideX||!0===t.grid_hideX,t.grid_hideY="true"===t.grid_hideY||!0===t.grid_hideY,t.hoverDetail="true"===t.hoverDetail||!0===t.hoverDetail,t.noLoader="true"===t.noLoader||!0===t.noLoader,t.noedit="true"===t.noedit||!0===t.noedit,t.animation=parseInt(t.animation)||0,t.afterComma=void 0===t.afterComma?2:parseInt(t.afterComma,10),t.timeType=t.timeType||"relative",t}t.exports=class{constructor(t,e,i){i=Object.assign({updateTimeout:300},i||{}),this.socket=t,this.updateTimeout=i.updateTimeout||300,this.serverSide=i.serverSide||!1,this.seriesData=[],this.ticks=null,this.liveInterval=null,this.navOptions={},this.sessionId=1,this.updateInterval=null,this.presetSubscribed=!1,this.onUpdateFunc=null,this.onReadingFunc=null,this.onErrorFunc=null,this.objectPromises={},this.debug=!1,this.zoomData=null,this.serverSide||(this.lastHash=window.location.hash,e||(this.onHashInstalled=!0,this.onHashChangeBound=this.onHashChange.bind(this),window.addEventListener("hashchange",this.onHashChangeBound,!1)),this.onPresetUpdateBound=this.onPresetUpdate.bind(this)),this.socket.getSystemConfig().then(t=>(this.systemConfig=t&&t.common?t.common:{},this.analyseAndLoadConfig(e)))}analyseAndLoadConfig(t){if(t)"string"===typeof t?this.preset=t:this.config=s(t);else{var e=i(window.location.search);if(this.debug=!0===e.debug||"true"===e.debug||1===e.debug||"1"===e.debug,e.preset&&"string"===typeof e.preset)this.preset=e.preset;else{var a=i((window.location.hash||"").toString().replace(/^#/,""));if(a.data)try{a.data=JSON.parse(a.data)}catch(n){a.data={}}if(e.data)try{e.data=JSON.parse(e.data)}catch(n){e.data={}}var o=Object.assign(e.data||{},a.data||{},!0);void 0!==a.noLoader&&(o.noLoader=!0===a.noLoader||"true"===a.noLoader||1===a.noLoader||"1"===a.noLoader),void 0!==e.noLoader&&(o.noLoader=!0===e.noLoader||"true"===e.noLoader||1===e.noLoader||"1"===e.noLoader),this.config=s(o)}}this.seriesData=[],this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.preset?((this.preset.startsWith("echarts.")||this.preset.startsWith("flot."))&&this.preset.includes(".")||(this.preset="echarts.0."+this.preset),this.socket.getObject(this.preset).then(t=>{if(!t||!t.native||!t.native.data||"chart"!==t.type)return console.error("[ChartModel] Invalid object ".concat(this.preset,": ").concat(JSON.stringify(t)));this.config=s(t.native.data),this.config.useComma=void 0===this.config.useComma?!0===this.systemConfig.isFloatComma||"true"===this.systemConfig.isFloatComma:"true"===this.config.useComma||!0===this.config.useComma,this.config.lang=this.systemConfig.language,this.config.live=parseInt(this.config.live,10)||0,this.config.debug=this.debug,this.readData(),this.serverSide||this.presetSubscribed===this.preset||(this.presetSubscribed&&this.socket.unsubscribeObject(this.presetSubscribed,this.onPresetUpdateBound),this.presetSubscribed=this.preset,this.socket.subscribeObject(this.preset,this.onPresetUpdateBound)),this.serverSide||!this.config.live||this.zoomData&&this.zoomData.stopLive||(this.updateInterval=setInterval(()=>this.readData(),1e3*this.config.live))})):(this.config.useComma=void 0===this.config.useComma?!0===this.systemConfig.isFloatComma||"true"===this.systemConfig.isFloatComma:"true"===this.config.useComma||!0===this.config.useComma,this.config.lang=this.systemConfig.language,this.config.live=parseInt(this.config.live,10)||0,this.config.debug=this.debug,this.readData(),this.serverSide||!this.config.live||this.zoomData&&this.zoomData.stopLive||(this.updateInterval=setInterval(()=>this.readData(),1e3*this.config.live)))}onHashChange(){this.lastHash!==window.location.hash&&(this.lastHash=window.location.hash,this.analyseAndLoadConfig())}onPresetUpdate(t,e){t===this.preset&&(this.presetUpdateTimeout&&clearTimeout(this.presetUpdateTimeout),this.presetUpdateTimeout=setTimeout(()=>{var t;this.presetUpdateTimeout=null,t=s(e?e.native.data:{}),JSON.stringify(t)!==JSON.stringify(this.config)&&(this.config=t,this.updateInterval&&clearInterval(this.updateInterval),this.updateInterval=null,!this.config.live||this.zoomData&&this.zoomData.stopLive||(this.updateInterval=setInterval(()=>this.readData(),1e3*this.config.live)),this.readData())},100))}setNewRange(t){if(this.debug&&console.log("[ChartModel] [".concat((new Date).toISOString(),"] setNewRange: ").concat(JSON.stringify(t))),t)if(t.stopLive)this.zoomData=this.zoomData||{},this.zoomData.stopLive=!0,this.updateInterval&&(console.log("Clear interval"),clearInterval(this.updateInterval),this.updateInterval=null);else{var e=this.zoomData&&this.zoomData.stopLive;e&&delete this.zoomData.stopLive,this.zoomData&&JSON.stringify(this.zoomData)===JSON.stringify(t)?e&&(this.zoomData.stopLive=!0):(this.zoomData=t,e&&(this.zoomData.stopLive=!0),this.readOnZoomTimeout&&clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=setTimeout(()=>{this.readOnZoomTimeout=null,this.readData()},this.updateTimeout))}else this.zoomData&&(this.zoomData=null,this.readOnZoomTimeout&&clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=setTimeout(()=>{this.readOnZoomTimeout=null,!this.config.live||this.zoomData&&this.zoomData.stopLive||(console.log("Restore update"),this.updateInterval&&clearInterval(this.updateInterval),this.updateInterval=setInterval(()=>this.readData(),1e3*this.config.live)),this.readData()},this.updateTimeout))}destroy(){this.readOnZoomTimeout&&(clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=null),this.presetUpdateTimeout&&(clearTimeout(this.presetUpdateTimeout),this.presetUpdateTimeout=null),this.presetSubscribed&&(this.socket.unsubscribeObject(this.presetSubscribed,this.onPresetUpdateBound),this.presetSubscribed=null),this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.serverSide||(this.onHashInstalled&&window.removeEventListener("hashchange",this.onHashChangeBound,!1),this.onHashInstalled=!1)}onUpdate(t){this.onUpdateFunc=t}onReading(t){this.onReadingFunc=t}onError(t){this.onErrorFunc=t}getConfig(){return this.config}getSystemConfig(){return this.systemConfig}setConfig(t){this.analyseAndLoadConfig(t)}getStartStop(t,e){var i,s,a,o={};if(this.config.l[t].offset=this.config.l[t].offset||0,"string"===typeof this.config.range&&this.config.range.includes("m")&&this.config.l.length>1)for(var n=parseInt(this.config.range,10)||1,r=0;r<this.config.l.length;r++)if(this.config.l[r].offset&&0!==this.config.l[r].offset){a=this.addTime(this.now,this.config.l[0].offset);var h=new Date(a);h.setMonth(h.getMonth()-n),this.config.range=Math.floor((a-h.getTime())/6e4)+"";break}if(e)return this.zoomData?(s=this.zoomData.start,i=this.zoomData.end):s=(i=this.addTime(this.now,this.config.l[t].offset))-e,o={start:s,end:i,ignoreNull:void 0===this.config.l[t].ignoreNull?this.config.ignoreNull:this.config.l[t].ignoreNull,aggregate:this.config.l[t].aggregate||this.config.aggregate||"minmax",count:1,from:!1,ack:!1,q:!1,addID:!1},this.config.start=this.addTime(i,this.config.range,!1,!0),this.config.end=i,o;if(this.zoomData)s=this.zoomData.start,i=this.zoomData.end;else if("static"===this.config.timeType){var l,c;l=void 0!==this.config.start_time?this.config.start_time.split(":").map(Number):[0,0],c=void 0!==this.config.end_time?this.config.end_time.split(":").map(Number):[24,0],s=new Date(this.config.start).setHours(l[0],l[1]),i=new Date(this.config.end).setHours(c[0],c[1]),s=this.addTime(s,this.config.l[t].offset),i=this.addTime(i,this.config.l[t].offset)}else{if(this.config.relativeEnd=this.config.relativeEnd||"now","now"===this.config.relativeEnd)a=new Date(this.now);else if(-1!==this.config.relativeEnd.indexOf("minute")){var d=parseInt(this.config.relativeEnd,10)||1;(a=new Date(this.now)).setMinutes(Math.floor(a.getMinutes()/d)*d+d),a.setSeconds(0),a.setMilliseconds(0)}else if(-1!==this.config.relativeEnd.indexOf("hour")){var g=parseInt(this.config.relativeEnd,10)||1;(a=new Date(this.now)).setHours(Math.floor(a.getHours()/g)*g+g),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)}else"today"===this.config.relativeEnd?((a=new Date(this.now)).setDate(a.getDate()+1),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)):"weekUsa"===this.config.relativeEnd?((a=new Date(this.now)).setDate(a.getDate()-a.getDay()+7),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)):"weekEurope"===this.config.relativeEnd?(0===(a=new Date(this.now)).getDay()?a.setDate(a.getDate()+1):a.setDate(a.getDate()-a.getDay()+8),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)):"month"===this.config.relativeEnd?((a=new Date(this.now)).setMonth(a.getMonth()+1),a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)):"year"===this.config.relativeEnd&&((a=new Date(this.now)).setFullYear(a.getFullYear()+1),a.setMonth(0),a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0));this.config.range=this.config.range||"30m",i=this.addTime(a,this.config.l[t].offset),s=this.addTime(i,this.config.range,!1,!0)}return o={start:s,end:i,ignoreNull:void 0===this.config.l[t].ignoreNull?this.config.ignoreNull:this.config.l[t].ignoreNull,aggregate:this.config.l[t].aggregate||this.config.aggregate||"minmax",from:!1,ack:!1,q:!1,addID:!1},"step"===this.config.aggregateType?o.step=1e3*this.config.aggregateSpan:"count"===this.config.aggregateType&&(o.count=this.config.aggregateSpan||300),this.config.start=s,this.config.end=i,o}readOneChart(t,e,i,s){var a=this.getStartStop(i);a.instance=e,a.sessionId=this.sessionId,this.debug&&console.log("[ChartModel] "+new Date(a.start)+" - "+new Date(a.end)),this.socket.getHistoryEx(t,a).then(t=>{if(this.sessionId&&t.sessionId&&t.sessionId!==this.sessionId)return console.warn("[ChartModel] Ignore request with sessionId=".concat(t.sessionId,", actual is ").concat(this.sessionId));if(t&&t.values){a.yOffset=this.config.l[i].yOffset;var e=t.values;this.seriesData[i]=[];for(var s=this.seriesData[i],o=0;o<e.length;o++)"true"===e[o].val||!0===e[o].val?e[o].val=1:"false"!==e[o].val&&!1!==e[o].val||(e[o].val=0),"string"===typeof e[o].val&&(e[o].val=parseFloat(e[o].val)),s.push({value:[e[o].ts,null!==e[o].val?e[o].val+a.yOffset:null]});if(s.length){s[0].value[0]>a.start&&s.unshift({value:[a.start,null],exact:!1});var n=s[s.length-1];n.value[0]<a.end&&(this.config.l[i].validTime&&a.end-1e3*this.config.l[i].validTime<=n.value[0]?s.push({value:[a.end,n.value[1]],exact:!1}):s.push({value:[a.end,null],exact:!1}))}else s.push({value:[a.start,null],exact:!1}),s.push({value:[a.end,null],exact:!1});t.values=null,t=null}return Promise.resolve()}).catch(t=>t&&console.error("[ChartModel] "+t)).then(()=>s(t,i))}_readObject(t){return this.objectPromises[t]||(this.objectPromises[t]=this.socket.getObject(t)),this.objectPromises[t]}_readOneLine(t,e){return this._readObject(this.config.l[t].id).then(e=>(e&&e.common&&(this.config.l[t].name=this.config.l[t].name||e.common.name,this.config.l[t].unit=this.config.l[t].unit||(e.common.unit?e.common.unit.replace("\ufffd","\xb0"):""),this.config.l[t].type=e.common.type,"auto"===this.config.l[t].chartType&&(this.config.l[t].chartType="boolean"===e.common.type?"steps":"line",this.config.l[t].aggregate="boolean"===e.common.type?"onchange":"minmax")),Promise.resolve())).catch(e=>(console.error("[ChartModel] Cannot read object ".concat(this.config.l[t].id,": ").concat(e)),Promise.resolve())).then(()=>{this.config.l[t].name=this.config.l[t].name||this.config.l[t].id,this.config.l[t].unit=this.config.l[t].unit||"","auto"===this.config.l[t].chartType&&(this.config.l[t].chartType="line",this.config.l[t].aggregate="minmax"),"object"===typeof this.config.l[t].name&&(this.config.l[t].name=this.config.l[t].name[this.systemConfig.language]||this.config.l[t].name.en),this.readOneChart(this.config.l[t].id,this.config.l[t].instance,t,e)})}_readData(t,e){if((e=e||0)>=this.config.l.length)return t();""!==this.config.l[e]&&void 0!==this.config.l[e]&&this.seriesData.push([]),this._readOneLine(e,()=>setTimeout(()=>this._readData(t,e+1),10))}readTicks(t){if(this.config.ticks){var e=JSON.parse(JSON.stringify(this.getStartStop(0)));e.instance=this.config.l[0].instance,e.sessionId=this.sessionId,e.aggregate="onchange",this.debug&&console.log("[ChartModel] Ticks: "+new Date(e.start)+" - "+new Date(e.end)),this.socket.getHistoryEx(this.config.ticks,e).then(t=>{if(this.sessionId&&t.sessionId&&t.sessionId!==this.sessionId)return console.warn("[ChartModel] Ignore request with sessionId=".concat(t.sessionId,", actual is ").concat(this.sessionId));if(t&&t.values){var i=this.ticks||[];this.ticks&&this.ticks.length&&this.ticks.splice(0,this.ticks.length);for(var s=t.values,a=0;a<s.length;a++)null!==s[a].val&&i.push({value:[s[a].ts,s[a].val]});i.length?(i[0][0]>e.start&&i.unshift({value:[e.start,""]}),i[i.length-1][0]<e.end&&i.push({value:[e.end,""]})):(i.push({value:[e.start,""]}),i.push({value:[e.end,""]})),t.values=null,t=null,this.ticks=i}return Promise.resolve()}).catch(t=>console.error("[ChartModel] ".concat(t))).then(()=>t&&t(this.ticks))}else t(null)}readValue(t,e,i){this.socket.getState(t).then(t=>{i(e,t&&parseFloat(t.val)||0)}).catch(t=>{console.error("[ChartModel] ".concat(t)),i(e,0)})}readMarkings(t,e){return e=e||0,!this.config.marks||!this.config.marks.length||e>=this.config.marks.length?t():new Promise(t=>{(this.config.marks[e].upperValueOrId||0===this.config.marks[e].upperValueOrId)&&parseFloat(this.config.marks[e].upperValueOrId).toString()!==this.config.marks[e].upperValueOrId.toString().replace(/\.0*$/,"")&&this.config.marks[e].upperValueOrId.toString().includes(".")?this.socket.getState(this.config.marks[e].upperValueOrId).then(i=>{i&&void 0!==i.val&&null!==i.val?this.config.marks[e].upperValue=parseFloat(i.val)||0:this.config.marks[e].upperValue=null,t()}):t()}).then(()=>new Promise(t=>{(this.config.marks[e].lowerValueOrId||0===this.config.marks[e].lowerValueOrId)&&parseFloat(this.config.marks[e].lowerValueOrId).toString()!==this.config.marks[e].lowerValueOrId.replace(/\.0*$/,"")&&this.config.marks[e].lowerValueOrId.includes(".")?this.socket.getState(this.config.marks[e].lowerValueOrId).then(i=>{i&&void 0!==i.val&&null!==i.val?this.config.marks[e].lowerValue=parseFloat(i.val)||0:this.config.marks[e].lowerValue=null,t()}):t()})).then(()=>setTimeout(()=>this.readMarkings(t,e+1),0))}addTime(t,e,i,s){return t=new Date(t),"string"===typeof e?"m"===e[1]?(e=parseInt(e,10),t.setMonth(i?t.getMonth()+e:t.getMonth()-e),t=t.getTime()):"y"===e[1]?(e=parseInt(e,10),t.setFullYear(i?t.getFullYear()+e:t.getFullYear()-e),t=t.getTime()):(t=t.getTime(),s?i?t+=6e4*(parseInt(e,10)||0):t-=6e4*(parseInt(e,10)||0):i?t+=1e3*(parseInt(e,10)||0):t-=1e3*(parseInt(e,10)||0)):(t=t.getTime(),s?i?t+=6e4*(parseInt(e,10)||0):t-=6e4*(parseInt(e,10)||0):i?t+=1e3*(parseInt(e,10)||0):t-=1e3*(parseInt(e,10)||0)),t}readData(){this.readOnZoomTimeout&&(clearTimeout(this.readOnZoomTimeout),this.readOnZoomTimeout=null),this.now=Date.now(),console.log("Read till "+new Date(this.now)),this.sessionId=this.sessionId||0,this.sessionId++,this.sessionId>16777215&&(this.sessionId=1),this.config.l?(this.onReadingFunc&&this.onReadingFunc(!0),this.seriesData=[],this._readData(()=>this.readTicks(t=>this.readMarkings(()=>{this.onUpdateFunc(this.seriesData)})))):(this.onErrorFunc&&this.onErrorFunc("No config provided"),this.onReadingFunc&&this.onReadingFunc(!1))}}},411:function(t,e){var i={azul:["#f2385a","#f5a503","#4ad9d9","#f7879c","#c1d7a8","#4dffd2","#fccfd7","#d5f6f6"],"bee-inspired":["#001727","#805500","#ffff00","#ffd11a","#f2d71f","#f2be19","#f3a81a","#fff5cc"],blue:["#1790cf","#1bb2d8","#99d2dd","#88b0bb","#1c7099","#038cc4","#75abd0","#afd6dd"],infographic:["#C1232B","#27727B","#FCCE10","#E87C25","#B5C334","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0"],vintage:["#d87c7c","#919e8b","#d7ab82","#6e7074","#61a0a8","#efa18d","#787464","#cc7e63","#724e58","#4b565b"],dark:["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78","#73a373","#73b9bc","#7289ab","#91ca8c","#f49f42"],macarons:["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],shine:["#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487"],roma:["#E01F54","#001852","#f5e8c8","#b8d2c7","#c6b38e","#a4d8c2","#f3d999","#d3758f","#dcc392","#2e4783","#82b6e9","#ff6347","#a092f1","#0a915d","#eaf889","#6699FF","#ff6666","#3cb371","#d5b158","#38b6b6"],royal:["#3f7ea6","#993366","#408000","#8c6f56","#a65149","#731f17","#adc2eb","#d9c3b0"],"dark-blue":["#00305a","#004b8d","#0074d9","#4192d9","#7abaf2","#99cce6","#d6ebf5","#eeeeee"],"tech-blue":["#4d4d4d","#3a5897","#007bb6","#7094db","#0080ff","#b3b3ff","#00bdec","#33ccff","#ccddff","#eeeeee"],red:["#d8361b","#f16b4c","#f7b4a9","#d26666","#99311c","#c42703","#d07e75"],"red-velvet":["#8b1a2d","#a7314b","#e6004c","#ff8066","#8e5c4e","#ff1a66","#d6c582","#f0d4af"],green:["#408829","#68a54a","#a9cba2","#86b379","#397b29","#8abb6f","#759c6a","#bfd3b7"],light:["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"],gray:["#757575","#c7c7c7","#dadada","#8b8b8b","#b5b5b5","#e9e9e9"],"dark-bold":["#458c6b","#f2da87","#d9a86c","#d94436","#a62424","#76bc9b","#cce6da","#eeeeee"]};function s(t){return t.toString().padStart(2,"0")}t.exports=class{constructor(t,e,i,s){if(this.moment=t,!this.moment)throw new Error("moment must be set and initialized");this.config=s?JSON.parse(JSON.stringify(s)):null,this.calcTextWidth=i,this.themeType=e||"light",this.chart={yAxis:[]}}setThemeName(t){this.themeType=t||"light"}setConfig(t){this.config=t}getHelperChartData(){return this.chart}convertData(t,e,i){var s=t[e];if(!s||!s.length)return[];var a=this.chart.yAxis[i]||{max:null,min:null};this.chart.yAxis[i]=a;for(var o=0;o<s.length;o++)null!==s[o].value[1]&&((null===a.min||a.min>s[o].value[1])&&(a.min=s[o].value[1]),(null===a.max||a.max<s[o].value[1])&&(a.max=s[o].value[1]));return(null===this.chart.xMin||this.chart.xMin>s[0].value[0])&&(this.chart.xMin=s[0].value[0]),(null===this.chart.xMax||this.chart.xMax<s[s.length-1].value[0])&&(this.chart.xMax=s[s.length-1].value[0]),s}getSeries(t,e){this.chart.xMin=null,this.chart.xMax=null;var s=0;return this.config.l.map((a,o)=>{var n=a.color||(i[e]?i[e][s%i[e].length]:"");a.color||s++;var r=""===a.commonYAxis||void 0===a.commonYAxis?o:parseInt(a.commonYAxis)||0,h={name:a.name,xAxisIndex:0,yAxisIndex:r,type:"scatterplot"===a.chartType?"scatter":"line",showSymbol:"scatterplot"===a.chartType||a.points,hoverAnimation:!0,animation:!1,step:"steps"===a.chartType?"end":void 0,smooth:"spline"===a.chartType,data:this.convertData(t,o,r),itemStyle:{color:n},symbolSize:"scatterplot"===a.chartType||a.points?a.symbolSize||3:void 0,symbol:"circle",lineStyle:{width:a.thickness||1,shadowBlur:a.shadowsize?a.shadowsize+1:0,shadowOffsetY:a.shadowsize?a.shadowsize+1:0,shadowColor:n,type:a.dashes?"dashed":a.lineStyle||"solid"}};return parseFloat(a.fill)&&(h.areaStyle={color:n,opacity:parseFloat(a.fill)}),h})}getXAxis(){return[{type:"time",splitLine:{show:!this.config.grid_hideX,lineStyle:"off"===this.config.l[0].xaxe?{color:"rgba(0,0,0,0)",type:"dashed"}:this.config.grid_color?{color:this.config.grid_color,type:"dashed"}:{type:"dashed"}},splitNumber:parseInt(this.config.l[0].xticks,10)||void 0,position:"top"===this.config.l[0].xaxe?"top":"bottom",min:this.chart.xMin,max:this.chart.xMax,axisTick:{alignWithLabel:!0,lineStyle:"off"===this.config.l[0].xaxe?{color:"rgba(0,0,0,0)"}:this.config.x_ticks_color?{color:this.config.x_ticks_color}:void 0},axisLabel:{formatter:this.xFormatter.bind(this),color:"off"===this.config.l[0].xaxe?"rgba(0,0,0,0)":this.config.x_labels_color||void 0}}]}getYAxis(t,e){return this.config.l.map((t,i)=>{if(!t||""!==t.commonYAxis&&void 0!==t.commonYAxis)return{};var s=parseFloat(t.min),a=parseFloat(t.max),o=this.chart.yAxis;if(o[i]){var n=o[i].max-o[i].min;isNaN(s)&&((s=o[i].min-.1*n)>0?s=0:n>25e3?s=1e4*Math.floor(s/1e4):n>5e3?s=1e3*Math.floor(s/1e3):n>200?s=100*Math.floor(s/100):n>30?s=10*Math.floor(s/10):n>10?s=Math.floor(s):n>1&&(s=Math.floor(10*s)/10)),isNaN(a)&&(a=o[i].max+.1*n,n>25e3?a=1e4*Math.ceil(a/1e4):n>5e3?a=1e3*Math.ceil(a/1e3):n>200?a=100*Math.ceil(a/100):n>30?a=10*Math.ceil(a/10):n>10?a=Math.ceil(a):n>1&&(a=Math.floor(10*a)/10))}else isNaN(s)&&(s=void 0),isNaN(a)&&(a=void 0);var r="off"===t.yaxe?"rgba(0,0,0,0)":this.config.grid_color||void 0;return"leftColor"!==t.yaxe&&"rightColor"!==t.yaxe||(r=e[i].itemStyle.color),{type:"value",min:s,max:a,position:"left"===t.yaxe||"off"===t.yaxe||"leftColor"===t.yaxe?"left":"right"===t.yaxe||"rightColor"===t.yaxe||i?"right":"left",splitLine:i?void 0:{show:!this.config.grid_hideY,lineStyle:{color:r||void 0,type:"dashed"}},splitNumber:parseInt(t.yticks,10)||void 0,axisLabel:{formatter:t=>this.yFormatter(t,i,!0),color:"off"===t.yaxe||"leftColor"===t.yaxe||"rightColor"===t.yaxe?r:this.config.y_labels_color||void 0},axisTick:{alignWithLabel:!0,lineStyle:r?{color:r}:this.config.y_ticks_color?{color:this.config.y_ticks_color}:void 0}}})}getMarkings(t){return this.config.marks&&this.config.marks.forEach(e=>{var i=void 0!==e.lowerValue?e.lowerValue:parseFloat(e.lowerValueOrId),s=void 0!==e.upperValue?e.upperValue:parseFloat(e.upperValueOrId),a=null!==i&&!isNaN(i),o=null!==s&&!isNaN(s),n=t.series[e.lineId];if(a&&o&&(n.markArea=n.markArea||{symbol:["none","none"],itemStyle:{color:e.color||n.itemStyle.color,borderWidth:0,opacity:parseFloat(e.fill)},data:[]},n.markArea.data.push([{yAxis:i,name:e.text||""},{yAxis:s}])),a||o)for(var r=0;r<2;r++)if((r||o)&&(!r||a)){var h=r?i:s;if(n.markLine=n.markLine||{symbol:["none","none"],label:{show:!!e.text,formatter:e.text||"",position:"r"===e.textPosition?"end":"start",distance:-1*e.textOffset||-35,textStyle:{color:e.textColor||"#FFF",fontStyle:"normal",fontSize:e.textSize||void 0}},lineStyle:{color:e.color||n.itemStyle.color,width:parseFloat(e.ol)||1,shadowBlur:parseFloat(e.os)?parseFloat(e.os)+1:0,shadowOffsetY:parseFloat(e.os)?parseFloat(e.os)+1:0,shadowColor:e.color,type:e.lineStyle||"solid"},data:[]},n.markLine.data.push({yAxis:h}),this.config.l[e.lineId]){var l=parseFloat(this.config.l[e.lineId].min);isNaN(l)&&this.chart.yAxis[e.lineId].min>h&&h<0&&(t.yAxis[0].min=h);var c=parseFloat(this.config.l[e.lineId].min);isNaN(c)&&this.chart.yAxis[e.lineId].max<h&&(t.yAxis[0].max=h)}}}),t}yFormatter(t,e,i,s){if("boolean"===this.config.l[e].type)return t?"TRUE":"FALSE";if(null===t||void 0===t)return"";var a=this.config.l[e].afterComma;return void 0!==a&&null!==a?(t=parseFloat(t),this.config.useComma?t.toFixed(a).replace(".",",")+(i?this.config.l[e].unit:""):t.toFixed(a)+(i?this.config.l[e].unit:"")):(s&&(t=Math.round(1e4*t)/1e4),this.config.useComma?(t=parseFloat(t)||0).toString().replace(".",",")+(i?this.config.l[e].unit:""):t.toString()+(i?this.config.l[e].unit:""))}isXLabelHasBreak(){return this.config.timeFormat?this.config.timeFormat.replace("<br/>","\n").includes("\n"):!this.chart.withSeconds&&(this.chart.withTime,!0)}xFormatter(t,e){var i=new Date(t);return this.config.timeFormat?this.moment(i).format(this.config.timeFormat).replace("<br/>","\n"):this.chart.withSeconds?s(i.getHours())+":"+s(i.getMinutes())+":"+s(i.getSeconds()):this.chart.withTime?s(i.getHours())+":"+s(i.getMinutes())+"\n"+s(i.getDate())+"."+s(i.getMonth()+1):s(i.getDate())+"."+s(i.getMonth()+1)+"\n"+i.getFullYear()}getInterpolatedValue(t,e,i){var s=this.option.series[t].data;if(!s||!s[0]||s[0].value[0]>e||s[s.length-1].value[0]<e)return null;for(var a=0;a<s.length-1;a++){if(s[a].value[0]===e)return{exact:!0,val:s[a].value[1]};if(s[a].value[0]<e&&e<s[a+1].value[0]){var o=s[a].value[1],n=s[a+1].value[1];if(null===n||void 0===n||null===o||void 0===o)return{exact:!1,val:null};if("boolean"===i)return{exact:!1,val:o};var r=s[a+1].value[0]-s[a].value[0];return{exact:!1,val:(1-(s[a+1].value[0]-e)/r)*(n-o)+o}}}return{exact:!1,val:null}}renderTooltip(t){var e=t[0].value[0],i=new Date(e),s=this.option.series.map((i,s)=>{var a,o=t.find(t=>t.seriesIndex===s);if(o&&(a={exact:void 0===o.data.exact||o.data.exact,val:o.value[1]}),!(a=a||this.getInterpolatedValue(s,e,this.config.l[s].type)))return"";var n=null===a.val?"null":this.yFormatter(a.val,s,!1,!a.exact);return'<div style="width: 100%; display: inline-flex; justify-content: space-around; color: '.concat(i.itemStyle.color,'">')+'<div style="display: flex;margin-right: 4px">'.concat(i.name,":</div>")+'<div style="display: flex; flex-grow: 1"></div>'+'<div style="display: flex;">'.concat(a.exact?"":"i ","<b>").concat(n,"</b>").concat(null!==a.val?this.config.l[s].unit:"","</div>")+"</div>"}),a=this.config.timeFormat||"dd, MM Do YYYY, h:mm:ss.SSS";return"<b>".concat(this.moment(i).format(a),"</b><br/>").concat(s.filter(t=>t).join("<br/>"))}getLegend(t){return this.config.legend&&"none"!==this.config.legend?{data:this.config.l.map(t=>t.name),show:!0,left:"nw"===this.config.legend||"sw"===this.config.legend?this.chart.padLeft+1:void 0,right:"ne"===this.config.legend||"se"===this.config.legend?this.chart.padRight+1:void 0,top:"nw"===this.config.legend||"ne"===this.config.legend?10:void 0,bottom:"sw"===this.config.legend||"se"===this.config.legend?t+20:void 0,backgroundColor:this.config.legBg||void 0,textStyle:{color:this.config.legColor||("light"===this.themeType?"#000":"#FFF")}}:void 0}getTitle(t){if(this.config.title){var e={};return(this.config.titlePos||"top:35;left:65").split(";").forEach(t=>{var i=t.split(":");e[i[0].trim()]=parseInt(i[1].trim(),10)}),{text:this.config.title,textStyle:{fontSize:this.config.titleSize?parseInt(this.config.titleSize,10):20,color:this.config.titleColor||("light"===this.themeType?"#000":"#FFF")},textVerticalAlign:e.bottom?"bottom":"top",textAlign:50===e.left?"center":-5===e.right?"right":"left",top:35===e.top?5:50===e.top?"50%":void 0,left:50===e.left?"50%":65===e.left?this.chart.padLeft:void 0,bottom:e.bottom?e.bottom>0?e.bottom+t-10:e.bottom:void 0,right:5===e.right?this.chart.padRight:void 0}}}getOption(t,e){e&&(this.config=JSON.parse(JSON.stringify(e)));var i=this.config.theme;i&&"default"!==i||(i="light"===this.themeType?"roma":"dark-bold"),this.debug=this.config&&this.config.debug,this.debug&&console.log("[ChartView ] [".concat((new Date).toISOString(),"] ").concat(JSON.stringify(this.config,null,2)));var s=this.getSeries(t,i);this.config.start&&(this.chart.xMax<this.config.end&&(this.chart.xMax=this.config.end),this.chart.xMin>this.config.start&&(this.chart.xMin=this.config.start)),this.chart.diff=this.chart.xMax-this.chart.xMin,this.chart.withTime=this.chart.diff<6048e5,this.chart.withSeconds=this.chart.diff<18e5;var a=this.getYAxis(i,s),o=this.getXAxis(),n={theme:i,backgroundColor:"transparent",animation:!this.config.noAnimation&&!this.config.noLoader,grid:{backgroundColor:this.config.bg_custom||"transparent",show:!!this.config.bg_custom,left:0,top:8,right:0,bottom:this.isXLabelHasBreak()?40:24},tooltip:this.config.hoverDetail?{trigger:"axis",formatter:t=>this.renderTooltip(t),hoverAnimation:!0,axisPointer:{animation:!0}}:void 0,xAxis:o,yAxis:a,series:s};this.getMarkings(n);var r=0,h=0;return s.forEach((t,e)=>{var i=n.yAxis[t.yAxisIndex];if(!i){var s=this.config.l[t.yAxisIndex]?this.config.l[t.yAxisIndex].commonYAxis:void 0;if(void 0===s)return void console.log("Cannot find Y axis for line "+e);i=n.yAxis[s]}var a=this.yFormatter(i.min,e,!0),o=this.yFormatter(i.min||i.max!==i.min?i.max:.8,e,!0),l=i.position;if("off"!==l&&"rgba(0,0,0,0)"!==i.axisLabel.color){var c=this.calcTextWidth(a)+4,d=this.calcTextWidth(o)+4;"left"===l||"leftColor"===l?(c>r&&(r=c),d>r&&(r=d)):(c>h&&(h=c),d>h&&(h=d))}}),n.grid.left=r+10,n.grid.right=h+10+(!0===this.config.export||"true"===this.config.export?20:0),this.chart.padLeft=n.grid.left,this.chart.padRight=n.grid.right,n.legend=this.getLegend(20),n.title=this.getTitle(20),this.config.grid_color||(n.yAxis.forEach(t=>t.splitLine&&delete t.splitLine.lineStyle),n.xAxis.forEach(t=>t.splitLine&&delete t.splitLine.lineStyle)),this.option=n,this.option}}},424:function(t,e,i){t.exports=i(890)},429:function(t,e,i){},435:function(t,e){},437:function(t,e){},448:function(t,e){},450:function(t,e){},477:function(t,e){},479:function(t,e){},480:function(t,e){},486:function(t,e){},488:function(t,e){},506:function(t,e){},508:function(t,e){},520:function(t,e){},523:function(t,e){},879:function(t){t.exports=JSON.parse('{"Save as image":"Save as image","Reset pan and zoom":"Reset pan and zoom","Save chart as svg":"Save chart as SVG"}')},880:function(t){t.exports=JSON.parse('{"Save as image":"Als Bild speichern","Reset pan and zoom":"Verschiebung und Zoomen zur\xfccksetzen","Save chart as svg":"Diagramm als SVG speichern"}')},881:function(t){t.exports=JSON.parse('{"Save as image":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u0430\u043a \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435","Reset pan and zoom":"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0441\u0434\u0432\u0438\u0433 \u0438 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","Save chart as svg":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0433\u0440\u0430\u0444\u0438\u043a \u043a\u0430\u043a SVG"}')},882:function(t){t.exports=JSON.parse('{"Save as image":"Salvar como imagem","Reset pan and zoom":"Redefinir panor\xe2mica e zoom","Save chart as svg":"Salvar gr\xe1fico como SVG"}')},883:function(t){t.exports=JSON.parse('{"Save as image":"Bewaar als afbeelding","Reset pan and zoom":"Stel pannen en zoomen opnieuw in","Save chart as svg":"Bewaar grafiek als SVG"}')},884:function(t){t.exports=JSON.parse('{"Save as image":"Enregistrer comme image","Reset pan and zoom":"R\xe9initialiser le panoramique et le zoom","Save chart as svg":"Enregistrer le graphique au format SVG"}')},885:function(t){t.exports=JSON.parse('{"Save as image":"Salva come immagine","Reset pan and zoom":"Reimposta panoramica e zoom","Save chart as svg":"Salva grafico come SVG"}')},886:function(t){t.exports=JSON.parse('{"Save as image":"Guardar como imagen","Reset pan and zoom":"Restablecer panor\xe1mica y zoom","Save chart as svg":"Guardar gr\xe1fico como SVG"}')},887:function(t){t.exports=JSON.parse('{"Save as image":"Zapisz jako obraz","Reset pan and zoom":"Zresetuj przesuwanie i powi\u0119kszanie","Save chart as svg":"Zapisz wykres jako SVG"}')},888:function(t){t.exports=JSON.parse('{"Save as image":"\u53e6\u5b58\u4e3a\u56fe\u7247","Reset pan and zoom":"\u91cd\u7f6e\u5e73\u79fb\u548c\u7f29\u653e","Save chart as svg":"\u5c06\u56fe\u8868\u53e6\u5b58\u4e3aSVG"}')},890:function(t,e,i){"use strict";i.r(e);var s=i(1),a=i.n(s),o=i(31),n=i.n(o),r=i(915),h=i(921),l=i(920),c=(i(429),i(16)),d=i(306),g=i(922),f=i(406),u=i.n(f),p=i(917),m=i(111),v=i.n(m),x=i(407),b=i.n(x),w=i(46),y=i.n(w),S=i(184),D=i.n(S),I=i(408),T=i.n(I),M=i(180),C=i.n(M),k=(i(550),i(409)),z=i.n(k),O=i(918),R=i(182),E=i(40),F=i.n(E),N=(i(551),i(552),i(553),i(554),i(555),i(556),i(557),i(558),i(559),i(560),i(410)),L=i.n(N),_=i(4),A=i.n(_),B=(i(344),i(351),i(352),i(356),i(357),i(358),i(411)),H=i.n(B),V=(i(640),i(853),i(854),i(855),i(856),i(857),i(858),i(859),i(860),i(861),i(862),i(863),i(864),i(865),i(866),i(867),i(868),i(380),i(385),i(240),i(389),i(386),i(403),null);function P(t,e,i){var s=(V||(V=document.createElement("canvas"))).getContext("2d");s.font="".concat(e||12,"px ").concat(i||"Microsoft YaHei");var a=s.measureText(t);return Math.ceil(a.width)}class J extends a.a.Component{constructor(t){super(t),this.updateProperties=t=>{if(this.updatePropertiesTimeout=null,this.echartsReact&&"function"===typeof this.echartsReact.getEchartsInstance){var e=this.echartsReact.getEchartsInstance(),i=t.config&&t.config.l&&t.config.l.map(t=>t.id)||[];i.sort();var s=JSON.stringify(i)!==JSON.stringify(this.lastIds);s&&(this.lastIds=i,e.clear()),this.option=this.chartOption.getOption(t.data,t.config),this.debug&&console.log("[ChartView ] [".concat((new Date).toISOString(),"] updateProperties: {min: ").concat(this.option.xAxis[0].min,", ").concat(this.option.xAxis[0].max,"}")),e.setOption(this.option,s)}},this.onResize=()=>{this.timerResize&&clearTimeout(this.timerResize),this.timerResize=setTimeout(()=>{this.timerResize=null,this.componentDidUpdate()})},this.onMouseMove=t=>{if(this.mouseDown){this.divResetButton.current&&"block"!==this.divResetButton.current.style.display&&(this.divResetButton.current.style.display="block");var e=this.chartOption.getHelperChartData(),i=e.lastX-(t.offsetX-e.padLeft);e.lastX=t.offsetX-e.padLeft;var s=e.xMax-e.xMin,a=this.state.chartWidth-e.padRight-e.padLeft,o=Math.round(i*s/a);e.xMin+=o,e.xMax+=o,this.setNewRange()}},this.onMouseDown=t=>{this.mouseDown=!0,this.chartOption.getHelperChartData().lastX=t.offsetX,this.zr&&!this.zr._mousemove&&(this.zr._mousemove=!0,this.zr.on("mousemove",this.onMouseMove)),this.props.config.live&&this.props.onRangeChange&&(console.log("Stop update"),this.props.onRangeChange({stopLive:!0}))},this.onMouseUp=()=>{this.mouseDown=!1,this.setNewRange(!0),this.zr&&this.zr._mousemove&&(this.zr._mousemove=!1,this.zr.off("mousemove",this.onMouseMove))},this.onMouseWheel=t=>{var e=this.chartOption.getHelperChartData(),i=e.xMax-e.xMin,s=this.state.chartWidth-e.padRight-e.padLeft,a=(t.offsetX-e.padLeft)/s,o=i-(i*=t.wheelDelta>0?1.1:.9);e.xMax+=o*(1-a),e.xMin-=o*a,this.setNewRange(),this.updateDataTimer&&clearTimeout(this.updateDataTimer),this.updateDataTimer=setTimeout(()=>this.setNewRange(!0),1e3)},this.onTouchStart=t=>{t.preventDefault(),this.mouseDown=!0;var e=t.touches||t.originalEvent.touches;if(e){var i=this.chartOption.getHelperChartData();i.lastX=e[e.length-1].pageX,e.length>1?i.lastWidth=Math.abs(e[0].pageX-e[1].pageX):i.lastWidth=null}},this.onTouchEnd=t=>{t.preventDefault(),this.mouseDown=!1,this.setNewRange(!0)},this.onTouchMove=t=>{t.preventDefault();var e=t.touches||t.originalEvent.touches;if(e){var i=this.chartOption.getHelperChartData(),s=e[e.length-1].pageX-i.padLeft;if(this.mouseDown)if(e.length>1){var a=Math.abs(e[0].pageX-e[1].pageX);if(null!==i.lastWidth&&a!==i.lastWidth){var o=i.xMax-i.xMin,n=this.state.chartWidth-i.padRight-i.padLeft,r=a>i.lastWidth?1.1:.9,h=(e[0].pageX>e[1].pageX?e[1].pageX-i.padLeft+a/2:e[0].pageX-i.padLeft+a/2)/n,l=o-(o*=r);i.xMax+=l*(1-h),i.xMin-=l*h,this.setNewRange()}i.lastWidth=a}else{var c=i.lastX-s,d=i.xMax-i.xMin,g=this.state.chartWidth-i.padRight-i.padLeft,f=Math.round(c*d/g);i.xMin+=f,i.xMax+=f,this.setNewRange()}i.lastX=s}},this.state={chartHeight:null,chartWidth:null},this.echartsReact=a.a.createRef(),this.divRef=a.a.createRef(),this.divResetButton=a.a.createRef(),F.a.locale(y.a.getLanguage()),this.lastIds=this.props.config&&this.props.config.l&&this.props.config.l.map(t=>t.id)||[],this.lastIds.sort(),this.chartOption=new H.a(F.a,this.props.themeType,P)}componentDidMount(){window.addEventListener("resize",this.onResize)}componentWillUnmount(){window.removeEventListener("resize",this.onResize)}UNSAFE_componentWillReceiveProps(t){if(t.data===this.state.data)return null;this.updatePropertiesTimeout&&clearTimeout(this.updatePropertiesTimeout),this.updatePropertiesTimeout=setTimeout(this.updateProperties,100,t)}setNewRange(t){var e=this.chartOption.getHelperChartData();e.diff=e.xMax-e.xMin,e.withTime=e.diff<6048e5,e.withSeconds=e.diff<18e5,console.log("[ChartView ] [".concat((new Date).toISOString(),"] setNewRange: ").concat(!!t,", {min: ").concat(e.xMin,", max: ").concat(e.xMax,"}")),t?(this.updateDataTimer&&clearTimeout(this.updateDataTimer),this.updateDataTimer=null,this.props.onRangeChange&&this.props.onRangeChange({start:e.xMin,end:e.xMax})):(console.log("[ChartView ] [".concat((new Date).toISOString(),"] setOption in setNewRange")),this.option.xAxis[0].min=e.xMin,this.option.xAxis[0].max=e.xMax,this.echartsReact&&"function"===typeof this.echartsReact.getEchartsInstance&&this.echartsReact.getEchartsInstance().setOption({xAxis:{min:e.xMin,max:e.xMax}}))}installEventHandlers(){this.zr=this.echartsReact&&this.echartsReact.getEchartsInstance&&this.echartsReact.getEchartsInstance().getZr(),this.zr&&this.props.config.zoom&&!this.zr._iobInstalled?(this.zr._iobInstalled=!0,this.zr.on("mousedown",this.onMouseDown),this.zr.on("mouseup",this.onMouseUp),this.zr.on("mousewheel",this.onMouseWheel),this.zr.on("touchstart",this.onTouchStart),this.zr.on("touchend",this.onTouchEnd),this.zr.on("touchmove",this.onTouchMove)):this.zr&&!this.props.config.zoom&&this.zr._iobInstalled&&(this.zr._iobInstalled=!1,this.zr.off("mousedown",this.onMouseDown),this.zr.off("mouseup",this.onMouseUp),this.zr.off("mousewheel",this.onMouseWheel),this.zr&&this.zr._mousemove&&(this.zr._mousemove=!1,this.zr.off("mousemove",this.onMouseMove)),this.zr.off("touchstart",this.onTouchStart),this.zr.off("touchend",this.onTouchEnd),this.zr.off("touchmove",this.onTouchMove))}renderChart(){return this.props.data?(this.option=this.option||this.chartOption.getOption(this.props.data,this.props.config),this.debug&&console.log("[ChartView ] [".concat((new Date).toISOString(),"] render chart")),a.a.createElement(L.a,{ref:t=>this.echartsReact=t,echarts:A.a,option:this.option,notMerge:!0,lazyUpdate:!0,theme:this.option.theme,style:{height:this.state.chartHeight+"px",width:"100%"},opts:{renderer:"svg"},onEvents:{rendered:t=>{this.props.config.zoom&&this.installEventHandlers()}}})):a.a.createElement(p.a,null)}componentDidUpdate(){if(this.divRef.current){var t="noborder"!==this.props.config.noBorder&&parseFloat(this.props.config.border_width)||0,e=parseFloat(this.props.config.border_padding)||0,i=this.divRef.current.offsetHeight-2*(t+e);if(this.state.chartHeight!==i){var s=this.divRef.current.offsetWidth-2*(t+e);setTimeout(()=>this.setState({chartHeight:i,chartWidth:s}),10)}}}renderResetButton(){return a.a.createElement(O.a,{ref:this.divResetButton,size:"small",color:"default",style:{display:"none"},className:this.props.classes.resetButton,title:y.a.t("Reset pan and zoom"),onClick:()=>{this.divResetButton.current&&(this.divResetButton.current.style.display="none"),this.props.onRangeChange&&this.props.onRangeChange()}},a.a.createElement(R.b,{className:this.props.classes.resetButtonIcon}))}renderExportButton(){return this.props.config.export?a.a.createElement(R.a,{color:this.props.config.exportColor||"default",className:this.props.classes.exportButton,title:y.a.t("Save chart as svg"),onClick:()=>{if(this.echartsReact&&"function"===typeof this.echartsReact.getEchartsInstance){var t=this.echartsReact.getEchartsInstance().getDataURL({pixelRatio:2,backgroundColor:this.props.config.window_bg||("dark"===this.props.themeType?"#000":"#FFF")}),e=document.createElement("a");document.body.appendChild(e),e.href=t,e.target="_self";var i="";i=1===this.props.config.l.length?this.props.config.l[0].name:"chart";var s=this.option,a=new Date(s.xAxis[0].max||s.series[0].data[s.series[0].data.length-1].value[0]);e.download="".concat(a.getFullYear(),"_").concat((a.getMonth()+1).toString().padStart(2,"0"),"_").concat(a.getDate().toString().padStart(2,"0"))+"_".concat(a.getHours().toString().padStart(2,"0"),"_").concat(a.getMinutes().toString().padStart(2,"0"),"_").concat(i,".svg"),e.click()}}}):null}render(){this.divRef.current||setTimeout(()=>this.forceUpdate(),10);var t="noborder"!==this.props.config.noBorder&&parseFloat(this.props.config.border_width)||0,e=parseFloat(this.props.config.border_padding)||0;return a.a.createElement("div",{ref:this.divRef,className:this.props.classes.chart,style:{borderWidth:t,width:t||e?"calc(100% - "+(2*(t+e)+1)+"px":void 0,height:t||e?"calc(100% - "+2*(t+e)+"px":void 0,background:this.props.config.window_bg||void 0,borderColor:"noborder"!==this.props.config.noBorder&&this.props.config.border_color||void 0,borderStyle:"noborder"!==this.props.config.noBorder&&t?this.props.config.border_style||"solid":"hidden",padding:e||0}},this.renderExportButton(),this.renderResetButton(),null!==this.state.chartHeight?this.renderChart():null)}}var U=Object(g.a)()(Object(c.a)(t=>({chart:{maxHeight:"100%",maxWidth:"100%",width:"100%",height:"100%",overflow:"hidden",position:"relative"},exportButton:{position:"absolute",top:40,right:5,width:20,height:20,zIndex:2,opacity:.7,cursor:"pointer"},resetButton:{position:"absolute",top:10,right:25,zIndex:2,opacity:.7},resetButtonIcon:{paddingTop:6}}))(J));class W extends s.Component{constructor(t){super(t),this.onReceiveMessage=t=>{if(t&&"chartReady"!==t.data)try{var e=JSON.parse(t.data);this.chartData?this.chartData.setConfig(e):this.createChartData(e)}catch(i){return console.log("Cannot parse "+t.data)}};var e=this.createTheme(),s=v.a.parseQuery(window.location.search),o=v.a.parseQuery((window.location.hash||"").replace(/^#/,""));this.state={connected:!1,seriesData:null,noLoader:s.noLoader||o.noLoader||!1,theme:e,themeName:this.getThemeName(e),themeType:this.getThemeType(e),noBackground:s.noBG||o.noBG||!1},this.inEdit="1"===s.edit||1===s.edit||!0===s.edit||"true"===s.edit||"1"===o.edit||1===o.edit||!0===o.edit||"true"===o.edit,this.divRef=a.a.createRef(),this.progressRef=a.a.createRef();var n={en:i(869),de:i(870),ru:i(871),pt:i(872),nl:i(873),fr:i(874),it:i(875),es:i(876),pl:i(877),"zh-cn":i(878)},r={en:i(879),de:i(880),ru:i(881),pt:i(882),nl:i(883),fr:i(884),it:i(885),es:i(886),pl:i(887),"zh-cn":i(888)};Object.keys(n).forEach(t=>n[t]=Object.assign(n[t],r[t])),y.a.setTranslations(n);try{this.isIFrame=window.self!==window.top}catch(h){this.isIFrame=!0}this.socket=new D.a({name:window.adapterName,onProgress:t=>{t===S.PROGRESS.CONNECTING?this.setState({connected:!1}):(S.PROGRESS.READY,this.setState({connected:!0}))},onReady:(t,e)=>{y.a.setLanguage(this.socket.systemLang),this.socket.getSystemConfig().then(t=>{var e,i;if(this.systemLang=(null===t||void 0===t||null===(e=t.common)||void 0===e?void 0:e.language)||"en",this.isFloatComma=(null===t||void 0===t||null===(i=t.common)||void 0===i?void 0:i.isFloatComma)||!1,this.inEdit){if(window.addEventListener("message",this.onReceiveMessage),window.self!==window.parent)try{window.parent.postMessage("chartReady")}catch(h){console.warn("Cannot send ready event to parent window")}}else this.createChartData()})},onError:t=>{console.error(t),this.showError(t)}})}createChartData(t){this.chartData=new z.a(this.socket,t),this.chartData.onError(t=>this.showError(y.a.t(t))),this.chartData.onReading(t=>this.showProgress(t)),this.chartData.onUpdate(t=>this.setState({seriesData:t},()=>this.showProgress(!1)))}showProgress(t){this.progressRef.current&&(this.progressRef.current.style.display=t?"block":"none")}componentWillUnmount(){this.inEdit&&window.removeEventListener("message",this.onReceiveMessage,!1),this.chartData&&this.chartData.destroy()}createTheme(t=""){return C()(v.a.getThemeName(t))}getThemeName(t){return t.name}getThemeType(t){return t.palette.type}showError(t){this.setState({errorText:t})}renderError(){return this.state.errorText?a.a.createElement(T.a,{classes:{},text:this.state.errorText,onClose:()=>this.setState({errorText:""})}):null}render(){if(!this.state.connected||!this.state.seriesData)return this.state.noLoader?null:a.a.createElement(r.a,{theme:this.state.theme},a.a.createElement(b.a,{theme:this.state.themeType}));var t=this.chartData.getConfig(),e=u()(JSON.stringify((t&&t.l&&t.l.map(t=>t.id)||[]).sort())).toString();return this.state.seriesData&&t.debug&&console.log("seriesData: "+JSON.stringify(this.state.seriesData)),a.a.createElement(r.a,{theme:this.state.theme},a.a.createElement("div",{ref:this.divRef,className:this.props.classes.root,style:{width:t.width,height:t.height,background:this.state.noBackground?void 0:this.state.theme.palette.background.default,color:this.state.theme.palette.text.primary}},a.a.createElement(p.a,{ref:this.progressRef,style:{display:"block"},className:this.props.classes.progress}),a.a.createElement(U,{key:e,socket:this.socket,t:y.a.t,noAnimation:this.state.noLoader,data:this.state.seriesData,config:t,lang:y.a.getLanguage(),themeType:this.state.themeType,onRangeChange:t=>this.chartData.setNewRange(t)}),this.renderError()))}}var j=Object(g.a)()(Object(c.a)(t=>({root:{width:"100%",height:"100%",position:"relative"},progress:{position:"absolute",top:0,left:0,right:0}}))(Object(d.a)(W)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var X=i(245);window.adapterName="echarts-show";var Y=v.a.getThemeName();console.log("iobroker."+window.adapterName+"@"+X.a+' using theme "'+Y+'"'),"localhost:3000"!==window.location.host&&h.a({dsn:"https://cf39325071144219aa91bb3510addcdf@sentry.iobroker.net/95",release:"iobroker."+window.adapterName+"@"+X.a,integrations:[new l.a]}),function t(){return n.a.render(a.a.createElement(r.a,{theme:C()(Y)},a.a.createElement(j,{onThemeChange:e=>{Y=e,t()}})),document.getElementById("root"))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(t=>{t.unregister()})}},[[424,1,2]]]);
//# sourceMappingURL=main.98d5ca97.chunk.js.map